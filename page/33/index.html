<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>PaperMod</title><meta name=description content="Theme PaperMod - https://github.com/adityatelange/hugo-PaperMod"><meta name=author content="Theme PaperMod"><link rel=canonical href=/><link crossorigin=anonymous href=/assets/css/stylesheet.min.c88963fe2d79462000fd0fb1b3737783c32855d340583e4523343f8735c787f0.css integrity="sha256-yIlj/i15RiAA/Q+xs3N3g8MoVdNAWD5FIzQ/hzXHh/A=" rel="preload stylesheet" as=style><link rel=icon href=favicon.ico><link rel=icon type=image/png sizes=16x16 href=favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=favicon-32x32.png><link rel=apple-touch-icon href=apple-touch-icon.png><link rel=mask-icon href=safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><meta name=generator content="Hugo 0.97.3"><link rel=alternate type=application/rss+xml href=/index.xml><link rel=alternate type=application/json href=/index.json><link rel=alternate hreflang=en href=/><link rel=alternate hreflang=fr href=/fr/><link rel=alternate hreflang=fa href=/fa/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="PaperMod"><meta property="og:description" content="Theme PaperMod - https://github.com/adityatelange/hugo-PaperMod"><meta property="og:type" content="website"><meta property="og:url" content="/"><meta property="og:image" content="papermod-cover.png"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="papermod-cover.png"><meta name=twitter:title content="PaperMod"><meta name=twitter:description content="Theme PaperMod - https://github.com/adityatelange/hugo-PaperMod"><script type=application/ld+json>{"@context":"https://schema.org","@type":"Organization","name":"PaperMod","url":"","description":"Theme PaperMod - https://github.com/adityatelange/hugo-PaperMod","thumbnailUrl":"favicon.ico","sameAs":["https://github.com/adityatelange/hugo-PaperMod","https://ko-fi.com/adityatelange","index.xml"]}</script><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-8502076734034112" crossorigin=anonymous></script></head><body class=list id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-8502076734034112" crossorigin=anonymous></script><header class=header><nav class=nav><div class=logo><a href accesskey=h title="PaperMod (Alt + H)">PaperMod</a>
<span class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button><ul class=lang-switch><li>|</li><li><a href=/fr/ title=French aria-label=:fr:>ğŸ‡«ğŸ‡·</a></li><li><a href=/fa/ title=Fa aria-label=Fa>Fa</a></li></ul></span></div><ul id=menu><li><a href=archives title=Archive><span>Archive</span></a></li><li><a href=categories/ title=Categories><span>Categories</span></a></li><li><a href=search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li><li><a href=tags/ title=Tags><span>Tags</span></a></li></ul></nav></header><main class=main><article class=post-entry><header class=entry-header><h2>spring boot å¤šæ•°æ®æºé…ç½®</h2></header><section class=entry-content><p>spring boot å¤šæ•°æ®æºé…ç½® åœ¨å•æ•°æ®æºçš„æƒ…å†µä¸‹ï¼ŒSpring Boot çš„é…ç½®éå¸¸ç®€å•ï¼Œåªéœ€è¦åœ¨ application.properties æ–‡ä»¶ä¸­é…ç½®è¿æ¥å‚æ•°å³å¯ã€‚ä½†æ˜¯å¾€å¾€éšç€ä¸šåŠ¡é‡å‘å±•ï¼Œæˆ‘ä»¬é€šå¸¸ä¼šè¿›è¡Œæ•°æ®åº“æ‹†åˆ†æˆ–æ˜¯å¼•å…¥å…¶ä»–æ•°æ®åº“ï¼Œä»è€Œæˆ‘ä»¬éœ€è¦é…ç½®å¤šä¸ªæ•°æ®æºã€‚
1 å‡†å¤‡ 1.1 ç¦æ­¢ DataSourceAutoConfiguration é¦–å…ˆè¦å°† spring boot è‡ªå¸¦çš„DataSourceAutoConfigurationç¦æ‰ï¼Œå› ä¸ºå®ƒä¼šè¯»å–application.propertiesæ–‡ä»¶çš„spring.datasource.*å±æ€§å¹¶è‡ªåŠ¨é…ç½®å•æ•°æ®æºã€‚åœ¨@SpringBootApplicationæ³¨è§£ä¸­æ·»åŠ excludeå±æ€§å³å¯ï¼š
@SpringBootApplication(exclude = {DataSourceAutoConfiguration.class}) public class DemoApplication { public static void main(String[] args) { SpringApplication.run(JpaDemoApplication.class, args); } } 1.2 é…ç½®æ•°æ®åº“è¿æ¥ ç„¶ååœ¨application.propertiesä¸­é…ç½®å¤šæ•°æ®æºè¿æ¥ä¿¡æ¯ï¼š
spring.datasource.primary.url=jdbc:mysql://localhost:3306/test spring.datasource.primary.username=root spring.datasource.primary.password=root spring.datasource.primary.driver-class-name=com.mysql.jdbc.Driver spring.datasource.secondary.url=jdbc:mysql://localhost:3306/test1 spring.datasource.secondary.username=root spring.datasource.secondary.password=root spring.datasource.secondary.driver-class-name=com.mysql.jdbc.Driver 1.3 æ‰‹æ®µåˆ›å»ºæ•°æ®æº ç”±äºæˆ‘ä»¬ç¦æ‰äº†è‡ªåŠ¨æ•°æ®æºé…ç½®ï¼Œå› äº›ä¸‹ä¸€æ­¥å°±éœ€è¦æ‰‹åŠ¨å°†è¿™äº›æ•°æ®æºåˆ›å»ºå‡ºæ¥ï¼š
@Configuration public class DataSourceConfig { @Bean(name = "primaryDataSource") // @Qualifier(value = "primaryDataSource") @ConfigurationProperties(prefix = "spring.datasource.primary") public DataSource primaryDataSource(){ return DataSourceBuilder.create().build(); } @Bean(name = "secondaryDataSource") // @Qualifier(value = "secondaryDataSource") @ConfigurationProperties(prefix = "spring....</p></section><footer class=entry-footer><span title="2018-03-24 19:01:37 +0000 UTC">March 24, 2018</span>&nbsp;Â·&nbsp;3 min&nbsp;Â·&nbsp;Theme PaperMod</footer><a class=entry-link aria-label="post link to spring boot å¤šæ•°æ®æºé…ç½®" href=/post/spring-boot%E5%A4%9A%E6%95%B0%E6%8D%AE%E6%BA%90%E9%85%8D%E7%BD%AE/></a></article><article class=post-entry><header class=entry-header><h2>spring boot è¿æ¥ redis</h2></header><section class=entry-content><p>Spring-data-redisä¸º spring-data æ¨¡å—ä¸­å¯¹ redis çš„æ”¯æŒéƒ¨åˆ†ï¼Œç®€ç§°ä¸ºâ€œSDRâ€ï¼Œæä¾›äº†åŸºäº jedis å®¢æˆ·ç«¯ API çš„é«˜åº¦å°è£…ä»¥åŠä¸ spring å®¹å™¨çš„æ•´åˆï¼Œ
jedis å®¢æˆ·ç«¯åœ¨ç¼–ç¨‹å®æ–½æ–¹é¢å­˜åœ¨å¦‚ä¸‹ä¸è¶³ï¼š
connection ç®¡ç†ç¼ºä¹è‡ªåŠ¨åŒ–ï¼Œconnection-pool çš„è®¾è®¡ç¼ºå°‘å¿…è¦çš„å®¹å™¨æ”¯æŒã€‚ æ•°æ®æ“ä½œéœ€è¦å…³æ³¨â€œåºåˆ—åŒ–â€/â€œååºåˆ—åŒ–â€ï¼Œå› ä¸º jedis çš„å®¢æˆ·ç«¯ API æ¥å—çš„æ•°æ®ç±»å‹ä¸º string å’Œ byteï¼Œå¯¹ç»“æ„åŒ–æ•°æ®(json,xml,pojo ç­‰)æ“ä½œéœ€è¦é¢å¤–çš„æ”¯æŒã€‚ äº‹åŠ¡æ“ä½œçº¯ç²¹ä¸ºç¡¬ç¼–ç  pub/sub åŠŸèƒ½ï¼Œç¼ºä¹å¿…è¦çš„è®¾è®¡æ¨¡å¼æ”¯æŒï¼Œå¯¹äºå¼€å‘è€…è€Œè¨€éœ€è¦å…³æ³¨çš„å¤ªå¤šã€‚ 1 spring-data-redis ç‰¹æ€§ è¿æ¥æ± è‡ªåŠ¨ç®¡ç†ï¼Œæä¾›äº†ä¸€ä¸ªé«˜åº¦å°è£…çš„â€œRedisTemplateâ€ç±» é’ˆå¯¹ jedis å®¢æˆ·ç«¯ä¸­å¤§é‡ api è¿›è¡Œäº†å½’ç±»å°è£…,å°†åŒä¸€ç±»å‹æ“ä½œå°è£…ä¸º operation æ¥å£ ValueOperationsï¼šç®€å• K-V æ“ä½œ SetOperationsï¼šset ç±»å‹æ•°æ®æ“ä½œ ZSetOperationsï¼šzset ç±»å‹æ•°æ®æ“ä½œ HashOperationsï¼šé’ˆå¯¹ map ç±»å‹çš„æ•°æ®æ“ä½œ ListOperationsï¼šé’ˆå¯¹ list ç±»å‹çš„æ•°æ®æ“ä½œ æä¾›äº†å¯¹ key çš„â€œboundâ€(ç»‘å®š)ä¾¿æ·åŒ–æ“ä½œ APIï¼Œå¯ä»¥é€šè¿‡ bound å°è£…æŒ‡å®šçš„ keyï¼Œç„¶åè¿›è¡Œä¸€ç³»åˆ—çš„æ“ä½œè€Œæ— é¡»â€œæ˜¾å¼â€çš„å†æ¬¡æŒ‡å®š Keyï¼Œå³ BoundKeyOperationsï¼š BoundValueOperations BoundSetOperations BoundListOperations BoundSetOperations BoundHashOperations å°†äº‹åŠ¡æ“ä½œå°è£…ï¼Œæœ‰å®¹å™¨æ§åˆ¶ã€‚ é’ˆå¯¹æ•°æ®çš„â€œåºåˆ—åŒ–/ååºåˆ—åŒ–â€ï¼Œæä¾›äº†å¤šç§å¯é€‰æ‹©ç­–ç•¥(RedisSerializer) JdkSerializationRedisSerializerï¼šPOJO å¯¹è±¡çš„å­˜å–åœºæ™¯ï¼Œä½¿ç”¨ JDK æœ¬èº«åºåˆ—åŒ–æœºåˆ¶ï¼Œå°† pojo ç±»é€šè¿‡ ObjectInputStream/ObjectOutputStream è¿›è¡Œåºåˆ—åŒ–æ“ä½œï¼Œæœ€ç»ˆ redis-server ä¸­å°†å­˜å‚¨å­—èŠ‚åºåˆ—ã€‚æ˜¯ç›®å‰æœ€å¸¸ç”¨çš„åºåˆ—åŒ–ç­–ç•¥ã€‚ StringRedisSerializerï¼šKey æˆ–è€… value ä¸ºå­—ç¬¦ä¸²çš„åœºæ™¯ï¼Œæ ¹æ®æŒ‡å®šçš„ charset å¯¹æ•°æ®çš„å­—èŠ‚åºåˆ—ç¼–ç æˆ stringï¼Œæ˜¯â€œnew String(bytes, charset)â€å’Œâ€œstring....</p></section><footer class=entry-footer><span title="2018-03-24 19:00:48 +0000 UTC">March 24, 2018</span>&nbsp;Â·&nbsp;2 min&nbsp;Â·&nbsp;Theme PaperMod</footer><a class=entry-link aria-label="post link to spring boot è¿æ¥ redis" href=/post/spring-boot%E8%BF%9E%E6%8E%A5redis/></a></article><article class=post-entry><header class=entry-header><h2>æœ€ç»ˆä¸€è‡´æ€§çš„å®ç°æ‰‹æ®µ</h2></header><section class=entry-content><p>æœ€ç»ˆä¸€è‡´æ€§çš„å®ç°æ‰‹æ®µ å®ç°æœ€ç»ˆä¸€è‡´æ€§æœ‰ä¸‰ç§æ‰‹æ®µï¼šå¯é äº‹ä»¶æ¨¡å¼ã€ä¸šåŠ¡è¡¥å¿æ¨¡å¼å’Œ TCC æ¨¡å¼
1 å¯é äº‹ä»¶æ¨¡å¼ å¯é äº‹ä»¶æ¨¡å¼å±äºäº‹ä»¶é©±åŠ¨æ¶æ„ï¼Œå½“æŸä»¶é‡è¦çš„äº‹æƒ…å‘ç”Ÿæ—¶ï¼Œæ¯”å¦‚æ›´æ–°ä¸€ä¸ªä¸šåŠ¡å®ä½“ï¼Œå¾®æœåŠ¡ä¼šå‘æ¶ˆæ¯ä»£ç†å‘å¸ƒä¸€ä¸ªäº‹ä»¶ã€‚æ¶ˆæ¯ä»£ç†ä¼šå°†è®¢é˜…äº‹ä»¶çš„å¾®æœåŠ¡æ¨é€äº‹ä»¶ã€‚
è¦å®ç°è¿™ç§æ¨¡å¼éœ€è¦æ¶ˆæ¯é˜Ÿåˆ—å®ç°äº‹ä»¶çš„æŒä¹…åŒ–å’Œ at least once çš„å¯é äº‹ä»¶æŠ•é€’æ¨¡å¼ã€‚
1.1 æœ¬åœ°äº‹ä»¶è¡¨ æœ¬åœ°äº‹ä»¶è¡¨æ–¹æ³•æ˜¯å°†äº‹ä»¶å’Œä¸šåŠ¡æ•°æ®ä¿å­˜åœ¨åŒä¸€ä¸ªæ•°æ®åº“ä¸­ï¼Œä½¿ç”¨ä¸€ä¸ªé¢å¤–çš„äº‹ä»¶æ¢å¤æœåŠ¡æ¥æ¢å¤äº‹ä»¶ï¼Œç”±æœ¬åœ°äº‹ç‰©ä¿è¯æ›´æ–°ä¸šåŠ¡å’Œå‘å¸ƒäº‹ä»¶çš„åŸå­æ€§ã€‚
ä½†æ˜¯ä¸šåŠ¡ç³»ç»Ÿå’Œäº‹ä»¶ç³»ç»Ÿè€¦åˆæ¯”è¾ƒç´§å¯†ï¼Œé¢å¤–çš„äº‹ä»¶æ•°æ®åº“æ“ä½œä¹Ÿä¼šç»™æ•°æ®åº“å¸¦æ¥é¢å¤–çš„å‹åŠ›ï¼Œå¯èƒ½æˆä¸ºç“¶é¢ˆã€‚
1.2 å¤–éƒ¨äº‹ä»¶ æ­¤æ–¹æ³•æ˜¯å°†äº‹ä»¶æŒä¹…åŒ–åˆ°å¤–éƒ¨çš„äº‹ä»¶ç³»ç»Ÿï¼Œäº‹ä»¶ç³»ç»Ÿéœ€è¦æä¾›å®æ—¶äº‹ä»¶æœåŠ¡ä»¥æ¥å—å¾®æœåŠ¡å‘å¸ƒçš„äº‹ä»¶ï¼ŒåŒæ—¶äº‹ä»¶ç³»ç»Ÿè¿˜éœ€è¦æä¾›äº‹ä»¶æ¢å¤æœåŠ¡æ¥ç¡®è®¤æ¢å¤äº‹ä»¶ã€‚
1.3 ä¸è¶³ æ­¤è¿‡ç¨‹å¯èƒ½å‡ºç°é‡å¤æ¶ˆè´¹çš„æƒ…å†µã€‚
2 è¡¥å¿æ¨¡å¼ ä¸€èˆ¬æ¥è®²ï¼Œå¼‚å¸¸ä¸€èˆ¬æ˜¯ç”±ä»¥ä¸‹ä¸¤ç§æƒ…å†µé€ æˆçš„ï¼š
ä¸šåŠ¡å¼‚å¸¸ï¼šä¸šåŠ¡é€»è¾‘äº§ç”Ÿçš„é”™è¯¯ï¼Œæ¯”å¦‚ä½™é¢ä¸è¶³ã€åº“å­˜ä¸è¶³ç­‰ã€‚
æŠ€æœ¯å¼‚å¸¸ï¼šéä¸šåŠ¡é€»è¾‘äº§ç”Ÿçš„å¼‚å¸¸ï¼Œæ¯”å¦‚ç½‘ç»œè¿æ¥å¼‚å¸¸ã€è¶…æ—¶ç­‰ã€‚
è¡¥å¿æ¨¡å¼å°±æ˜¯ä½¿ç”¨ä¸€ä¸ªé¢å¤–çš„åè°ƒæœåŠ¡æ¥åè°ƒå„ä¸ªéœ€è¦ä¿è¯ä¸€è‡´æ€§çš„å…¶ä»–æœåŠ¡ã€‚åè°ƒæœåŠ¡æŒ‰é¡ºåºè°ƒç”¨æ¯ä¸€ä¸ªæœåŠ¡ï¼Œå¦‚æœæŸä¸ªæœåŠ¡è°ƒç”¨å¼‚å¸¸å°±å–æ¶ˆä¹‹å‰æ‰€æœ‰å·²ç»è°ƒç”¨æˆåŠŸçš„æœåŠ¡ã€‚
å»ºè®®ä»…ç”¨äºæŠ€æœ¯å¼‚å¸¸çš„æƒ…å†µã€‚å¯¹äºä¸šåŠ¡å¼‚å¸¸æ¥è®²ï¼Œåº”è¯¥å°½å¯èƒ½çš„å»ä¼˜åŒ–ä¸šåŠ¡æ¨¡å¼ï¼Œä»¥é¿å…è¦æ±‚è¡¥å¿äº‹åŠ¡ã€‚
2.1 å¸¸ç”¨æ‰‹æ®µ åœ¨å®ç°è¡¥å¿æ¨¡å¼æ—¶åº”è¯¥åšåˆ°ä¸¤ç‚¹ï¼š
é¦–å…ˆè¦ç¡®å®šå¤±è´¥çš„æ­¥éª¤å’ŒçŠ¶æ€ï¼Œä»è€Œç¡®å®šè¦è¡¥å¿çš„èŒƒå›´ã€‚ å…¶æ¬¡è¦èƒ½æä¾›è¡¥å¿æ“ä½œä½¿ç”¨çš„ä¸šåŠ¡æ•°æ®ã€‚ å¯ä»¥é€šè¿‡è®°å½•å®Œæ•´çš„ä¸šåŠ¡æµæ°´çš„æ–¹æ³•æ¥å®ç°ä¸Šé¢ä¸¤ç‚¹è¦æ±‚ã€‚ä½†æ˜¯å¯¹äºä¸€ä¸ªé€šç”¨çš„è¡¥å¿æ¡†æ¶æ¥è¯´ï¼Œé¢„å…ˆçŸ¥é“å¾®æœåŠ¡éœ€è¦è®°å½•çš„ä¸šåŠ¡è¦ç´ æ˜¯ä¸å¯èƒ½çš„ï¼Œé‚£ä¹ˆå°±éœ€è¦ä¸€ç§åŠæ³•æ¥ä¿è¯ä¸šåŠ¡æµæ°´çš„å¯æ‰©å±•æ€§ï¼Œå®è·µä¸­ä¸»è¦æœ‰ä¸¤ç§æ–¹æ³•ï¼šå¤§è¡¨å’Œå…³è”è¡¨ã€‚
å¤§è¡¨ï¼Œé¡¾æ˜æ€è®®å°±æ˜¯è®¾è®¡æ—¶é™¤äº†å¿…é¡»çš„å­—æ®µå¤–ï¼Œè¿˜éœ€è¦é¢„ç•™å¤§é‡çš„å¤‡ç”¨å­—æ®µï¼Œæ¡†æ¶å¯ä»¥æä¾›è¾…åŠ©å·¥å…·æ¥å°†ä¸šåŠ¡æ•°æ®æ˜ å°„åˆ°å¤‡ç”¨å­—æ®µä¸­ã€‚å¤§è¡¨å¯¹äºæ¡†æ¶å±‚å®ç°èµ·æ¥æ¯”è¾ƒç®€å•ï¼Œä½†æ˜¯ä¹Ÿæœ‰ä¸€äº›éš¾ç‚¹ï¼Œæ¯”å¦‚é¢„ç•™å¤šå°‘ä¸ªå­—æ®µåˆé€‚ï¼Œæ¯ä¸ªå­—æ®µåˆéœ€è¦é¢„ç•™å¤šé•¿ã€‚è¿˜æœ‰ä¸€ä¸ªéš¾ç‚¹æ˜¯å¦‚æœä»…ä»æ•°æ®å±‚é¢æ¥æŸ¥è¯¢æ•°æ®ï¼Œå¾ˆéš¾ä¸€çœ¼çœ‹å‡ºå¤‡ç”¨å­—æ®µçš„ä¸šåŠ¡å«ä¹‰ï¼Œç»´æŠ¤è¿‡ç¨‹ä¸å‹å¥½ã€‚ å…³è”è¡¨ï¼Œåˆ†ä¸ºæŠ€æœ¯è¡¨å’Œä¸šåŠ¡è¡¨ã€‚æŠ€æœ¯è¡¨ä¸­ä¿å­˜ä¸ºå®ç°è¡¥å¿æ“ä½œæ‰€éœ€è¦çš„æŠ€æœ¯æ•°æ®ï¼Œä¸šåŠ¡è¡¨ä¸­ä¿å­˜ä¸šåŠ¡æ•°æ®ã€‚é€šè¿‡åœ¨æŠ€æœ¯è¡¨ä¸­å¢åŠ ä¸šåŠ¡è¡¨åå’Œä¸šåŠ¡è¡¨ä¸»é”®æ¥å»ºç«‹å’Œä¸šåŠ¡æ•°æ®çš„å…³è”ã€‚å…³è”è¡¨æ›´çµæ´»ï¼Œèƒ½æ”¯æŒä¸åŒä¸šåŠ¡ç±»å‹è®°å½•ä¸åŒçš„ä¸šåŠ¡è¦ç´ ã€‚ä½†æ˜¯åœ¨æ¡†æ¶çš„å®ç°ä¸Šéš¾åº¦è¾ƒé«˜ï¼Œæ¯æ¬¡æŸ¥è¯¢éƒ½éœ€è¦å¤æ‚çš„å…³è”åŠ¨ä½œï¼Œæ€§èƒ½ä¼šå—åˆ°å½±å“ã€‚ 2.2 é‡è¯• è¡¥å¿è¿‡ç¨‹ä½œä¸ºä¸€ä¸ªæœåŠ¡ï¼Œåœ¨è°ƒç”¨çš„æ—¶å€™ä¹Ÿä¼šå‡ºç°ä¸æˆåŠŸçš„æƒ…å†µï¼Œè¿™æ—¶å°±è¦é€šè¿‡é‡è¯•æœºåˆ¶æ¥ä¿è¯è¡¥å¿çš„æˆåŠŸç‡ã€‚å› æ­¤è¦æ±‚è¡¥å¿æ“ä½œå…·æœ‰å¹‚ç­‰æ€§ã€‚
ä½†æ˜¯ä¹Ÿä¸æ˜¯ç›²ç›®çš„é‡è¯•ï¼Œæˆ‘ä»¬éœ€è¦æ ¹æ®æœåŠ¡æ‰§è¡Œå¤±è´¥çš„åŸå› æ¥é€‰æ‹©ä¸åŒçš„ç­–ç•¥ï¼š
å› ä¸šåŠ¡å› ç´ å¯¼è‡´å¤±è´¥ï¼Œéœ€è¦åœæ­¢é‡è¯•ã€‚ ç½•è§çš„å¼‚å¸¸ï¼Œå¦‚ç½‘ç»œä¸­æ–­ï¼Œä¼ è¾“è¿‡ç¨‹ä¸­æ•°æ®ä¸¢å¤±ï¼Œåº”è¯¥ç«‹å³é‡è¯•ã€‚ å¦‚æœæ˜¯å› ä¸ºç³»ç»Ÿç¹å¿™ï¼Œæ­¤æ—¶éœ€è¦ç­‰å¾…ä¸€æ®µæ—¶é—´å†é‡è¯•ã€‚ 2.3 ä¸è¶³ åœ¨è¡¥å¿æ¨¡å¼ä¸­æœ‰ä¸€ä¸ªæ˜æ˜¾çš„ç¼ºé™·æ˜¯éš”ç¦»æ€§ï¼Œä»ç¬¬ä¸€ä¸ªæœåŠ¡å¼€å§‹ä¸€ç›´åˆ°è¡¥å¿å®Œæˆï¼Œä¸ä¸€è‡´æ€§æ˜¯å¯¹å…¶ä»–æœåŠ¡å¯è§çš„ã€‚å¦å¤–è¡¥å¿æ¨¡å¼è¿‡åˆ†ä¾èµ–åè°ƒæœåŠ¡çš„å¥å£®æ€§ï¼Œå¦‚æœåè°ƒæœåŠ¡å¼‚å¸¸ï¼Œåˆ™æ²¡åŠæ³•è¾¾åˆ°ä¸€è‡´æ€§ã€‚
3 TCC æ¨¡å¼ TCCï¼Œæ˜¯ Tryï¼ŒConfirm å’Œ Cancel çš„ç¼©å†™ã€‚ä¸€ä¸ªå®Œæ•´çš„ TCC ä¸šåŠ¡ä¸€èˆ¬æ˜¯ç”±ä¸€ä¸ªä¸»ä¸šåŠ¡å’Œè‹¥å¹²ä¸ªä»ä¸šåŠ¡ç»„æˆã€‚
Try å®Œæˆæ‰€æœ‰ä¸šåŠ¡æ£€æŸ¥ é¢„ç•™å¿…é¡»çš„ä¸šåŠ¡èµ„æº Confirm çœŸæ­£æ‰§è¡Œä¸šåŠ¡ ä¸åšä»»ä½•ä¸šåŠ¡æ£€æŸ¥ åªä½¿ç”¨ Try é˜¶æ®µé¢„ç•™çš„ä¸šåŠ¡èµ„æº æ»¡è¶³å¹‚ç­‰æ€§ Cancel é‡Šæ”¾ Try é˜¶æ®µé¢„ç•™çš„ä¸šåŠ¡èµ„æº æ»¡è¶³å¹‚ç­‰æ€§ 3....</p></section><footer class=entry-footer><span title="2018-03-24 18:59:55 +0000 UTC">March 24, 2018</span>&nbsp;Â·&nbsp;1 min&nbsp;Â·&nbsp;Theme PaperMod</footer><a class=entry-link aria-label="post link to æœ€ç»ˆä¸€è‡´æ€§çš„å®ç°æ‰‹æ®µ" href=/post/%E6%9C%80%E7%BB%88%E4%B8%80%E8%87%B4%E6%80%A7%E7%9A%84%E5%AE%9E%E7%8E%B0%E6%89%8B%E6%AE%B5/></a></article><article class=post-entry><header class=entry-header><h2>Reactive å¾®æœåŠ¡</h2></header><section class=entry-content><p>Reactive å¾®æœåŠ¡ åˆ†å¸ƒå¼ç³»ç»Ÿæ„å»ºèµ·æ¥å¾ˆå›°éš¾ï¼Œå› ä¸ºå®ƒä»¬å®¹æ˜“å‡ºé—®é¢˜ï¼Œè¿è¡Œç¼“æ…¢ï¼Œå¹¶ä¸”è¢« CAP å’Œ FLP ç†è®ºæ‰€é™åˆ¶ã€‚æ¢å¥è¯è¯´ï¼Œå®ƒä»¬çš„æ„å»ºå’Œè¿ç»´éƒ½ç‰¹åˆ«å¤æ‚ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œreactive ä¾¿å‡ºç°äº†ã€‚
Reactive ç¼–ç¨‹ï¼šä¸€ç§å¼€å‘æ¨¡å‹ï¼Œå…¶ä¸“æ³¨äºæ•°æ®æµå‘ã€å¯¹å˜åŒ–çš„åé¦ˆï¼Œä»¥åŠä¼ æ’­ä»–ä»¬ã€‚
åœ¨ reactive ç¼–ç¨‹ä¸­ï¼Œåˆºæ¿€ä¿¡å·æ˜¯æ•°æ®çš„è½¬ç§»ï¼Œå«åš streamsã€‚å…¶å®å¾ˆåƒç”Ÿäº§è€…â€”â€”æ¶ˆè´¹è€…æ¨¡å¼ï¼Œæ¶ˆè´¹è€…å¯¹å€¼è¿›è¡Œè®¢é˜…å¹¶å“åº”ã€‚
Reactive ç³»ç»Ÿï¼šä¸€ç§æ¶æ„é£æ ¼ï¼Œå…¶åŸºäºå¼‚æ­¥æ¶ˆæ¯æ¥æ„å»ºå“åº”å¼çš„åˆ†å¸ƒå¼ç³»ç»Ÿã€‚
reactive ç³»ç»Ÿä½¿ç”¨äº†æ¶ˆæ¯é©±åŠ¨çš„æ–¹æ³•ã€‚æ‰€æœ‰çš„æ„å»ºé€šè¿‡å¼‚æ­¥æ¶ˆæ¯çš„å‘é€å’Œæ¥æ”¶æ¥äº¤äº’ã€‚æ¶ˆæ¯æŠ•é€’çš„é€»è¾‘ç”±åº•å±‚çš„å®ç°å†³å®šã€‚å‘é€è€…ä¸ä¼šé˜»å¡ç€ç­‰å¾…å›å¤ï¼Œå®ƒä»¬å¯èƒ½ä¼šç¨åæ‰æ¥æ”¶åˆ°å›å¤ã€‚
reactive ç³»ç»Ÿä¼šæœ‰ä¸¤ä¸ªé‡è¦çš„ç‰¹å¾ï¼š
ä¼¸ç¼©æ€§â€”â€”å¯ä»¥æ¨ªå‘ä¼¸ç¼©
ä¼¸ç¼©æ€§æ¥è‡ªæ¶ˆæ¯ä¼ é€’çš„è§£è€¦ã€‚æ¶ˆæ¯è¢«å‘é€åˆ°ä¸€ä¸ªåœ°å€ä¹‹åï¼Œå¯ä»¥è¢«ä¸€ç»„æ¶ˆè´¹è€…æŒ‰ç…§ä¸€ç§è´Ÿè½½å‡è¡¡æ–¹æ³•æ¶ˆè´¹ã€‚å½“ reactive ç³»ç»Ÿé‡åˆ°è´Ÿè½½é«˜å³°æ—¶ï¼Œå®ƒå¯ä»¥åˆ›é€ å‡ºæ–°çš„æ¶ˆè´¹è€…ï¼Œå¹¶åœ¨æ­¤ä¹‹åé”€æ¯å®ƒä»¬ã€‚
æ¢å¤æ€§â€”â€”å¯ä»¥å¤„ç†é”™è¯¯å¹¶ä¸”æ¢å¤
é¦–å…ˆï¼Œè¿™ç§æ¶ˆæ¯äº¤äº’æ¨¡å¼å…è®¸ç»„ä»¶åœ¨å…¶æœ¬åœ°å¤„ç†é”™è¯¯ï¼Œç»„ä»¶ä¸éœ€è¦ç­‰å¾…æ¶ˆæ¯ï¼Œå› æ­¤å½“ä¸€ä¸ªç»„ä»¶å‘ç”Ÿé”™è¯¯æ—¶ï¼Œå…¶ä»–ç»„ä»¶ä»ç„¶ä¼šæ­£å¸¸å·¥ä½œã€‚å…¶æ¬¡ï¼Œå½“ä¸€ä¸ªå¤„ç†æ¶ˆæ¯çš„ç»„ä»¶å‘ç”Ÿé”™è¯¯åï¼Œæ¶ˆæ¯å¯ä»¥å¯ä»¥ä¼ é€’ç»™åœ¨ç›¸åŒåœ°å€æ³¨å†Œçš„å…¶ä»–ç»„ä»¶ã€‚
reactive å¾®æœåŠ¡ç³»ç»Ÿæ˜¯ç”± reactive å¾®æœåŠ¡ç»„æˆçš„ã€‚è¿™äº›å¾®æœåŠ¡æœ‰ä¸‹é¢å››ä¸ªç‰¹å¾ï¼š
è‡ªæ²»æ€§ å¼‚æ­¥æ€§ æ¢å¤æ€§ ä¼¸ç¼©æ€§ Reactive å¾®æœåŠ¡æ˜¯å¯è‡ªæ²»çš„ã€‚ä»–ä»¬å¯ä»¥æ ¹æ®å‘¨å›´çš„æœåŠ¡æ˜¯å¦å¯ç”¨æ¥è°ƒæ•´è‡ªå·±çš„è¡Œä¸ºã€‚è‡ªæ²»æ€§å¾€å¾€ä¼´éšç€å­¤ç«‹æ€§ï¼›Reactive å¾®æœåŠ¡å¯ä»¥åœ¨æœ¬åœ°å¤„ç†é”™è¯¯ã€ç‹¬ç«‹åœ°å®Œæˆä»»åŠ¡ï¼Œå¹¶åœ¨å¿…è¦æ—¶å’Œå…¶ä»–æœåŠ¡åˆä½œã€‚å®ƒä»¬ä½¿ç”¨å¼‚æ­¥æ¶ˆæ¯ä¼ é€’çš„æœºåˆ¶å’Œå…¶ä»–æœåŠ¡æ²Ÿé€šï¼›å®ƒä»¬ä¹Ÿä¼šæ¥æ”¶æ¶ˆæ¯å¹¶ä¸”å¯¹å…¶ä½œå‡ºå›åº”ã€‚
å¾—ç›Šäºå¼‚æ­¥æ¶ˆæ¯æœºåˆ¶ï¼Œreactive å¾®æœåŠ¡å¯ä»¥å¤„ç†é”™è¯¯å¹¶æ ¹æ®æƒ…å†µè°ƒæ•´è‡ªå·±çš„è¡Œä¸ºã€‚é”™è¯¯ä¸ä¼šè¢«æ‰©æ•£ï¼Œè€Œæ˜¯åœ¨é è¿‘é”™è¯¯æºå¤´çš„åœ°æ–¹è¢«å¤„ç†æ‰ã€‚å½“ä¸€ä¸ªå¾®æœåŠ¡æŒ‚æ‰ä¹‹åï¼Œå®ƒçš„æ¶ˆè´¹è€…å¾®æœåŠ¡è¦èƒ½å¤Ÿå¤„ç†é”™è¯¯å¹¶é¿å…æ‰©æ•£ã€‚è¿™ä¸€å­¤ç«‹åŸåˆ™æ˜¯é¿å…é”™è¯¯é€å±‚ä¸Šæµ®è€Œæ¯æ‰æ•´ä¸ªç³»ç»Ÿçš„å…³é”®ã€‚å¯æ¢å¤æ€§ä¸åªæ˜¯å…³äºå¤„ç†é”™è¯¯ï¼Œå®ƒè¿˜æ¶‰åŠåˆ°è‡ªæ„ˆæ€§ï¼›ä¸€ä¸ª reactive å¾®æœåŠ¡åº”è¯¥èƒ½å¤Ÿä»é”™è¯¯ä¸­æ¢å¤å¹¶ä¸”å¯¹é”™è¯¯è¿›è¡Œè¡¥æ•‘ã€‚
æœ€åï¼Œreactive å¾®æœåŠ¡å¿…é¡»æ˜¯å¯ä¼¸ç¼©çš„ï¼Œè¿™æ ·ç³»ç»Ÿæ‰å¯ä»¥æ ¹æ®è´Ÿè½½æƒ…å†µæ¥è°ƒæ•´èŠ‚ç‚¹æ•°é‡ã€‚è¿™ä¸€ç‰¹æ€§æ„å‘³ç€å°†ä¼šæœ‰ä¸€ç³»åˆ—çš„é™åˆ¶ï¼Œæ¯”å¦‚ä¸èƒ½æœ‰åœ¨å†…å­˜ä¸­çš„çŠ¶æ€ï¼Œè¦èƒ½å¤Ÿåœ¨å¿…è¦æ—¶åŒæ­¥çŠ¶æ€ä¿¡æ¯ï¼Œæˆ–è€…è¦èƒ½å¤Ÿå°†æ¶ˆæ¯è·¯ç”±åˆ°çŠ¶æ€ä¿¡æ¯ç›¸åŒçš„èŠ‚ç‚¹ã€‚
Vert.x Vert.x æ˜¯ä¸€ä¸ªç”¨äºæ„å»º reactive å’Œåˆ†å¸ƒå¼ç³»ç»Ÿçš„å·¥å…·ç®±ï¼Œå…¶ä½¿ç”¨äº†å¼‚æ­¥éé˜»å¡ç¼–ç¨‹æ¨¡å‹ã€‚å½“ä½¿ç”¨ Vert.x æ„å»ºå¾®æœåŠ¡çš„æ—¶å€™ï¼Œå¾®æœåŠ¡ä¼šè‡ªç„¶åœ°å¸¦ä¸Šä¸€ä¸ªæ ¸å¿ƒç‰¹å¾ï¼šæ‰€æœ‰äº‹æƒ…éƒ½æ˜¯å¼‚æ­¥çš„ã€‚
ä¼ ç»Ÿç¼–ç¨‹æ¨¡å¼
int res = compute(1, 2); åœ¨è¿™æ®µä»£ç ä¸­ï¼Œæ˜¯åœ¨ç­‰å¾… compute å‡½æ•°è®¡ç®—å‡ºæ¥ç»“æœä¹‹åå†è¿›è¡Œå‰©ä¸‹çš„æ“ä½œã€‚è€Œåœ¨å¼‚æ­¥éé˜»å¡çš„ç¼–ç¨‹æ¨¡å¼ä¸­ï¼Œå°†ä¼šåˆ›å»ºä¸€ä¸ª handlerï¼š
compute(1, 2, res -> { // called with the result }); åœ¨ä¸Šè¿°ä»£ç ä¸­ï¼Œcompute å‡½æ•°ä¸å†è¿”å›ä¸€ä¸ªç»“æœï¼Œè€Œæ˜¯ä¼ ä¸€ä¸ª handlerï¼Œå½“ç»“æœå‡†å¤‡å¥½æ—¶è°ƒç”¨å°±å¯ä»¥äº†ã€‚å¾—ç›Šäºè¿™ç§å¼€å‘æ¨¡å‹ï¼Œå¯ä»¥ä½¿ç”¨å¾ˆå°‘çš„çº¿ç¨‹å»å¤„ç†é«˜å¹¶å‘å·¥ä½œã€‚åœ¨ vert....</p></section><footer class=entry-footer><span title="2018-03-24 17:57:58 +0000 UTC">March 24, 2018</span>&nbsp;Â·&nbsp;1 min&nbsp;Â·&nbsp;Theme PaperMod</footer><a class=entry-link aria-label="post link to Reactive å¾®æœåŠ¡" href=/post/reactive%E5%BE%AE%E6%9C%8D%E5%8A%A1/></a></article><article class=post-entry><header class=entry-header><h2>Guice å¿«é€Ÿå…¥é—¨</h2></header><section class=entry-content><p>Guice å¿«é€Ÿå…¥é—¨ æ¥æ‰‹çš„æ–°é¡¹ç›®ä¸»è¦æ˜¯ä½¿ç”¨ kotlin+vert.x æ¥å†™çš„ï¼Œä½¿ç”¨ gradle æ„å»ºï¼Œä¾èµ–æ³¨å…¥æ¡†æ¶ä½¿ç”¨äº† guiceã€‚è¿™æ®µæ—¶é—´éƒ½æ˜¯åœ¨ç†Ÿæ‚‰ä»£ç çš„è¿‡ç¨‹ï¼Œæ¶è¡¥ä¸€äº›çŸ¥è¯†ã€‚
guice æ˜¯è°·æ­Œæ¨å‡ºçš„ä¸€ä¸ªè½»é‡çº§çš„ä¾èµ–æ³¨å…¥æ¡†æ¶ï¼Œå½“ç„¶ spring ä¹Ÿå¯ä»¥å®ç°ä¾èµ–æ³¨å…¥ï¼Œåªæ˜¯ spring å¤ªåºå¤§äº†ã€‚
1 åŸºæœ¬ä½¿ç”¨ å¼•å…¥ä¾èµ– ä½¿ç”¨ gradle æˆ–è€… mavenï¼Œå¼•å…¥ guiceã€‚
maven:
&lt;dependency> &lt;groupId>com.google.inject&lt;/groupId> &lt;artifactId>guice&lt;/artifactId> &lt;version>4.1.0&lt;/version> &lt;/dependency> Gradle:
compile "com.google.inject:guice:4.1.0" é¡¹ç›®éª¨æ¶ é¦–å…ˆéœ€è¦ä¸€ä¸ªä¸šåŠ¡æ¥å£ï¼ŒåŒ…å«ä¸€ä¸ªæ–¹æ³•æ¥æ‰§è¡Œä¸šåŠ¡é€»è¾‘ï¼Œå®ƒçš„å®ç°éå¸¸ç®€å•ï¼š
package com.learning.guice; public interface UserService { void process(); } package com.learning.guice; public class UserServiceImpl implements UserService { @Override public void process() { System.out.println("æˆ‘éœ€è¦åšä¸€äº›ä¸šåŠ¡é€»è¾‘"); } } ç„¶åå†™ä¸€ä¸ªæ—¥å¿—çš„æ¥å£ï¼š
package com.learning.guice; public interface LogService { void log(String msg); } package com....</p></section><footer class=entry-footer><span title="2018-03-24 17:57:15 +0000 UTC">March 24, 2018</span>&nbsp;Â·&nbsp;3 min&nbsp;Â·&nbsp;Theme PaperMod</footer><a class=entry-link aria-label="post link to Guice å¿«é€Ÿå…¥é—¨" href=/post/guice%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8/></a></article><footer class=page-footer><nav class=pagination><a class=prev href=/page/32/>Â« Prev Page</a>
<a class=next href=/page/34/>Next Page Â»</a></nav></footer></main><footer class=footer><span>&copy; 2022 <a href>PaperMod</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://git.io/hugopapermod rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(t){t.preventDefault();var e=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(e)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(e)}']`).scrollIntoView({behavior:"smooth"}),e==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${e}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>