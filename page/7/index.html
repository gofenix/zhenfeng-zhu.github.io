<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Go Data</title><meta name=keywords content><meta name=description content="Theme PaperMod - https://github.com/adityatelange/hugo-PaperMod"><meta name=author content="Lucas"><link rel=canonical href=https://zhenfeng-zhu.github.io/><link href=/assets/css/stylesheet.min.3839cf02b87f30309470412461116907caabd1b3ec3f5d015df618da2d034992.css integrity="sha256-ODnPArh/MDCUcEEkYRFpB8qr0bPsP10BXfYY2i0DSZI=" rel="preload stylesheet" as=style><link rel=icon href=https://zhenfeng-zhu.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://zhenfeng-zhu.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://zhenfeng-zhu.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://zhenfeng-zhu.github.io/apple-touch-icon.png><link rel=mask-icon href=https://zhenfeng-zhu.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><meta name=generator content="Hugo 0.80.0"><link rel=alternate type=application/rss+xml href=https://zhenfeng-zhu.github.io/index.xml><link rel=alternate type=application/json href=https://zhenfeng-zhu.github.io/index.json><meta property="og:title" content="Go Data"><meta property="og:description" content="Theme PaperMod - https://github.com/adityatelange/hugo-PaperMod"><meta property="og:type" content="website"><meta property="og:url" content="https://zhenfeng-zhu.github.io/"><meta property="og:image" content="https://zhenfeng-zhu.github.io/papermod-cover.png"><meta property="og:updated_time" content="2021-02-18T13:05:31+08:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://zhenfeng-zhu.github.io/papermod-cover.png"><meta name=twitter:title content="Go Data"><meta name=twitter:description content="Theme PaperMod - https://github.com/adityatelange/hugo-PaperMod"><script type=application/ld+json>{"@context":"https://schema.org","@type":"Organization","name":"Go Data","url":"https://zhenfeng-zhu.github.io","description":"Theme PaperMod - https://github.com/adityatelange/hugo-PaperMod","thumbnailUrl":"https://zhenfeng-zhu.github.io/favicon.ico","sameAs":["https://github.com/zhenfeng-zhu","index.xml"]}</script></head><body class=list id=top><script>if(localStorage.getItem("pref-theme")==="dark"){document.body.classList.add('dark');}else if(localStorage.getItem("pref-theme")==="light"){document.body.classList.remove('dark')}else if(window.matchMedia('(prefers-color-scheme: dark)').matches){document.body.classList.add('dark');}</script><noscript><style type=text/css>#theme-toggle,.top-link{display:none}</style></noscript><header class=header><nav class=nav><div class=logo><a href=https://zhenfeng-zhu.github.io accesskey=h title="Go Data (Alt + H)">Go Data</a>
<span class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></span></div><ul id=menu onscroll=menu_on_scroll()><li><a href=https://zhenfeng-zhu.github.io/about title=About><span>About</span></a></li><li><a href=https://zhenfeng-zhu.github.io/search/ title=ğŸ”><span>ğŸ”</span></a></li></ul></nav></header><main class=main><article class=post-entry><header class=entry-header><h2>Spring Bootå¯åŠ¨åŸç†åˆ†æ</h2></header><section class=entry-content><p>Spring Bootå¯åŠ¨åŸç†åˆ†æ æˆ‘ä»¬åœ¨å¼€å‘spring bootåº”ç”¨çš„æ—¶å€™ï¼Œä¸€èˆ¬ä¼šé‡åˆ°å¦‚ä¸‹çš„å¯åŠ¨ç±»ï¼š
@SpringBootApplication public class DemoApplication { public static void main(String[] args) { SpringApplication.run(DemoApplication.class, args); } } ä»è¿™æ®µä»£ç å¯ä»¥çœ‹å‡ºï¼Œæ³¨è§£@SpringBootApplicationå’ŒSpringApplication.run()æ˜¯æ¯”è¾ƒé‡è¦çš„ä¸¤ä¸ªä¸œè¥¿ã€‚
1 @SpringApplicationæ³¨è§£ @Target(ElementType.TYPE) @Retention(RetentionPolicy.RUNTIME) @Documented @Inherited @SpringBootConfiguration @EnableAutoConfiguration @ComponentScan(excludeFilters = { @Filter(type = FilterType.CUSTOM, classes = TypeExcludeFilter.class), @Filter(type = FilterType.CUSTOM, classes = AutoConfigurationExcludeFilter.class) }) public @interface SpringBootApplication { ... } åœ¨è¿™æ®µä»£ç é‡Œï¼Œæ¯”è¾ƒé‡è¦çš„åªæœ‰ä¸‰ä¸ªæ³¨è§£ï¼š
@Configurationï¼ˆ@SpringBootConfigurationç‚¹å¼€æŸ¥çœ‹å‘ç°é‡Œé¢è¿˜æ˜¯åº”ç”¨äº†@Configurationï¼‰ @EnableAutoConfiguration @ComponentScan å…¶å®ï¼Œæˆ‘ä»¬ä½¿ç”¨è¿™ä¸‰ä¸ªæ³¨è§£æ¥ä¿®é¥°springbootçš„å¯åŠ¨ç±»ä¹Ÿå¯ä»¥æ­£å¸¸è¿è¡Œ,å¦‚ä¸‹æ‰€ç¤ºï¼š
@ComponentScan @EnableAutoConfiguration @Configuration public class DemoApplication { public static void main(String[] args) { SpringApplication....</p></section><footer class=entry-footer>March 24, 2018&nbsp;Â·&nbsp;2 min&nbsp;Â·&nbsp;Lucas</footer><a class=entry-link aria-label="post link to Spring Bootå¯åŠ¨åŸç†åˆ†æ" href=https://zhenfeng-zhu.github.io/posts/spring-boot%E5%90%AF%E5%8A%A8%E5%8E%9F%E7%90%86%E5%88%86%E6%9E%90/></a></article><article class=post-entry><header class=entry-header><h2>Spring Data Jpaå®æˆ˜</h2></header><section class=entry-content><p>ä¸ºäº†è§£å†³æŠ½è±¡å„ä¸ªJavaå®ä½“åŸºæœ¬çš„â€œå¢åˆ æ”¹æŸ¥â€æ“ä½œï¼Œæˆ‘ä»¬é€šå¸¸ä¼šä»¥æ³›å‹çš„æ–¹å¼å°è£…ä¸€ä¸ªæ¨¡æ¿Daoæ¥è¿›è¡ŒæŠ½è±¡ç®€åŒ–ï¼Œä½†æ˜¯è¿™æ ·ä¾ç„¶ä¸æ˜¯å¾ˆæ–¹ä¾¿ï¼Œæˆ‘ä»¬éœ€è¦é’ˆå¯¹æ¯ä¸ªå®ä½“ç¼–å†™ä¸€ä¸ªç»§æ‰¿è‡ªæ³›å‹æ¨¡æ¿Daoçš„æ¥å£ï¼Œå†ç¼–å†™è¯¥æ¥å£çš„å®ç°ã€‚è™½ç„¶ä¸€äº›åŸºç¡€çš„æ•°æ®è®¿é—®å·²ç»å¯ä»¥å¾—åˆ°å¾ˆå¥½çš„å¤ç”¨ï¼Œä½†æ˜¯åœ¨ä»£ç ç»“æ„ä¸Šé’ˆå¯¹æ¯ä¸ªå®ä½“éƒ½ä¼šæœ‰ä¸€å †Daoçš„æ¥å£å’Œå®ç°ã€‚
ç”±äºæ¨¡æ¿Daoçš„å®ç°ï¼Œä½¿å¾—è¿™äº›å…·ä½“å®ä½“çš„Daoå±‚å·²ç»å˜çš„éå¸¸â€œè–„â€ï¼Œæœ‰ä¸€äº›å…·ä½“å®ä½“çš„Daoå®ç°å¯èƒ½å®Œå…¨å°±æ˜¯å¯¹æ¨¡æ¿Daoçš„ç®€å•ä»£ç†ï¼Œå¹¶ä¸”å¾€å¾€è¿™æ ·çš„å®ç°ç±»å¯èƒ½ä¼šå‡ºç°åœ¨å¾ˆå¤šå®ä½“ä¸Šã€‚Spring-data-jpaçš„å‡ºç°æ­£å¯ä»¥è®©è¿™æ ·ä¸€ä¸ªå·²ç»å¾ˆâ€œè–„â€çš„æ•°æ®è®¿é—®å±‚å˜æˆåªæ˜¯ä¸€å±‚æ¥å£çš„ç¼–å†™æ–¹å¼ã€‚
1 å·¥ç¨‹é…ç½® 1.1 pom &lt;?xml version="1.0" encoding="UTF-8"?> &lt;project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd"> &lt;modelVersion>4.0.0&lt;/modelVersion> &lt;groupId>com.example&lt;/groupId> &lt;artifactId>jpa-demo&lt;/artifactId> &lt;version>0.0.1-SNAPSHOT&lt;/version> &lt;packaging>jar&lt;/packaging> &lt;name>jpa-demo&lt;/name> &lt;description>Demo project for Spring Boot&lt;/description> &lt;parent> &lt;groupId>org.springframework.boot&lt;/groupId> &lt;artifactId>spring-boot-starter-parent&lt;/artifactId> &lt;version>1.5.9.RELEASE&lt;/version> &lt;relativePath/> &lt;!-- lookup parent from repository --> &lt;/parent> &lt;properties> &lt;project.build.sourceEncoding>UTF-8&lt;/project.build.sourceEncoding> &lt;project.reporting.outputEncoding>UTF-8&lt;/project.reporting.outputEncoding> &lt;java.version>1.8&lt;/java.version> &lt;/properties> &lt;dependencies> &lt;dependency> &lt;groupId>org.springframework.boot&lt;/groupId> &lt;artifactId>spring-boot-starter-data-jpa&lt;/artifactId> &lt;/dependency> &lt;dependency> &lt;groupId>org.springframework.boot&lt;/groupId> &lt;artifactId>spring-boot-starter-web&lt;/artifactId> &lt;/dependency> &lt;dependency> &lt;groupId>mysql&lt;/groupId> &lt;artifactId>mysql-connector-java&lt;/artifactId> &lt;scope>runtime&lt;/scope> &lt;/dependency> &lt;dependency> &lt;groupId>org.projectlombok&lt;/groupId> &lt;artifactId>lombok&lt;/artifactId> &lt;optional>true&lt;/optional> &lt;/dependency> &lt;dependency> &lt;groupId>org.springframework.boot&lt;/groupId> &lt;artifactId>spring-boot-starter-test&lt;/artifactId> &lt;scope>test&lt;/scope> &lt;/dependency> &lt;/dependencies> &lt;build> &lt;plugins> &lt;plugin> &lt;groupId>org....</p></section><footer class=entry-footer>March 24, 2018&nbsp;Â·&nbsp;2 min&nbsp;Â·&nbsp;Lucas</footer><a class=entry-link aria-label="post link to Spring Data Jpaå®æˆ˜" href=https://zhenfeng-zhu.github.io/posts/spring-data-jpa%E5%AE%9E%E6%88%98/></a></article><article class=post-entry><header class=entry-header><h2>spring bootå¤šæ•°æ®æºé…ç½®</h2></header><section class=entry-content><p>spring bootå¤šæ•°æ®æºé…ç½® åœ¨å•æ•°æ®æºçš„æƒ…å†µä¸‹ï¼ŒSpring Bootçš„é…ç½®éå¸¸ç®€å•ï¼Œåªéœ€è¦åœ¨application.propertiesæ–‡ä»¶ä¸­é…ç½®è¿æ¥å‚æ•°å³å¯ã€‚ä½†æ˜¯å¾€å¾€éšç€ä¸šåŠ¡é‡å‘å±•ï¼Œæˆ‘ä»¬é€šå¸¸ä¼šè¿›è¡Œæ•°æ®åº“æ‹†åˆ†æˆ–æ˜¯å¼•å…¥å…¶ä»–æ•°æ®åº“ï¼Œä»è€Œæˆ‘ä»¬éœ€è¦é…ç½®å¤šä¸ªæ•°æ®æºã€‚
1 å‡†å¤‡ 1.1 ç¦æ­¢DataSourceAutoConfiguration é¦–å…ˆè¦å°†spring bootè‡ªå¸¦çš„DataSourceAutoConfigurationç¦æ‰ï¼Œå› ä¸ºå®ƒä¼šè¯»å–application.propertiesæ–‡ä»¶çš„spring.datasource.*å±æ€§å¹¶è‡ªåŠ¨é…ç½®å•æ•°æ®æºã€‚åœ¨@SpringBootApplicationæ³¨è§£ä¸­æ·»åŠ excludeå±æ€§å³å¯ï¼š
@SpringBootApplication(exclude = {DataSourceAutoConfiguration.class}) public class DemoApplication { public static void main(String[] args) { SpringApplication.run(JpaDemoApplication.class, args); } } 1.2 é…ç½®æ•°æ®åº“è¿æ¥ ç„¶ååœ¨application.propertiesä¸­é…ç½®å¤šæ•°æ®æºè¿æ¥ä¿¡æ¯ï¼š
spring.datasource.primary.url=jdbc:mysql://localhost:3306/test spring.datasource.primary.username=root spring.datasource.primary.password=root spring.datasource.primary.driver-class-name=com.mysql.jdbc.Driver spring.datasource.secondary.url=jdbc:mysql://localhost:3306/test1 spring.datasource.secondary.username=root spring.datasource.secondary.password=root spring.datasource.secondary.driver-class-name=com.mysql.jdbc.Driver 1.3 æ‰‹æ®µåˆ›å»ºæ•°æ®æº ç”±äºæˆ‘ä»¬ç¦æ‰äº†è‡ªåŠ¨æ•°æ®æºé…ç½®ï¼Œå› äº›ä¸‹ä¸€æ­¥å°±éœ€è¦æ‰‹åŠ¨å°†è¿™äº›æ•°æ®æºåˆ›å»ºå‡ºæ¥ï¼š
@Configuration public class DataSourceConfig { @Bean(name = "primaryDataSource") // @Qualifier(value = "primaryDataSource") @ConfigurationProperties(prefix = "spring.datasource.primary") public DataSource primaryDataSource(){ return DataSourceBuilder.create().build(); } @Bean(name = "secondaryDataSource") // @Qualifier(value = "secondaryDataSource") @ConfigurationProperties(prefix = "spring....</p></section><footer class=entry-footer>March 24, 2018&nbsp;Â·&nbsp;3 min&nbsp;Â·&nbsp;Lucas</footer><a class=entry-link aria-label="post link to spring bootå¤šæ•°æ®æºé…ç½®" href=https://zhenfeng-zhu.github.io/posts/spring-boot%E5%A4%9A%E6%95%B0%E6%8D%AE%E6%BA%90%E9%85%8D%E7%BD%AE/></a></article><article class=post-entry><header class=entry-header><h2>spring bootè¿æ¥redis</h2></header><section class=entry-content><p>Spring-data-redisä¸ºspring-dataæ¨¡å—ä¸­å¯¹redisçš„æ”¯æŒéƒ¨åˆ†ï¼Œç®€ç§°ä¸ºâ€œSDRâ€ï¼Œæä¾›äº†åŸºäºjediså®¢æˆ·ç«¯APIçš„é«˜åº¦å°è£…ä»¥åŠä¸springå®¹å™¨çš„æ•´åˆï¼Œ
jediså®¢æˆ·ç«¯åœ¨ç¼–ç¨‹å®æ–½æ–¹é¢å­˜åœ¨å¦‚ä¸‹ä¸è¶³ï¼š
connectionç®¡ç†ç¼ºä¹è‡ªåŠ¨åŒ–ï¼Œconnection-poolçš„è®¾è®¡ç¼ºå°‘å¿…è¦çš„å®¹å™¨æ”¯æŒã€‚ æ•°æ®æ“ä½œéœ€è¦å…³æ³¨â€œåºåˆ—åŒ–â€/â€œååºåˆ—åŒ–â€ï¼Œå› ä¸ºjedisçš„å®¢æˆ·ç«¯APIæ¥å—çš„æ•°æ®ç±»å‹ä¸ºstringå’Œbyteï¼Œå¯¹ç»“æ„åŒ–æ•°æ®(json,xml,pojoç­‰)æ“ä½œéœ€è¦é¢å¤–çš„æ”¯æŒã€‚ äº‹åŠ¡æ“ä½œçº¯ç²¹ä¸ºç¡¬ç¼–ç  pub/subåŠŸèƒ½ï¼Œç¼ºä¹å¿…è¦çš„è®¾è®¡æ¨¡å¼æ”¯æŒï¼Œå¯¹äºå¼€å‘è€…è€Œè¨€éœ€è¦å…³æ³¨çš„å¤ªå¤šã€‚ 1 spring-data-redisç‰¹æ€§ è¿æ¥æ± è‡ªåŠ¨ç®¡ç†ï¼Œæä¾›äº†ä¸€ä¸ªé«˜åº¦å°è£…çš„â€œRedisTemplateâ€ç±» é’ˆå¯¹jediså®¢æˆ·ç«¯ä¸­å¤§é‡apiè¿›è¡Œäº†å½’ç±»å°è£…,å°†åŒä¸€ç±»å‹æ“ä½œå°è£…ä¸ºoperationæ¥å£ ValueOperationsï¼šç®€å•K-Væ“ä½œ SetOperationsï¼šsetç±»å‹æ•°æ®æ“ä½œ ZSetOperationsï¼šzsetç±»å‹æ•°æ®æ“ä½œ HashOperationsï¼šé’ˆå¯¹mapç±»å‹çš„æ•°æ®æ“ä½œ ListOperationsï¼šé’ˆå¯¹listç±»å‹çš„æ•°æ®æ“ä½œ æä¾›äº†å¯¹keyçš„â€œboundâ€(ç»‘å®š)ä¾¿æ·åŒ–æ“ä½œAPIï¼Œå¯ä»¥é€šè¿‡boundå°è£…æŒ‡å®šçš„keyï¼Œç„¶åè¿›è¡Œä¸€ç³»åˆ—çš„æ“ä½œè€Œæ— é¡»â€œæ˜¾å¼â€çš„å†æ¬¡æŒ‡å®šKeyï¼Œå³BoundKeyOperationsï¼š BoundValueOperations BoundSetOperations BoundListOperations BoundSetOperations BoundHashOperations å°†äº‹åŠ¡æ“ä½œå°è£…ï¼Œæœ‰å®¹å™¨æ§åˆ¶ã€‚ é’ˆå¯¹æ•°æ®çš„â€œåºåˆ—åŒ–/ååºåˆ—åŒ–â€ï¼Œæä¾›äº†å¤šç§å¯é€‰æ‹©ç­–ç•¥(RedisSerializer) JdkSerializationRedisSerializerï¼šPOJOå¯¹è±¡çš„å­˜å–åœºæ™¯ï¼Œä½¿ç”¨JDKæœ¬èº«åºåˆ—åŒ–æœºåˆ¶ï¼Œå°†pojoç±»é€šè¿‡ObjectInputStream/ObjectOutputStreamè¿›è¡Œåºåˆ—åŒ–æ“ä½œï¼Œæœ€ç»ˆredis-serverä¸­å°†å­˜å‚¨å­—èŠ‚åºåˆ—ã€‚æ˜¯ç›®å‰æœ€å¸¸ç”¨çš„åºåˆ—åŒ–ç­–ç•¥ã€‚ StringRedisSerializerï¼šKeyæˆ–è€…valueä¸ºå­—ç¬¦ä¸²çš„åœºæ™¯ï¼Œæ ¹æ®æŒ‡å®šçš„charsetå¯¹æ•°æ®çš„å­—èŠ‚åºåˆ—ç¼–ç æˆstringï¼Œæ˜¯â€œnew String(bytes, charset)â€å’Œâ€œstring.getBytes(charset)â€çš„ç›´æ¥å°è£…ã€‚æ˜¯æœ€è½»é‡çº§å’Œé«˜æ•ˆçš„ç­–ç•¥ã€‚ JacksonJsonRedisSerializerï¼šjackson-jsonå·¥å…·æä¾›äº†javabeanä¸jsonä¹‹é—´çš„è½¬æ¢èƒ½åŠ›ï¼Œå¯ä»¥å°†pojoå®ä¾‹åºåˆ—åŒ–æˆjsonæ ¼å¼å­˜å‚¨åœ¨redisä¸­ï¼Œä¹Ÿå¯ä»¥å°†jsonæ ¼å¼çš„æ•°æ®è½¬æ¢æˆpojoå®ä¾‹ã€‚å› ä¸ºjacksonå·¥å…·åœ¨åºåˆ—åŒ–å’Œååºåˆ—åŒ–æ—¶ï¼Œéœ€è¦æ˜ç¡®æŒ‡å®šClassç±»å‹ï¼Œå› æ­¤æ­¤ç­–ç•¥å°è£…èµ·æ¥ç¨å¾®å¤æ‚ã€‚ OxmSerializerï¼šæä¾›äº†å°†javabeanä¸xmlä¹‹é—´çš„è½¬æ¢èƒ½åŠ›ï¼Œç›®å‰å¯ç”¨çš„ä¸‰æ–¹æ”¯æŒåŒ…æ‹¬jaxbï¼Œapache-xmlbeansï¼›rediså­˜å‚¨çš„æ•°æ®å°†æ˜¯xmlå·¥å…·ã€‚ä¸è¿‡ä½¿ç”¨æ­¤ç­–ç•¥ï¼Œç¼–ç¨‹å°†ä¼šæœ‰äº›éš¾åº¦ï¼Œè€Œä¸”æ•ˆç‡æœ€ä½ï¼›ä¸å»ºè®®ä½¿ç”¨ã€‚ åŸºäºè®¾è®¡æ¨¡å¼ï¼Œå’ŒJMSå¼€å‘æ€è·¯ï¼Œå°†pub/subçš„APIè®¾è®¡è¿›è¡Œäº†å°è£…ï¼Œä½¿å¼€å‘æ›´åŠ ä¾¿æ·ã€‚ spring-data-redisä¸­ï¼Œå¹¶æ²¡æœ‰å¯¹shardingæä¾›è‰¯å¥½çš„å°è£…ï¼Œå¦‚æœä½ çš„æ¶æ„æ˜¯åŸºäºshardingï¼Œé‚£ä¹ˆä½ éœ€è¦è‡ªå·±å»å®ç°ï¼Œè¿™ä¹Ÿæ˜¯sdrå’Œjedisç›¸æ¯”ï¼Œå”¯ä¸€ç¼ºå°‘çš„ç‰¹æ€§ã€‚ 2 å¼•å…¥ä¾èµ– &lt;dependency> &lt;groupId>org.springframework.boot&lt;/groupId> &lt;artifactId>spring-boot-starter-data-redis&lt;/artifactId> &lt;/dependency> 3 é…ç½® # REDIS (RedisProperties) # Redisæ•°æ®åº“ç´¢å¼•ï¼ˆé»˜è®¤ä¸º0ï¼‰ spring.redis.database=0 # RedisæœåŠ¡å™¨åœ°å€ spring.redis.host=localhost # RedisæœåŠ¡å™¨è¿æ¥ç«¯å£ spring.redis.port=6379 # RedisæœåŠ¡å™¨è¿æ¥å¯†ç ï¼ˆé»˜è®¤ä¸ºç©ºï¼‰ spring.redis.password=root # è¿æ¥æ± æœ€å¤§è¿æ¥æ•°ï¼ˆä½¿ç”¨è´Ÿå€¼è¡¨ç¤ºæ²¡æœ‰é™åˆ¶ï¼‰ spring.redis.pool.max-active=8 # è¿æ¥æ± æœ€å¤§é˜»å¡ç­‰å¾…æ—¶é—´ï¼ˆä½¿ç”¨è´Ÿå€¼è¡¨ç¤ºæ²¡æœ‰é™åˆ¶ï¼‰ spring....</p></section><footer class=entry-footer>March 24, 2018&nbsp;Â·&nbsp;2 min&nbsp;Â·&nbsp;Lucas</footer><a class=entry-link aria-label="post link to spring bootè¿æ¥redis" href=https://zhenfeng-zhu.github.io/posts/spring-boot%E8%BF%9E%E6%8E%A5redis/></a></article><article class=post-entry><header class=entry-header><h2>æœ€ç»ˆä¸€è‡´æ€§çš„å®ç°æ‰‹æ®µ</h2></header><section class=entry-content><p>æœ€ç»ˆä¸€è‡´æ€§çš„å®ç°æ‰‹æ®µ å®ç°æœ€ç»ˆä¸€è‡´æ€§æœ‰ä¸‰ç§æ‰‹æ®µï¼šå¯é äº‹ä»¶æ¨¡å¼ã€ä¸šåŠ¡è¡¥å¿æ¨¡å¼å’ŒTCCæ¨¡å¼
1 å¯é äº‹ä»¶æ¨¡å¼ å¯é äº‹ä»¶æ¨¡å¼å±äºäº‹ä»¶é©±åŠ¨æ¶æ„ï¼Œå½“æŸä»¶é‡è¦çš„äº‹æƒ…å‘ç”Ÿæ—¶ï¼Œæ¯”å¦‚æ›´æ–°ä¸€ä¸ªä¸šåŠ¡å®ä½“ï¼Œå¾®æœåŠ¡ä¼šå‘æ¶ˆæ¯ä»£ç†å‘å¸ƒä¸€ä¸ªäº‹ä»¶ã€‚æ¶ˆæ¯ä»£ç†ä¼šå°†è®¢é˜…äº‹ä»¶çš„å¾®æœåŠ¡æ¨é€äº‹ä»¶ã€‚
è¦å®ç°è¿™ç§æ¨¡å¼éœ€è¦æ¶ˆæ¯é˜Ÿåˆ—å®ç°äº‹ä»¶çš„æŒä¹…åŒ–å’Œat least onceçš„å¯é äº‹ä»¶æŠ•é€’æ¨¡å¼ã€‚
1.1 æœ¬åœ°äº‹ä»¶è¡¨ æœ¬åœ°äº‹ä»¶è¡¨æ–¹æ³•æ˜¯å°†äº‹ä»¶å’Œä¸šåŠ¡æ•°æ®ä¿å­˜åœ¨åŒä¸€ä¸ªæ•°æ®åº“ä¸­ï¼Œä½¿ç”¨ä¸€ä¸ªé¢å¤–çš„äº‹ä»¶æ¢å¤æœåŠ¡æ¥æ¢å¤äº‹ä»¶ï¼Œç”±æœ¬åœ°äº‹ç‰©ä¿è¯æ›´æ–°ä¸šåŠ¡å’Œå‘å¸ƒäº‹ä»¶çš„åŸå­æ€§ã€‚
ä½†æ˜¯ä¸šåŠ¡ç³»ç»Ÿå’Œäº‹ä»¶ç³»ç»Ÿè€¦åˆæ¯”è¾ƒç´§å¯†ï¼Œé¢å¤–çš„äº‹ä»¶æ•°æ®åº“æ“ä½œä¹Ÿä¼šç»™æ•°æ®åº“å¸¦æ¥é¢å¤–çš„å‹åŠ›ï¼Œå¯èƒ½æˆä¸ºç“¶é¢ˆã€‚
1.2 å¤–éƒ¨äº‹ä»¶ æ­¤æ–¹æ³•æ˜¯å°†äº‹ä»¶æŒä¹…åŒ–åˆ°å¤–éƒ¨çš„äº‹ä»¶ç³»ç»Ÿï¼Œäº‹ä»¶ç³»ç»Ÿéœ€è¦æä¾›å®æ—¶äº‹ä»¶æœåŠ¡ä»¥æ¥å—å¾®æœåŠ¡å‘å¸ƒçš„äº‹ä»¶ï¼ŒåŒæ—¶äº‹ä»¶ç³»ç»Ÿè¿˜éœ€è¦æä¾›äº‹ä»¶æ¢å¤æœåŠ¡æ¥ç¡®è®¤æ¢å¤äº‹ä»¶ã€‚
1.3 ä¸è¶³ æ­¤è¿‡ç¨‹å¯èƒ½å‡ºç°é‡å¤æ¶ˆè´¹çš„æƒ…å†µã€‚
2 è¡¥å¿æ¨¡å¼ ä¸€èˆ¬æ¥è®²ï¼Œå¼‚å¸¸ä¸€èˆ¬æ˜¯ç”±ä»¥ä¸‹ä¸¤ç§æƒ…å†µé€ æˆçš„ï¼š
ä¸šåŠ¡å¼‚å¸¸ï¼šä¸šåŠ¡é€»è¾‘äº§ç”Ÿçš„é”™è¯¯ï¼Œæ¯”å¦‚ä½™é¢ä¸è¶³ã€åº“å­˜ä¸è¶³ç­‰ã€‚
æŠ€æœ¯å¼‚å¸¸ï¼šéä¸šåŠ¡é€»è¾‘äº§ç”Ÿçš„å¼‚å¸¸ï¼Œæ¯”å¦‚ç½‘ç»œè¿æ¥å¼‚å¸¸ã€è¶…æ—¶ç­‰ã€‚
è¡¥å¿æ¨¡å¼å°±æ˜¯ä½¿ç”¨ä¸€ä¸ªé¢å¤–çš„åè°ƒæœåŠ¡æ¥åè°ƒå„ä¸ªéœ€è¦ä¿è¯ä¸€è‡´æ€§çš„å…¶ä»–æœåŠ¡ã€‚åè°ƒæœåŠ¡æŒ‰é¡ºåºè°ƒç”¨æ¯ä¸€ä¸ªæœåŠ¡ï¼Œå¦‚æœæŸä¸ªæœåŠ¡è°ƒç”¨å¼‚å¸¸å°±å–æ¶ˆä¹‹å‰æ‰€æœ‰å·²ç»è°ƒç”¨æˆåŠŸçš„æœåŠ¡ã€‚
å»ºè®®ä»…ç”¨äºæŠ€æœ¯å¼‚å¸¸çš„æƒ…å†µã€‚å¯¹äºä¸šåŠ¡å¼‚å¸¸æ¥è®²ï¼Œåº”è¯¥å°½å¯èƒ½çš„å»ä¼˜åŒ–ä¸šåŠ¡æ¨¡å¼ï¼Œä»¥é¿å…è¦æ±‚è¡¥å¿äº‹åŠ¡ã€‚
2.1 å¸¸ç”¨æ‰‹æ®µ åœ¨å®ç°è¡¥å¿æ¨¡å¼æ—¶åº”è¯¥åšåˆ°ä¸¤ç‚¹ï¼š
é¦–å…ˆè¦ç¡®å®šå¤±è´¥çš„æ­¥éª¤å’ŒçŠ¶æ€ï¼Œä»è€Œç¡®å®šè¦è¡¥å¿çš„èŒƒå›´ã€‚ å…¶æ¬¡è¦èƒ½æä¾›è¡¥å¿æ“ä½œä½¿ç”¨çš„ä¸šåŠ¡æ•°æ®ã€‚ å¯ä»¥é€šè¿‡è®°å½•å®Œæ•´çš„ä¸šåŠ¡æµæ°´çš„æ–¹æ³•æ¥å®ç°ä¸Šé¢ä¸¤ç‚¹è¦æ±‚ã€‚ä½†æ˜¯å¯¹äºä¸€ä¸ªé€šç”¨çš„è¡¥å¿æ¡†æ¶æ¥è¯´ï¼Œé¢„å…ˆçŸ¥é“å¾®æœåŠ¡éœ€è¦è®°å½•çš„ä¸šåŠ¡è¦ç´ æ˜¯ä¸å¯èƒ½çš„ï¼Œé‚£ä¹ˆå°±éœ€è¦ä¸€ç§åŠæ³•æ¥ä¿è¯ä¸šåŠ¡æµæ°´çš„å¯æ‰©å±•æ€§ï¼Œå®è·µä¸­ä¸»è¦æœ‰ä¸¤ç§æ–¹æ³•ï¼šå¤§è¡¨å’Œå…³è”è¡¨ã€‚
å¤§è¡¨ï¼Œé¡¾æ˜æ€è®®å°±æ˜¯è®¾è®¡æ—¶é™¤äº†å¿…é¡»çš„å­—æ®µå¤–ï¼Œè¿˜éœ€è¦é¢„ç•™å¤§é‡çš„å¤‡ç”¨å­—æ®µï¼Œæ¡†æ¶å¯ä»¥æä¾›è¾…åŠ©å·¥å…·æ¥å°†ä¸šåŠ¡æ•°æ®æ˜ å°„åˆ°å¤‡ç”¨å­—æ®µä¸­ã€‚å¤§è¡¨å¯¹äºæ¡†æ¶å±‚å®ç°èµ·æ¥æ¯”è¾ƒç®€å•ï¼Œä½†æ˜¯ä¹Ÿæœ‰ä¸€äº›éš¾ç‚¹ï¼Œæ¯”å¦‚é¢„ç•™å¤šå°‘ä¸ªå­—æ®µåˆé€‚ï¼Œæ¯ä¸ªå­—æ®µåˆéœ€è¦é¢„ç•™å¤šé•¿ã€‚è¿˜æœ‰ä¸€ä¸ªéš¾ç‚¹æ˜¯å¦‚æœä»…ä»æ•°æ®å±‚é¢æ¥æŸ¥è¯¢æ•°æ®ï¼Œå¾ˆéš¾ä¸€çœ¼çœ‹å‡ºå¤‡ç”¨å­—æ®µçš„ä¸šåŠ¡å«ä¹‰ï¼Œç»´æŠ¤è¿‡ç¨‹ä¸å‹å¥½ã€‚ å…³è”è¡¨ï¼Œåˆ†ä¸ºæŠ€æœ¯è¡¨å’Œä¸šåŠ¡è¡¨ã€‚æŠ€æœ¯è¡¨ä¸­ä¿å­˜ä¸ºå®ç°è¡¥å¿æ“ä½œæ‰€éœ€è¦çš„æŠ€æœ¯æ•°æ®ï¼Œä¸šåŠ¡è¡¨ä¸­ä¿å­˜ä¸šåŠ¡æ•°æ®ã€‚é€šè¿‡åœ¨æŠ€æœ¯è¡¨ä¸­å¢åŠ ä¸šåŠ¡è¡¨åå’Œä¸šåŠ¡è¡¨ä¸»é”®æ¥å»ºç«‹å’Œä¸šåŠ¡æ•°æ®çš„å…³è”ã€‚å…³è”è¡¨æ›´çµæ´»ï¼Œèƒ½æ”¯æŒä¸åŒä¸šåŠ¡ç±»å‹è®°å½•ä¸åŒçš„ä¸šåŠ¡è¦ç´ ã€‚ä½†æ˜¯åœ¨æ¡†æ¶çš„å®ç°ä¸Šéš¾åº¦è¾ƒé«˜ï¼Œæ¯æ¬¡æŸ¥è¯¢éƒ½éœ€è¦å¤æ‚çš„å…³è”åŠ¨ä½œï¼Œæ€§èƒ½ä¼šå—åˆ°å½±å“ã€‚ 2.2 é‡è¯• è¡¥å¿è¿‡ç¨‹ä½œä¸ºä¸€ä¸ªæœåŠ¡ï¼Œåœ¨è°ƒç”¨çš„æ—¶å€™ä¹Ÿä¼šå‡ºç°ä¸æˆåŠŸçš„æƒ…å†µï¼Œè¿™æ—¶å°±è¦é€šè¿‡é‡è¯•æœºåˆ¶æ¥ä¿è¯è¡¥å¿çš„æˆåŠŸç‡ã€‚å› æ­¤è¦æ±‚è¡¥å¿æ“ä½œå…·æœ‰å¹‚ç­‰æ€§ã€‚
ä½†æ˜¯ä¹Ÿä¸æ˜¯ç›²ç›®çš„é‡è¯•ï¼Œæˆ‘ä»¬éœ€è¦æ ¹æ®æœåŠ¡æ‰§è¡Œå¤±è´¥çš„åŸå› æ¥é€‰æ‹©ä¸åŒçš„ç­–ç•¥ï¼š
å› ä¸šåŠ¡å› ç´ å¯¼è‡´å¤±è´¥ï¼Œéœ€è¦åœæ­¢é‡è¯•ã€‚ ç½•è§çš„å¼‚å¸¸ï¼Œå¦‚ç½‘ç»œä¸­æ–­ï¼Œä¼ è¾“è¿‡ç¨‹ä¸­æ•°æ®ä¸¢å¤±ï¼Œåº”è¯¥ç«‹å³é‡è¯•ã€‚ å¦‚æœæ˜¯å› ä¸ºç³»ç»Ÿç¹å¿™ï¼Œæ­¤æ—¶éœ€è¦ç­‰å¾…ä¸€æ®µæ—¶é—´å†é‡è¯•ã€‚ 2.3 ä¸è¶³ åœ¨è¡¥å¿æ¨¡å¼ä¸­æœ‰ä¸€ä¸ªæ˜æ˜¾çš„ç¼ºé™·æ˜¯éš”ç¦»æ€§ï¼Œä»ç¬¬ä¸€ä¸ªæœåŠ¡å¼€å§‹ä¸€ç›´åˆ°è¡¥å¿å®Œæˆï¼Œä¸ä¸€è‡´æ€§æ˜¯å¯¹å…¶ä»–æœåŠ¡å¯è§çš„ã€‚å¦å¤–è¡¥å¿æ¨¡å¼è¿‡åˆ†ä¾èµ–åè°ƒæœåŠ¡çš„å¥å£®æ€§ï¼Œå¦‚æœåè°ƒæœåŠ¡å¼‚å¸¸ï¼Œåˆ™æ²¡åŠæ³•è¾¾åˆ°ä¸€è‡´æ€§ã€‚
3 TCCæ¨¡å¼ TCCï¼Œæ˜¯Tryï¼ŒConfirmå’ŒCancelçš„ç¼©å†™ã€‚ä¸€ä¸ªå®Œæ•´çš„TCCä¸šåŠ¡ä¸€èˆ¬æ˜¯ç”±ä¸€ä¸ªä¸»ä¸šåŠ¡å’Œè‹¥å¹²ä¸ªä»ä¸šåŠ¡ç»„æˆã€‚
Try å®Œæˆæ‰€æœ‰ä¸šåŠ¡æ£€æŸ¥ é¢„ç•™å¿…é¡»çš„ä¸šåŠ¡èµ„æº Confirm çœŸæ­£æ‰§è¡Œä¸šåŠ¡ ä¸åšä»»ä½•ä¸šåŠ¡æ£€æŸ¥ åªä½¿ç”¨Tryé˜¶æ®µé¢„ç•™çš„ä¸šåŠ¡èµ„æº æ»¡è¶³å¹‚ç­‰æ€§ Cancel é‡Šæ”¾Tryé˜¶æ®µé¢„ç•™çš„ä¸šåŠ¡èµ„æº æ»¡è¶³å¹‚ç­‰æ€§ 3....</p></section><footer class=entry-footer>March 24, 2018&nbsp;Â·&nbsp;1 min&nbsp;Â·&nbsp;Lucas</footer><a class=entry-link aria-label="post link to æœ€ç»ˆä¸€è‡´æ€§çš„å®ç°æ‰‹æ®µ" href=https://zhenfeng-zhu.github.io/posts/%E6%9C%80%E7%BB%88%E4%B8%80%E8%87%B4%E6%80%A7%E7%9A%84%E5%AE%9E%E7%8E%B0%E6%89%8B%E6%AE%B5/></a></article><article class=post-entry><header class=entry-header><h2>Reactiveå¾®æœåŠ¡</h2></header><section class=entry-content><p>Reactiveå¾®æœåŠ¡ åˆ†å¸ƒå¼ç³»ç»Ÿæ„å»ºèµ·æ¥å¾ˆå›°éš¾ï¼Œå› ä¸ºå®ƒä»¬å®¹æ˜“å‡ºé—®é¢˜ï¼Œè¿è¡Œç¼“æ…¢ï¼Œå¹¶ä¸”è¢«CAPå’ŒFLPç†è®ºæ‰€é™åˆ¶ã€‚æ¢å¥è¯è¯´ï¼Œå®ƒä»¬çš„æ„å»ºå’Œè¿ç»´éƒ½ç‰¹åˆ«å¤æ‚ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œreactiveä¾¿å‡ºç°äº†ã€‚
Reactiveç¼–ç¨‹ï¼šä¸€ç§å¼€å‘æ¨¡å‹ï¼Œå…¶ä¸“æ³¨äºæ•°æ®æµå‘ã€å¯¹å˜åŒ–çš„åé¦ˆï¼Œä»¥åŠä¼ æ’­ä»–ä»¬ã€‚
åœ¨reactiveç¼–ç¨‹ä¸­ï¼Œåˆºæ¿€ä¿¡å·æ˜¯æ•°æ®çš„è½¬ç§»ï¼Œå«åšstreamsã€‚å…¶å®å¾ˆåƒç”Ÿäº§è€…â€”â€”æ¶ˆè´¹è€…æ¨¡å¼ï¼Œæ¶ˆè´¹è€…å¯¹å€¼è¿›è¡Œè®¢é˜…å¹¶å“åº”ã€‚
Reactiveç³»ç»Ÿï¼šä¸€ç§æ¶æ„é£æ ¼ï¼Œå…¶åŸºäºå¼‚æ­¥æ¶ˆæ¯æ¥æ„å»ºå“åº”å¼çš„åˆ†å¸ƒå¼ç³»ç»Ÿã€‚
reactiveç³»ç»Ÿä½¿ç”¨äº†æ¶ˆæ¯é©±åŠ¨çš„æ–¹æ³•ã€‚æ‰€æœ‰çš„æ„å»ºé€šè¿‡å¼‚æ­¥æ¶ˆæ¯çš„å‘é€å’Œæ¥æ”¶æ¥äº¤äº’ã€‚æ¶ˆæ¯æŠ•é€’çš„é€»è¾‘ç”±åº•å±‚çš„å®ç°å†³å®šã€‚å‘é€è€…ä¸ä¼šé˜»å¡ç€ç­‰å¾…å›å¤ï¼Œå®ƒä»¬å¯èƒ½ä¼šç¨åæ‰æ¥æ”¶åˆ°å›å¤ã€‚
reactiveç³»ç»Ÿä¼šæœ‰ä¸¤ä¸ªé‡è¦çš„ç‰¹å¾ï¼š
ä¼¸ç¼©æ€§â€”â€”å¯ä»¥æ¨ªå‘ä¼¸ç¼©
ä¼¸ç¼©æ€§æ¥è‡ªæ¶ˆæ¯ä¼ é€’çš„è§£è€¦ã€‚æ¶ˆæ¯è¢«å‘é€åˆ°ä¸€ä¸ªåœ°å€ä¹‹åï¼Œå¯ä»¥è¢«ä¸€ç»„æ¶ˆè´¹è€…æŒ‰ç…§ä¸€ç§è´Ÿè½½å‡è¡¡æ–¹æ³•æ¶ˆè´¹ã€‚å½“reactiveç³»ç»Ÿé‡åˆ°è´Ÿè½½é«˜å³°æ—¶ï¼Œå®ƒå¯ä»¥åˆ›é€ å‡ºæ–°çš„æ¶ˆè´¹è€…ï¼Œå¹¶åœ¨æ­¤ä¹‹åé”€æ¯å®ƒä»¬ã€‚
æ¢å¤æ€§â€”â€”å¯ä»¥å¤„ç†é”™è¯¯å¹¶ä¸”æ¢å¤
é¦–å…ˆï¼Œè¿™ç§æ¶ˆæ¯äº¤äº’æ¨¡å¼å…è®¸ç»„ä»¶åœ¨å…¶æœ¬åœ°å¤„ç†é”™è¯¯ï¼Œç»„ä»¶ä¸éœ€è¦ç­‰å¾…æ¶ˆæ¯ï¼Œå› æ­¤å½“ä¸€ä¸ªç»„ä»¶å‘ç”Ÿé”™è¯¯æ—¶ï¼Œå…¶ä»–ç»„ä»¶ä»ç„¶ä¼šæ­£å¸¸å·¥ä½œã€‚å…¶æ¬¡ï¼Œå½“ä¸€ä¸ªå¤„ç†æ¶ˆæ¯çš„ç»„ä»¶å‘ç”Ÿé”™è¯¯åï¼Œæ¶ˆæ¯å¯ä»¥å¯ä»¥ä¼ é€’ç»™åœ¨ç›¸åŒåœ°å€æ³¨å†Œçš„å…¶ä»–ç»„ä»¶ã€‚
reactiveå¾®æœåŠ¡ç³»ç»Ÿæ˜¯ç”±reactiveå¾®æœåŠ¡ç»„æˆçš„ã€‚è¿™äº›å¾®æœåŠ¡æœ‰ä¸‹é¢å››ä¸ªç‰¹å¾ï¼š
è‡ªæ²»æ€§ å¼‚æ­¥æ€§ æ¢å¤æ€§ ä¼¸ç¼©æ€§ Reactiveå¾®æœåŠ¡æ˜¯å¯è‡ªæ²»çš„ã€‚ä»–ä»¬å¯ä»¥æ ¹æ®å‘¨å›´çš„æœåŠ¡æ˜¯å¦å¯ç”¨æ¥è°ƒæ•´è‡ªå·±çš„è¡Œä¸ºã€‚è‡ªæ²»æ€§å¾€å¾€ä¼´éšç€å­¤ç«‹æ€§ï¼›Reactiveå¾®æœåŠ¡å¯ä»¥åœ¨æœ¬åœ°å¤„ç†é”™è¯¯ã€ç‹¬ç«‹åœ°å®Œæˆä»»åŠ¡ï¼Œå¹¶åœ¨å¿…è¦æ—¶å’Œå…¶ä»–æœåŠ¡åˆä½œã€‚å®ƒä»¬ä½¿ç”¨å¼‚æ­¥æ¶ˆæ¯ä¼ é€’çš„æœºåˆ¶å’Œå…¶ä»–æœåŠ¡æ²Ÿé€šï¼›å®ƒä»¬ä¹Ÿä¼šæ¥æ”¶æ¶ˆæ¯å¹¶ä¸”å¯¹å…¶ä½œå‡ºå›åº”ã€‚
å¾—ç›Šäºå¼‚æ­¥æ¶ˆæ¯æœºåˆ¶ï¼Œreactiveå¾®æœåŠ¡å¯ä»¥å¤„ç†é”™è¯¯å¹¶æ ¹æ®æƒ…å†µè°ƒæ•´è‡ªå·±çš„è¡Œä¸ºã€‚é”™è¯¯ä¸ä¼šè¢«æ‰©æ•£ï¼Œè€Œæ˜¯åœ¨é è¿‘é”™è¯¯æºå¤´çš„åœ°æ–¹è¢«å¤„ç†æ‰ã€‚å½“ä¸€ä¸ªå¾®æœåŠ¡æŒ‚æ‰ä¹‹åï¼Œå®ƒçš„æ¶ˆè´¹è€…å¾®æœåŠ¡è¦èƒ½å¤Ÿå¤„ç†é”™è¯¯å¹¶é¿å…æ‰©æ•£ã€‚è¿™ä¸€å­¤ç«‹åŸåˆ™æ˜¯é¿å…é”™è¯¯é€å±‚ä¸Šæµ®è€Œæ¯æ‰æ•´ä¸ªç³»ç»Ÿçš„å…³é”®ã€‚å¯æ¢å¤æ€§ä¸åªæ˜¯å…³äºå¤„ç†é”™è¯¯ï¼Œå®ƒè¿˜æ¶‰åŠåˆ°è‡ªæ„ˆæ€§ï¼›ä¸€ä¸ªreactiveå¾®æœåŠ¡åº”è¯¥èƒ½å¤Ÿä»é”™è¯¯ä¸­æ¢å¤å¹¶ä¸”å¯¹é”™è¯¯è¿›è¡Œè¡¥æ•‘ã€‚
æœ€åï¼Œreactiveå¾®æœåŠ¡å¿…é¡»æ˜¯å¯ä¼¸ç¼©çš„ï¼Œè¿™æ ·ç³»ç»Ÿæ‰å¯ä»¥æ ¹æ®è´Ÿè½½æƒ…å†µæ¥è°ƒæ•´èŠ‚ç‚¹æ•°é‡ã€‚è¿™ä¸€ç‰¹æ€§æ„å‘³ç€å°†ä¼šæœ‰ä¸€ç³»åˆ—çš„é™åˆ¶ï¼Œæ¯”å¦‚ä¸èƒ½æœ‰åœ¨å†…å­˜ä¸­çš„çŠ¶æ€ï¼Œè¦èƒ½å¤Ÿåœ¨å¿…è¦æ—¶åŒæ­¥çŠ¶æ€ä¿¡æ¯ï¼Œæˆ–è€…è¦èƒ½å¤Ÿå°†æ¶ˆæ¯è·¯ç”±åˆ°çŠ¶æ€ä¿¡æ¯ç›¸åŒçš„èŠ‚ç‚¹ã€‚
Vert.x Vert.xæ˜¯ä¸€ä¸ªç”¨äºæ„å»ºreactiveå’Œåˆ†å¸ƒå¼ç³»ç»Ÿçš„å·¥å…·ç®±ï¼Œå…¶ä½¿ç”¨äº†å¼‚æ­¥éé˜»å¡ç¼–ç¨‹æ¨¡å‹ã€‚å½“ä½¿ç”¨Vert.xæ„å»ºå¾®æœåŠ¡çš„æ—¶å€™ï¼Œå¾®æœåŠ¡ä¼šè‡ªç„¶åœ°å¸¦ä¸Šä¸€ä¸ªæ ¸å¿ƒç‰¹å¾ï¼šæ‰€æœ‰äº‹æƒ…éƒ½æ˜¯å¼‚æ­¥çš„ã€‚
ä¼ ç»Ÿç¼–ç¨‹æ¨¡å¼
int res = compute(1, 2); åœ¨è¿™æ®µä»£ç ä¸­ï¼Œæ˜¯åœ¨ç­‰å¾…computeå‡½æ•°è®¡ç®—å‡ºæ¥ç»“æœä¹‹åå†è¿›è¡Œå‰©ä¸‹çš„æ“ä½œã€‚è€Œåœ¨å¼‚æ­¥éé˜»å¡çš„ç¼–ç¨‹æ¨¡å¼ä¸­ï¼Œå°†ä¼šåˆ›å»ºä¸€ä¸ªhandlerï¼š
compute(1, 2, res -> { // called with the result }); åœ¨ä¸Šè¿°ä»£ç ä¸­ï¼Œcomputeå‡½æ•°ä¸å†è¿”å›ä¸€ä¸ªç»“æœï¼Œè€Œæ˜¯ä¼ ä¸€ä¸ªhandlerï¼Œå½“ç»“æœå‡†å¤‡å¥½æ—¶è°ƒç”¨å°±å¯ä»¥äº†ã€‚å¾—ç›Šäºè¿™ç§å¼€å‘æ¨¡å‹ï¼Œå¯ä»¥ä½¿ç”¨å¾ˆå°‘çš„çº¿ç¨‹å»å¤„ç†é«˜å¹¶å‘å·¥ä½œã€‚åœ¨vert.xä¸­ï¼Œåˆ°å¤„éƒ½å¯ä»¥çœ‹åˆ°è¿™ç§å½¢å¼çš„ä»£ç ï¼Œæ¯”å¦‚åˆ›å»ºhttpæœåŠ¡å™¨æ—¶ï¼š
vertx.createHttpServer() .requestHandler(request -> { request.response().end("hello vert.x"); }) .listen(8080); è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬è®©ä¸€ä¸ªrequestHandleræ¥æ”¶HTTPè¯·æ±‚(äº‹ä»¶)å¹¶ä¸”è¿”å›"hello vert.x"ã€‚Handleræ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œå½“äº‹ä»¶å‘ç”Ÿæ—¶ï¼Œå®ƒä¼šè¢«è°ƒç”¨ã€‚åœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­ï¼Œhandlerä»£ç ä¼šåœ¨æ¯æ¬¡è¯·æ±‚è¿›æ¥æ—¶è¢«è°ƒç”¨æ‰§è¡Œã€‚è¦æ³¨æ„çš„æ˜¯ï¼ŒHandlerå¹¶ä¸ä¼šè¿”å›ä¸€ä¸ªç»“æœï¼Œä½†æ˜¯å®ƒå¯ä»¥æä¾›ä¸€ä¸ªç»“æœï¼›è¿™ä¸ªç»“æœæ˜¯æ€æ ·è¢«æä¾›çš„ï¼Œè¿™ä¸ªè¦çœ‹æ˜¯å“ªç§äº¤äº’è¡Œä¸ºã€‚åœ¨ä¸Šé¢çš„ä»£ç æ®µä¸­ï¼Œå®ƒåªæ˜¯å‘ä¸€ä¸ªHTTP responseå†™å…¥äº†ç»“æœã€‚è¿™ä¸ªHandleråé¢è·Ÿäº†ä¸€ä¸ªæ–¹æ³•ä»¤å…¶ç›‘å¬8080ç«¯å£ã€‚è°ƒç”¨è¿™ä¸ªHTTPæœåŠ¡å®ƒä¼šè¿”å›ä¸€ä¸ªç®€å•çš„responseã€‚
event loop ç»å¤§å¤šæ•°æƒ…å†µï¼ŒVert.xä¼šç”¨ä¸€ä¸ªå«åševent loopçš„çº¿ç¨‹æ¥è°ƒç”¨æ‰€æœ‰çš„handlerã€‚
åŸºäºæ¶ˆæ¯å¾ªç¯çš„çº¿ç¨‹æ¨¡å‹æœ‰ä¸€ä¸ªå¾ˆå¤§çš„ä¼˜ç‚¹ï¼šå®ƒç®€åŒ–äº†å¹¶å‘ã€‚å› ä¸ºåªæœ‰ä¸€ä¸ªçº¿ç¨‹å­˜åœ¨ï¼Œå› æ­¤æ°¸è¿œéƒ½åªè¢«ä¸€ä¸ªçº¿ç¨‹è°ƒç”¨è€Œä¸å­˜åœ¨å¹¶å‘çš„æƒ…å†µã€‚ä½†æ˜¯åŒæ ·ä¹Ÿæœ‰ä¸€ä¸ªé™åˆ¶ï¼š
ä¸è¦é˜»å¡æ¶ˆæ¯å¾ªç¯
å› ä¸ºæ²¡æœ‰é˜»å¡ï¼Œä¸€ä¸ªæ¶ˆæ¯å¾ªç¯çº¿ç¨‹å¯ä»¥çŸ­æ—¶é—´å†…åˆ†å‘å·¨é‡çš„äº‹ä»¶ï¼Œè¿™ä¸ªæ¨¡å¼å°±å«åšreactoræ¨¡å¼ã€‚
verticles Verticlesæ˜¯è¢«Vert.xéƒ¨ç½²å’Œè¿è¡Œçš„ä»£ç å—ã€‚ä¸€ä¸ªå¾®æœåŠ¡çš„åº”ç”¨ï¼Œæ˜¯ç”±è¿è¡Œåœ¨åŒä¸€ä¸ªVert.xå®ä¾‹ä¸Šçš„è‹¥å¹²verticleç»„æˆçš„ã€‚ä¸€ä¸ªverticleé€šå¸¸ä¼šåˆ›å»ºæœåŠ¡å™¨æˆ–å®¢æˆ·ç«¯ã€æ³¨å†Œä¸€ç»„Handlerï¼Œä»¥åŠå°è£…ä¸€éƒ¨åˆ†ç³»ç»Ÿçš„ä¸šåŠ¡å¤„ç†é€»è¾‘ã€‚...</p></section><footer class=entry-footer>March 24, 2018&nbsp;Â·&nbsp;1 min&nbsp;Â·&nbsp;Lucas</footer><a class=entry-link aria-label="post link to Reactiveå¾®æœåŠ¡" href=https://zhenfeng-zhu.github.io/posts/reactive%E5%BE%AE%E6%9C%8D%E5%8A%A1/></a></article><article class=post-entry><header class=entry-header><h2>Guiceå¿«é€Ÿå…¥é—¨</h2></header><section class=entry-content><p>Guiceå¿«é€Ÿå…¥é—¨ æ¥æ‰‹çš„æ–°é¡¹ç›®ä¸»è¦æ˜¯ä½¿ç”¨kotlin+vert.xæ¥å†™çš„ï¼Œä½¿ç”¨gradleæ„å»ºï¼Œä¾èµ–æ³¨å…¥æ¡†æ¶ä½¿ç”¨äº†guiceã€‚è¿™æ®µæ—¶é—´éƒ½æ˜¯åœ¨ç†Ÿæ‚‰ä»£ç çš„è¿‡ç¨‹ï¼Œæ¶è¡¥ä¸€äº›çŸ¥è¯†ã€‚
guiceæ˜¯è°·æ­Œæ¨å‡ºçš„ä¸€ä¸ªè½»é‡çº§çš„ä¾èµ–æ³¨å…¥æ¡†æ¶ï¼Œå½“ç„¶springä¹Ÿå¯ä»¥å®ç°ä¾èµ–æ³¨å…¥ï¼Œåªæ˜¯springå¤ªåºå¤§äº†ã€‚
1 åŸºæœ¬ä½¿ç”¨ å¼•å…¥ä¾èµ– ä½¿ç”¨gradleæˆ–è€…mavenï¼Œå¼•å…¥guiceã€‚
maven:
&lt;dependency> &lt;groupId>com.google.inject&lt;/groupId> &lt;artifactId>guice&lt;/artifactId> &lt;version>4.1.0&lt;/version> &lt;/dependency> Gradle:
compile "com.google.inject:guice:4.1.0" é¡¹ç›®éª¨æ¶ é¦–å…ˆéœ€è¦ä¸€ä¸ªä¸šåŠ¡æ¥å£ï¼ŒåŒ…å«ä¸€ä¸ªæ–¹æ³•æ¥æ‰§è¡Œä¸šåŠ¡é€»è¾‘ï¼Œå®ƒçš„å®ç°éå¸¸ç®€å•ï¼š
package com.learning.guice; public interface UserService { void process(); } package com.learning.guice; public class UserServiceImpl implements UserService { @Override public void process() { System.out.println("æˆ‘éœ€è¦åšä¸€äº›ä¸šåŠ¡é€»è¾‘"); } } ç„¶åå†™ä¸€ä¸ªæ—¥å¿—çš„æ¥å£ï¼š
package com.learning.guice; public interface LogService { void log(String msg); } package com.learning.guice; public class LogServiceImpl implements LogService { @Override public void log(String msg) { System.out.println("------LOG: " + msg); } } æœ€åæ˜¯ä¸€ä¸ªç³»ç»Ÿæ¥å£å’Œç›¸åº”çš„å®ç°ï¼Œåœ¨å®ç°ä¸­ä½¿ç”¨äº†ä¸šåŠ¡æ¥å£å’Œæ—¥å¿—æ¥å£å¤„ç†ä¸šåŠ¡é€»è¾‘å’Œæ‰“å°æ—¥å¿—ä¿¡æ¯ï¼š...</p></section><footer class=entry-footer>March 24, 2018&nbsp;Â·&nbsp;3 min&nbsp;Â·&nbsp;Lucas</footer><a class=entry-link aria-label="post link to Guiceå¿«é€Ÿå…¥é—¨" href=https://zhenfeng-zhu.github.io/posts/guice%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8/></a></article><article class=post-entry><header class=entry-header><h2>kotlinå¿«é€Ÿå…¥é—¨</h2></header><section class=entry-content><p>å¿«é€Ÿæµè§ˆä¸€ä¸‹ Kotlin çš„è¯­æ³•ã€‚
åŸºæœ¬è¯­æ³• åŒ…å®šä¹‰å’Œå¼•ç”¨ åœ¨æºæ–‡ä»¶å¤´éƒ¨ï¼š
package my.demo import java.util.* æ–¹æ³•å®šä¹‰ å¸¦æœ‰æ–¹æ³•ä½“ï¼Œå¹¶ä¸”è¿”å›ç¡®å®šç±»å‹æ•°æ®çš„å®šä¹‰æ–¹å¼ï¼Œä¾‹å¦‚æ¥å— Int ç±»å‹çš„å‚æ•°å¹¶è¿”å› Int ç±»å‹çš„å€¼ï¼š fun sum(a: Int, b: Int): Int { return a + b } å¸¦æœ‰æ–¹æ³•ä½“ï¼Œè¿”å›æ¨æ–­ç±»å‹æ•°æ®çš„å®šä¹‰æ–¹å¼ï¼Œä¾‹å¦‚ï¼š fun sum(a: Int, b: Int) = a + b è¿”å›æ— æ„ä¹‰ç±»å‹çš„å®šä¹‰æ–¹å¼ï¼š fun printSum(a: Int, b: Int): Unit { println("sum of $aand $bis ${a + b}") } æˆ–è€…çœç•¥ Unitï¼š
fun printSum(a: Int, b: Int) { println("sum of $aand $bis ${a + b}") } å˜é‡å®šä¹‰ åªèµ‹å€¼ä¸€æ¬¡ï¼ˆåªè¯»ï¼‰æœ¬åœ°å˜é‡ï¼Œvalï¼š val a:Int = 1 // æŒ‡å®šåˆå§‹å€¼ val b = 2 // ç±»å‹è‡ªæ¨æ–­ä¸º `Int` val c:Int // å½“ä¸æŒ‡å®šåˆå§‹å€¼æ—¶éœ€è¦æŒ‡å®šç±»å‹ c = 3 // å»¶è¿Ÿèµ‹å€¼ å¯å˜å˜é‡ï¼Œ varï¼š var x = 5 // ç±»å‹è‡ªæ¨æ–­ä¸º `Int` x += 1 é¡¶å±‚å˜é‡ val PI = 3....</p></section><footer class=entry-footer>March 24, 2018&nbsp;Â·&nbsp;4 min&nbsp;Â·&nbsp;Lucas</footer><a class=entry-link aria-label="post link to kotlinå¿«é€Ÿå…¥é—¨" href=https://zhenfeng-zhu.github.io/posts/kotlin%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8/></a></article><article class=post-entry><header class=entry-header><h2>RxJava2å¿«é€Ÿå…¥é—¨</h2></header><section class=entry-content><p>RxJava2å¿«é€Ÿå…¥é—¨ å¼•å…¥ä¾èµ– compile 'io.reactivex.rxjava2:rxjava:2.0.1' å†™æ³• ç®€å•ç‰ˆæœ¬ private static void helloSimple() { Consumer&lt;String> consumer = new Consumer&lt;String>() { @Override public void accept(String s) throws Exception { System.out.println("consumer accept is " + s); } }; Observable.just("hello world").subscribe(consumer); } å¤æ‚ç‰ˆæœ¬ private static void helloComplex() { Observer&lt;String> observer = new Observer&lt;String>() { @Override public void onSubscribe(Disposable d) { System.out.println("onSubscribe: " + d); } @Override public void onNext(String s) { System.out.println("onNext: " + s); } @Override public void onError(Throwable e) { System....</p></section><footer class=entry-footer>March 24, 2018&nbsp;Â·&nbsp;2 min&nbsp;Â·&nbsp;Lucas</footer><a class=entry-link aria-label="post link to RxJava2å¿«é€Ÿå…¥é—¨" href=https://zhenfeng-zhu.github.io/posts/rxjava2%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8/></a></article><article class=post-entry><header class=entry-header><h2>é¢†åŸŸå®ä½“ç±»</h2></header><section class=entry-content><p>åœ¨çœ‹é¡¹ç›®ä»£ç çš„æ—¶å€™ï¼Œå‘ç°äº†entityåŒ…å’ŒdtoåŒ…ï¼Œé‡Œé¢éƒ½æ˜¯åªä¿å­˜æ•°æ®çš„ç±»ï¼Œä»”ç»†æŸ¥äº†èµ„æ–™ï¼Œæ‰å‘ç°javaå¯¹äºåªä¿å­˜æ•°æ®çš„ç±»æœ‰å¥½å‡ ä¸ªåˆ†ç±»ã€‚
pojoç±»ï¼šè¿™æ˜¯æ™®é€šçš„javaç±»ï¼Œå…·æœ‰ä¸€éƒ¨åˆ†çš„getå’Œsetæ–¹æ³•ã€‚ dtoç±»ï¼šdata transfer object æ•°æ®ä¼ è¾“å¯¹è±¡ç±»ï¼Œæ³›æŒ‡ç”¨äºå±•ç¤ºå±‚ä¸æœåŠ¡å±‚ä¹‹é—´ä¼ è¾“çš„å¯¹è±¡ã€‚ voç±»ï¼švoæœ‰ä¸¤ç§è¯´æ³•ï¼Œä¸€ç§æ˜¯view objectï¼Œä¸€ç§æ˜¯value objectã€‚ poç±»ï¼špersisent object æŒä¹…å¯¹è±¡ã€‚å’Œpojoç±»ä¸€æ ·ï¼Œä¹Ÿæ˜¯åªæœ‰get setæ–¹æ³•ï¼Œä½†æ˜¯è¿™ç§ç±»ä¸€èˆ¬æ˜¯ç”¨äºæŒä¹…å±‚ã€‚ boç±»ï¼šbusiness objectï¼Œä¸šåŠ¡å¯¹è±¡ï¼Œè¡¨ç¤ºåº”ç”¨ç¨‹åºé¢†åŸŸå†…äº‹ç‰©çš„æ‰€æœ‰å®ä½“ç±»ã€‚ doç±»ï¼šdomain objectï¼Œé¢†åŸŸå¯¹è±¡ï¼Œå°±æ˜¯ä»ç°å®ä¸­æŠ½è±¡å‡ºæ¥çš„æœ‰å½¢æˆ–è€…æ— å½¢çš„ä¸šåŠ¡å®ä½“ã€‚ æ ¹æ®æˆ‘çš„ç»éªŒæ¥çœ‹ï¼Œå¤§éƒ¨åˆ†äººéƒ½æ²¡æœ‰åˆ†é‚£ä¹ˆæ¸…æ¥šï¼Œä¸€èˆ¬æ˜¯æŠŠæ•°æ®ç±»æ”¾åœ¨domainåŒ…ï¼Œæˆ–è€…entityåŒ…é‡Œã€‚å†ç»†åˆ†ä¸€ä¸‹çš„è¯ï¼Œå¯ä»¥æŠŠdtoç±»å•ç‹¬æå–åˆ°ä¸€ä¸ªåŒ…é‡Œã€‚...</p></section><footer class=entry-footer>March 24, 2018&nbsp;Â·&nbsp;1 min&nbsp;Â·&nbsp;Lucas</footer><a class=entry-link aria-label="post link to é¢†åŸŸå®ä½“ç±»" href=https://zhenfeng-zhu.github.io/posts/%E9%A2%86%E5%9F%9F%E5%AE%9E%E4%BD%93%E7%B1%BB/></a></article><footer class=page-footer><nav class=pagination><a class=prev href=https://zhenfeng-zhu.github.io/page/6/>Â« Prev Page</a>
<a class=next href=https://zhenfeng-zhu.github.io/page/8/>Next Page Â»</a></nav></footer></main><footer class=footer><span>&copy; 2021 <a href=https://zhenfeng-zhu.github.io>Go Data</a></span>
<span>&#183;</span>
<span>Powered by <a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a></span>
<span>&#183;</span>
<span>Theme <a href=https://git.io/hugopapermod rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)"><button class=top-link id=top-link type=button accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></button></a>
<script>window.onload=function(){if(localStorage.getItem("menu-scroll-position")){document.getElementById('menu').scrollLeft=localStorage.getItem("menu-scroll-position");}}
document.querySelectorAll('a[href^="#"]').forEach(anchor=>{anchor.addEventListener("click",function(e){e.preventDefault();var id=this.getAttribute("href").substr(1);if(!window.matchMedia('(prefers-reduced-motion: reduce)').matches){document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({behavior:"smooth"});}else{document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();}
if(id==="top"){history.replaceState(null,null," ");}else{history.pushState(null,null,`#${id}`);}});});var mybutton=document.getElementById("top-link");window.onscroll=function(){if(document.body.scrollTop>800||document.documentElement.scrollTop>800){mybutton.style.visibility="visible";mybutton.style.opacity="1";}else{mybutton.style.visibility="hidden";mybutton.style.opacity="0";}};function menu_on_scroll(){localStorage.setItem("menu-scroll-position",document.getElementById('menu').scrollLeft);}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{if(document.body.className.includes("dark")){document.body.classList.remove('dark');localStorage.setItem("pref-theme",'light');}else{document.body.classList.add('dark');localStorage.setItem("pref-theme",'dark');}})</script></body></html>