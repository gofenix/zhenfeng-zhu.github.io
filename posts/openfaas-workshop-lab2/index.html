<!doctype html><html lang=en dir=auto>
<head><meta charset=utf-8>
<meta http-equiv=x-ua-compatible content="IE=edge">
<meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no">
<meta name=robots content="index, follow">
<title>Openfaas Workshop Lab2 | Awesome Fenix</title>
<meta name=keywords content>
<meta name=description content="实验 2 - 测试 在开始实验之前，先创建一个文件夹：
$ mkdir -p lab2 \  && cd lab2 使用 UI 门户 您现在可以测试 OpenFaaS UI：
如果你已经设置了 $OPENFAAS_URL ，请获取 URL，并点开:
echo $OPENFAAS_URL http://127.0.0.1:31112 如果还没有设置 $OPENFAAS_URL ，那么默认的值通常是： http://127.0.0.1:8080.
我们可以部署一些示例函数，然后使用它们进行测试：
$ faas-cli deploy -f https://raw.githubusercontent.com/openfaas/faas/master/stack.yml 您可以在用户界面中试用它们，例如 Markdown 函数，它将 Markdown 代码转换成超文本标记语言。
在 Request 字段中输入如下的内容：
## The **OpenFaaS** _workshop_ 现在点击 Invoke ，然后就可以看到响应出现在屏幕的下半部分。
I.e.
<h2>The <strong>OpenFaaS</strong> <em>workshop</em></h2> 您将会看到如下的字段：
 Status - 函数是否准备好运行。在状态显示就绪之前，您将无法从用户界面调用该函数。 Replicas - 在集群中运行的函数的副本数量。 Image - 发布到 Docker Hub 或 Docker 存储库的 Docker 镜像名称和版本。 Invocation count - 这显示了函数被调用的次数，并且每 5 秒更新一次。  多次点击 Invoke ，就可以看到 Invocation count 在递增。">
<meta name=author content="Fenix">
<link rel=canonical href=https://zhenfeng-zhu.github.io/posts/openfaas-workshop-lab2/>
<link href=/assets/css/stylesheet.min.8d754ccb970fef4a6d8e5b0441e01d76a0d3530c6777067a1b2ca581aa1b4af7.css integrity="sha256-jXVMy5cP70ptjlsEQeAddqDTUwxndwZ6GyylgaobSvc=" rel="preload stylesheet" as=style>
<link rel=icon href=https://zhenfeng-zhu.github.io/favicon.ico>
<link rel=icon type=image/png sizes=16x16 href=https://zhenfeng-zhu.github.io/favicon-16x16.png>
<link rel=icon type=image/png sizes=32x32 href=https://zhenfeng-zhu.github.io/favicon-32x32.png>
<link rel=apple-touch-icon href=https://zhenfeng-zhu.github.io/apple-touch-icon.png>
<link rel=mask-icon href=https://zhenfeng-zhu.github.io/safari-pinned-tab.svg>
<meta name=theme-color content="#2e2e33">
<meta name=msapplication-TileColor content="#2e2e33">
<meta name=generator content="Hugo 0.91.2">
<meta property="og:title" content="Openfaas Workshop Lab2">
<meta property="og:description" content="实验 2 - 测试 在开始实验之前，先创建一个文件夹：
$ mkdir -p lab2 \  && cd lab2 使用 UI 门户 您现在可以测试 OpenFaaS UI：
如果你已经设置了 $OPENFAAS_URL ，请获取 URL，并点开:
echo $OPENFAAS_URL http://127.0.0.1:31112 如果还没有设置 $OPENFAAS_URL ，那么默认的值通常是： http://127.0.0.1:8080.
我们可以部署一些示例函数，然后使用它们进行测试：
$ faas-cli deploy -f https://raw.githubusercontent.com/openfaas/faas/master/stack.yml 您可以在用户界面中试用它们，例如 Markdown 函数，它将 Markdown 代码转换成超文本标记语言。
在 Request 字段中输入如下的内容：
## The **OpenFaaS** _workshop_ 现在点击 Invoke ，然后就可以看到响应出现在屏幕的下半部分。
I.e.
<h2>The <strong>OpenFaaS</strong> <em>workshop</em></h2> 您将会看到如下的字段：
 Status - 函数是否准备好运行。在状态显示就绪之前，您将无法从用户界面调用该函数。 Replicas - 在集群中运行的函数的副本数量。 Image - 发布到 Docker Hub 或 Docker 存储库的 Docker 镜像名称和版本。 Invocation count - 这显示了函数被调用的次数，并且每 5 秒更新一次。  多次点击 Invoke ，就可以看到 Invocation count 在递增。">
<meta property="og:type" content="article">
<meta property="og:url" content="https://zhenfeng-zhu.github.io/posts/openfaas-workshop-lab2/">
<meta property="og:image" content="https://zhenfeng-zhu.github.io/papermod-cover.png">
<meta property="article:published_time" content="2021-03-30T09:57:01+08:00">
<meta property="article:modified_time" content="2021-03-30T09:57:01+08:00">
<meta name=twitter:card content="summary_large_image">
<meta name=twitter:image content="https://zhenfeng-zhu.github.io/papermod-cover.png">
<meta name=twitter:title content="Openfaas Workshop Lab2">
<meta name=twitter:description content="实验 2 - 测试 在开始实验之前，先创建一个文件夹：
$ mkdir -p lab2 \  && cd lab2 使用 UI 门户 您现在可以测试 OpenFaaS UI：
如果你已经设置了 $OPENFAAS_URL ，请获取 URL，并点开:
echo $OPENFAAS_URL http://127.0.0.1:31112 如果还没有设置 $OPENFAAS_URL ，那么默认的值通常是： http://127.0.0.1:8080.
我们可以部署一些示例函数，然后使用它们进行测试：
$ faas-cli deploy -f https://raw.githubusercontent.com/openfaas/faas/master/stack.yml 您可以在用户界面中试用它们，例如 Markdown 函数，它将 Markdown 代码转换成超文本标记语言。
在 Request 字段中输入如下的内容：
## The **OpenFaaS** _workshop_ 现在点击 Invoke ，然后就可以看到响应出现在屏幕的下半部分。
I.e.
<h2>The <strong>OpenFaaS</strong> <em>workshop</em></h2> 您将会看到如下的字段：
 Status - 函数是否准备好运行。在状态显示就绪之前，您将无法从用户界面调用该函数。 Replicas - 在集群中运行的函数的副本数量。 Image - 发布到 Docker Hub 或 Docker 存储库的 Docker 镜像名称和版本。 Invocation count - 这显示了函数被调用的次数，并且每 5 秒更新一次。  多次点击 Invoke ，就可以看到 Invocation count 在递增。">
<script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":2,"name":"Posts","item":"https://zhenfeng-zhu.github.io/posts/"},{"@type":"ListItem","position":3,"name":"Openfaas Workshop Lab2","item":"https://zhenfeng-zhu.github.io/posts/openfaas-workshop-lab2/"}]}</script>
<script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Openfaas Workshop Lab2","name":"Openfaas Workshop Lab2","description":"实验 2 - 测试 在开始实验之前，先创建一个文件夹：\n$ mkdir -p lab2 \\  \u0026amp;amp;\u0026amp;amp; cd lab2 使用 UI 门户 您现在可以测试 OpenFaaS UI：\n如果你已经设置了 $OPENFAAS_URL ，请获取 URL，并点开:\necho $OPENFAAS_URL http://127.0.0.1:31112 如果还没有 …","keywords":[],"articleBody":"实验 2 - 测试 在开始实验之前，先创建一个文件夹：\n$ mkdir -p lab2 \\  \u0026\u0026 cd lab2 使用 UI 门户 您现在可以测试 OpenFaaS UI：\n如果你已经设置了 $OPENFAAS_URL ，请获取 URL，并点开:\necho $OPENFAAS_URL http://127.0.0.1:31112 如果还没有设置 $OPENFAAS_URL ，那么默认的值通常是： http://127.0.0.1:8080.\n我们可以部署一些示例函数，然后使用它们进行测试：\n$ faas-cli deploy -f https://raw.githubusercontent.com/openfaas/faas/master/stack.yml 您可以在用户界面中试用它们，例如 Markdown 函数，它将 Markdown 代码转换成超文本标记语言。\n在 Request 字段中输入如下的内容：\n## The **OpenFaaS** _workshop_ 现在点击 Invoke ，然后就可以看到响应出现在屏幕的下半部分。\nI.e.\nThe OpenFaaS workshop 您将会看到如下的字段：\n Status - 函数是否准备好运行。在状态显示就绪之前，您将无法从用户界面调用该函数。 Replicas - 在集群中运行的函数的副本数量。 Image - 发布到 Docker Hub 或 Docker 存储库的 Docker 镜像名称和版本。 Invocation count - 这显示了函数被调用的次数，并且每 5 秒更新一次。  多次点击 Invoke ，就可以看到 Invocation count 在递增。\n通过函数商店部署 你也可以从 OpenFaaS 商店部署一个函数。这个商店是社区策划的函数集合。\n 点击 Deploy New Function 点击 From Store 点击 Figlet 或者在搜索栏里输入 figlet ，然后点击 Deploy  Figlet 函数将会出现在左侧函数列表中，耐心等几分钟，它需要从 docker hub 下载。 下载完成之后，输入一些文本，然后点击 invoke。\n你会看的一个 ASCII logo：\n_ ___ ___ _ __ / |/ _ \\ / _ (_)/ / | | | | | | | |/ / | | |_| | |_| / /_ |_|\\___/ \\___/_/(_) 学习 CLI 你现在可以测试 CLI，但是首先看下网关的 URL：\n如果 gateway 没有部署在http://127.0.0.1:8080，你需要按如下的几种方法指定一下：\n 设置环境变量OPENFAAS_URL，faas-cli将会在 shell 会话中使用这个。比如：export OPENFAAS_URL=http://openfaas.endpoint.com:8080。这个已经在实验 1中设置好了。 使用-g 或 --gateway指定正确的端点：faas deploy --gateway http://openfaas.endpoint.com:8080。 在 YAML 文件中，在provider:下修改一下gateway:。  列出已经部署的函数 这个会显示有多少函数，多少个副本以及调用次数。\n$ faas-cli list 现在尝试使用 verbose 命令\n$ faas-cli list --verbose 或\n$ faas-cli list -v 现在可以在函数旁边看的 Docker 镜像。\n调用函数 选择faas-cli list中看的的函数，比如 markdown:\n$ faas-cli invoke markdown 然后你会被要求输入一些文本，然后按 Control + D 结束。\n或者也可以使用echo 或 uname -a作为调用的输入。\n$ echo Hi | faas-cli invoke markdown $ uname -a | faas-cli invoke markdown 你甚至可以使用一个 HTML 文件：\n$ git clone https://github.com/openfaas/workshop \\  \u0026\u0026 cd workshop $ cat lab2.md | faas-cli invoke markdown 监控面板 OpenFaas 使用 Prometheus 监控函数的指标。这些指标可以通过Grafana变成一个可视化的仪表盘。\n在 OpenFaaS 的 Kubernetes 命名空间下运行 Grafana：\nkubectl -n openfaas run \\ --image=stefanprodan/faas-grafana:4.6.3 \\ --port=3000 \\ grafana 通过 NodePort 暴露：\nkubectl -n openfaas expose pod grafana \\ --type=NodePort \\ --name=grafana 找到 Grafana 的 node port 地址\n$ GRAFANA_PORT=$(kubectl -n openfaas get svc grafana -o jsonpath=\"{.spec.ports[0].nodePort}\") $ GRAFANA_URL=http://IP_ADDRESS:$GRAFANA_PORT/dashboard/db/openfaas 其中 IP_ADDRESS 就是 Kubernetes 的对应 IP。\n或者你也可以用端口转发命令，这样就可以在http://127.0.0.1:3000Grafana。\n$ kubectl port-forward pod/grafana 3000:3000 -n openfaas 如果使用 Kubernetes 1.17 或更高版本，请使用deploy/grafana ，而不是用 pod/ 。\n创建服务之后，在浏览器中打开 Grafana，然后输入用户名admin 和密码 admin登录，并以 $GRAFANA_URL找到之前已经做好的 OpenFaaS 仪表盘。\nPictured: example of an OpenFaaS dashboard with Grafana\n现在进入 实验 3\n","wordCount":"323","inLanguage":"en","datePublished":"2021-03-30T09:57:01+08:00","dateModified":"2021-03-30T09:57:01+08:00","author":{"@type":"Person","name":"Fenix"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://zhenfeng-zhu.github.io/posts/openfaas-workshop-lab2/"},"publisher":{"@type":"Organization","name":"Awesome Fenix","logo":{"@type":"ImageObject","url":"https://zhenfeng-zhu.github.io/favicon.ico"}}}</script>
</head>
<body id=top>
<script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add('dark'):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove('dark'):window.matchMedia('(prefers-color-scheme: dark)').matches&&document.body.classList.add('dark')</script>
<noscript>
<style type=text/css>#theme-toggle,.top-link{display:none}</style>
</noscript>
<header class=header>
<nav class=nav>
<div class=logo>
<a href=https://zhenfeng-zhu.github.io accesskey=h title="Awesome Fenix (Alt + H)">Awesome Fenix</a>
<span class=logo-switches>
<button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg>
</button>
</span>
</div>
<ul id=menu onscroll=menu_on_scroll()>
<li>
<a href=https://zhenfeng-zhu.github.io/archives/ title=Archives>
<span>Archives</span>
</a>
</li>
<li>
<a href=https://zhenfeng-zhu.github.io/about title=About>
<span>About</span>
</a>
</li>
<li>
<a href=https://zhenfeng-zhu.github.io/search/ title=🔍>
<span>🔍</span>
</a>
</li></ul>
</nav>
</header>
<main class=main>
<article class=post-single>
<header class=post-header>
<div class=breadcrumbs>
<a href=https://zhenfeng-zhu.github.io>Home</a>&nbsp;»&nbsp;<a href=https://zhenfeng-zhu.github.io/posts/>Posts</a>
</div>
<h1 class=post-title>
Openfaas Workshop Lab2
</h1>
<div class=post-meta>
March 30, 2021&nbsp;·&nbsp;2 min&nbsp;·&nbsp;Fenix
</div>
</header>
<div class=toc>
<details>
<summary accesskey=c title="(Alt + C)">
<div class=details>Table of Contents</div>
</summary>
<div class=inner><ul><li>
<a href=#%e5%ae%9e%e9%aa%8c-2---%e6%b5%8b%e8%af%95 aria-label="实验 2 - 测试">实验 2 - 测试</a><ul>
<li>
<a href=#%e4%bd%bf%e7%94%a8-ui-%e9%97%a8%e6%88%b7 aria-label="使用 UI 门户">使用 UI 门户</a></li><li>
<a href=#%e9%80%9a%e8%bf%87%e5%87%bd%e6%95%b0%e5%95%86%e5%ba%97%e9%83%a8%e7%bd%b2 aria-label=通过函数商店部署>通过函数商店部署</a></li><li>
<a href=#%e5%ad%a6%e4%b9%a0-cli aria-label="学习 CLI">学习 CLI</a><ul>
<li>
<a href=#%e5%88%97%e5%87%ba%e5%b7%b2%e7%bb%8f%e9%83%a8%e7%bd%b2%e7%9a%84%e5%87%bd%e6%95%b0 aria-label=列出已经部署的函数>列出已经部署的函数</a></li><li>
<a href=#%e8%b0%83%e7%94%a8%e5%87%bd%e6%95%b0 aria-label=调用函数>调用函数</a></li></ul>
</li><li>
<a href=#%e7%9b%91%e6%8e%a7%e9%9d%a2%e6%9d%bf aria-label=监控面板>监控面板</a></li></ul>
</li></ul>
</div>
</details>
</div>
<div class=post-content>
<h1 id=实验-2---测试>实验 2 - 测试<a hidden class=anchor aria-hidden=true href=#实验-2---测试>#</a></h1>
<p></p>
<p>在开始实验之前，先创建一个文件夹：</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>$ mkdir -p lab2 <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>   <span style=color:#f92672>&amp;&amp;</span> cd lab2
</code></pre></div><h2 id=使用-ui-门户>使用 UI 门户<a hidden class=anchor aria-hidden=true href=#使用-ui-门户>#</a></h2>
<p>您现在可以测试 OpenFaaS UI：</p>
<p>如果你已经设置了 <code>$OPENFAAS_URL</code> ，请获取 URL，并点开:</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>echo $OPENFAAS_URL
http://127.0.0.1:31112
</code></pre></div><p>如果还没有设置 <code>$OPENFAAS_URL</code> ，那么默认的值通常是： <a href=http://127.0.0.1:8080>http://127.0.0.1:8080</a>.</p>
<p>我们可以部署一些示例函数，然后使用它们进行测试：</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>$ faas-cli deploy -f https://raw.githubusercontent.com/openfaas/faas/master/stack.yml
</code></pre></div><p><img src=./screenshot/markdown_portal.png alt></p>
<p>您可以在用户界面中试用它们，例如 Markdown 函数，它将 Markdown 代码转换成超文本标记语言。</p>
<p>在 <em>Request</em> 字段中输入如下的内容：</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=color:#75715e>## The **OpenFaaS** _workshop_</span>
</code></pre></div><p>现在点击 <em>Invoke</em> ，然后就可以看到响应出现在屏幕的下半部分。</p>
<p>I.e.</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>&lt;h2&gt;The &lt;strong&gt;OpenFaaS&lt;/strong&gt; &lt;em&gt;workshop&lt;/em&gt;&lt;/h2&gt;
</code></pre></div><p>您将会看到如下的字段：</p>
<ul>
<li>Status - 函数是否准备好运行。在状态显示就绪之前，您将无法从用户界面调用该函数。</li>
<li>Replicas - 在集群中运行的函数的副本数量。</li>
<li>Image - 发布到 Docker Hub 或 Docker 存储库的 Docker 镜像名称和版本。</li>
<li>Invocation count - 这显示了函数被调用的次数，并且每 5 秒更新一次。</li>
</ul>
<p>多次点击 <em>Invoke</em> ，就可以看到 <em>Invocation count</em> 在递增。</p>
<h2 id=通过函数商店部署>通过函数商店部署<a hidden class=anchor aria-hidden=true href=#通过函数商店部署>#</a></h2>
<p>你也可以从 OpenFaaS 商店部署一个函数。这个商店是社区策划的函数集合。</p>
<ul>
<li>点击 <em>Deploy New Function</em></li>
<li>点击 <em>From Store</em></li>
<li>点击 <em>Figlet</em> 或者在搜索栏里输入 <em>figlet</em> ，然后点击 <em>Deploy</em></li>
</ul>
<p>Figlet 函数将会出现在左侧函数列表中，耐心等几分钟，它需要从 docker hub 下载。 下载完成之后，输入一些文本，然后点击 invoke。</p>
<p>你会看的一个 ASCII logo：</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh> _  ___   ___ _  __
/ |/ _ <span style=color:#ae81ff>\ </span>/ _ <span style=color:#f92672>(</span>_<span style=color:#f92672>)</span>/ /
| | | | | | | |/ /
| | |_| | |_| / /_
|_|<span style=color:#ae81ff>\_</span>__/ <span style=color:#ae81ff>\_</span>__/_/<span style=color:#f92672>(</span>_<span style=color:#f92672>)</span>
</code></pre></div><h2 id=学习-cli>学习 CLI<a hidden class=anchor aria-hidden=true href=#学习-cli>#</a></h2>
<p>你现在可以测试 CLI，但是首先看下网关的 URL：</p>
<p>如果 gateway 没有部署在http://127.0.0.1:8080，你需要按如下的几种方法指定一下：</p>
<ol>
<li>设置环境变量<code>OPENFAAS_URL</code>，<code>faas-cli</code>将会在 shell 会话中使用这个。比如：<code>export OPENFAAS_URL=http://openfaas.endpoint.com:8080</code>。这个已经在<a href=./lab1.md>实验 1</a>中设置好了。</li>
<li>使用<code>-g</code> 或 <code>--gateway</code>指定正确的端点：<code>faas deploy --gateway http://openfaas.endpoint.com:8080</code>。</li>
<li>在 YAML 文件中，在<code>provider:</code>下修改一下<code>gateway:</code>。</li>
</ol>
<h3 id=列出已经部署的函数>列出已经部署的函数<a hidden class=anchor aria-hidden=true href=#列出已经部署的函数>#</a></h3>
<p>这个会显示有多少函数，多少个副本以及调用次数。</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>$ faas-cli list
</code></pre></div><p>现在尝试使用 verbose 命令</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>$ faas-cli list --verbose
</code></pre></div><p>或</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>$ faas-cli list -v
</code></pre></div><p>现在可以在函数旁边看的 Docker 镜像。</p>
<h3 id=调用函数>调用函数<a hidden class=anchor aria-hidden=true href=#调用函数>#</a></h3>
<p>选择<code>faas-cli list</code>中看的的函数，比如 <code>markdown</code>:</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>$ faas-cli invoke markdown
</code></pre></div><p>然后你会被要求输入一些文本，然后按 Control + D 结束。</p>
<p>或者也可以使用<code>echo</code> 或 <code>uname -a</code>作为调用的输入。</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>$ echo Hi | faas-cli invoke markdown

$ uname -a | faas-cli invoke markdown
</code></pre></div><p>你甚至可以使用一个 HTML 文件：</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>$ git clone https://github.com/openfaas/workshop <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>   <span style=color:#f92672>&amp;&amp;</span> cd workshop

$ cat lab2.md | faas-cli invoke markdown
</code></pre></div><h2 id=监控面板>监控面板<a hidden class=anchor aria-hidden=true href=#监控面板>#</a></h2>
<p>OpenFaas 使用 Prometheus 监控函数的指标。这些指标可以通过<a href=https://grafana.com>Grafana</a>变成一个可视化的仪表盘。</p>
<p>在 OpenFaaS 的 Kubernetes 命名空间下运行 Grafana：</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>kubectl -n openfaas run <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>--image<span style=color:#f92672>=</span>stefanprodan/faas-grafana:4.6.3 <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>--port<span style=color:#f92672>=</span><span style=color:#ae81ff>3000</span> <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>grafana
</code></pre></div><p>通过 NodePort 暴露：</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>kubectl -n openfaas expose pod grafana <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>--type<span style=color:#f92672>=</span>NodePort <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>--name<span style=color:#f92672>=</span>grafana
</code></pre></div><p>找到 Grafana 的 node port 地址</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>$ GRAFANA_PORT<span style=color:#f92672>=</span><span style=color:#66d9ef>$(</span>kubectl -n openfaas get svc grafana -o jsonpath<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{.spec.ports[0].nodePort}&#34;</span><span style=color:#66d9ef>)</span>
$ GRAFANA_URL<span style=color:#f92672>=</span>http://IP_ADDRESS:$GRAFANA_PORT/dashboard/db/openfaas
</code></pre></div><p>其中 <code>IP_ADDRESS</code> 就是 Kubernetes 的对应 IP。</p>
<p>或者你也可以用端口转发命令，这样就可以在<code>http://127.0.0.1:3000</code>Grafana。</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>$ kubectl port-forward pod/grafana 3000:3000 -n openfaas
</code></pre></div><p>如果使用 Kubernetes 1.17 或更高版本，请使用<code>deploy/grafana</code> ，而不是用 <code>pod/</code> 。</p>
<p>创建服务之后，在浏览器中打开 Grafana，然后输入用户名<code>admin</code> 和密码 <code>admin</code>登录，并以 <code>$GRAFANA_URL</code>找到之前已经做好的 OpenFaaS 仪表盘。</p>
<p></p>
<p><em>Pictured: example of an OpenFaaS dashboard with Grafana</em></p>
<p>现在进入 <a href=./lab3.md>实验 3</a></p>
</div>
<footer class=post-footer>
<nav class=paginav>
<a class=prev href=https://zhenfeng-zhu.github.io/posts/how-to-write-a-static-site-generator/>
<span class=title>« Prev Page</span>
<br>
<span>如何从零开始写一个静态网站生成器</span>
</a>
<a class=next href=https://zhenfeng-zhu.github.io/posts/openfaas-workshop-lab1b/>
<span class=title>Next Page »</span>
<br>
<span>Openfaas Workshop Lab1b</span>
</a>
</nav>
<div class=share-buttons>
<a target=_blank rel="noopener noreferrer" aria-label="share Openfaas Workshop Lab2 on twitter" href="https://twitter.com/intent/tweet/?text=Openfaas%20Workshop%20Lab2&url=https%3a%2f%2fzhenfeng-zhu.github.io%2fposts%2fopenfaas-workshop-lab2%2f&hashtags="><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM195.519 424.544c135.939.0 210.268-112.643 210.268-210.268.0-3.218.0-6.437-.153-9.502 14.406-10.421 26.973-23.448 36.935-38.314-13.18 5.824-27.433 9.809-42.452 11.648 15.326-9.196 26.973-23.602 32.49-40.92-14.252 8.429-30.038 14.56-46.896 17.931-13.487-14.406-32.644-23.295-53.946-23.295-40.767.0-73.87 33.104-73.87 73.87.0 5.824.613 11.494 1.992 16.858-61.456-3.065-115.862-32.49-152.337-77.241-6.284 10.881-9.962 23.601-9.962 37.088.0 25.594 13.027 48.276 32.95 61.456-12.107-.307-23.448-3.678-33.41-9.196v.92c0 35.862 25.441 65.594 59.311 72.49-6.13 1.686-12.72 2.606-19.464 2.606-4.751.0-9.348-.46-13.946-1.38 9.349 29.426 36.628 50.728 68.965 51.341-25.287 19.771-57.164 31.571-91.8 31.571-5.977.0-11.801-.306-17.625-1.073 32.337 21.15 71.264 33.41 112.95 33.41z"/></svg>
</a>
<a target=_blank rel="noopener noreferrer" aria-label="share Openfaas Workshop Lab2 on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3a%2f%2fzhenfeng-zhu.github.io%2fposts%2fopenfaas-workshop-lab2%2f&title=Openfaas%20Workshop%20Lab2&summary=Openfaas%20Workshop%20Lab2&source=https%3a%2f%2fzhenfeng-zhu.github.io%2fposts%2fopenfaas-workshop-lab2%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg>
</a>
<a target=_blank rel="noopener noreferrer" aria-label="share Openfaas Workshop Lab2 on reddit" href="https://reddit.com/submit?url=https%3a%2f%2fzhenfeng-zhu.github.io%2fposts%2fopenfaas-workshop-lab2%2f&title=Openfaas%20Workshop%20Lab2"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg>
</a>
<a target=_blank rel="noopener noreferrer" aria-label="share Openfaas Workshop Lab2 on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fzhenfeng-zhu.github.io%2fposts%2fopenfaas-workshop-lab2%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg>
</a>
<a target=_blank rel="noopener noreferrer" aria-label="share Openfaas Workshop Lab2 on whatsapp" href="https://api.whatsapp.com/send?text=Openfaas%20Workshop%20Lab2%20-%20https%3a%2f%2fzhenfeng-zhu.github.io%2fposts%2fopenfaas-workshop-lab2%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg>
</a>
<a target=_blank rel="noopener noreferrer" aria-label="share Openfaas Workshop Lab2 on telegram" href="https://telegram.me/share/url?text=Openfaas%20Workshop%20Lab2&url=https%3a%2f%2fzhenfeng-zhu.github.io%2fposts%2fopenfaas-workshop-lab2%2f"><svg viewBox="2 2 28 28"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg>
</a>
</div>
</footer><script src=https://utteranc.es/client.js repo=zhenfeng-zhu/zhenfeng-zhu.github.io issue-term=pathname label=Comment theme=github-light crossorigin=anonymous async></script>
</article>
</main><footer class=footer>
<span>&copy; 2022 <a href=https://zhenfeng-zhu.github.io>Awesome Fenix</a></span>
<span>&#183;</span>
<span>Powered by <a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a></span>
<span>&#183;</span>
<span>Theme <a href=https://git.io/hugopapermod rel=noopener target=_blank>PaperMod</a></span>
</footer>
<a href=#top aria-label="go to top" title="Go to Top (Alt + G)">
<button class=top-link id=top-link type=button accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</button>
</a>
<script defer src=/assets/js/highlight.min.7680afc38aa6b15ddf158a4f3780b7b1f7dde7e91d26f073e6229bb7a0793c92.js integrity="sha256-doCvw4qmsV3fFYpPN4C3sffd5+kdJvBz5iKbt6B5PJI=" onload=hljs.initHighlightingOnLoad()></script>
<script>window.onload=function(){localStorage.getItem("menu-scroll-position")&&(document.getElementById('menu').scrollLeft=localStorage.getItem("menu-scroll-position"))},document.querySelectorAll('a[href^="#"]').forEach(a=>{a.addEventListener("click",function(b){b.preventDefault();var a=this.getAttribute("href").substr(1);window.matchMedia('(prefers-reduced-motion: reduce)').matches?document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView({behavior:"smooth"}),a==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${a}`)})});var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")};function menu_on_scroll(){localStorage.setItem("menu-scroll-position",document.getElementById('menu').scrollLeft)}</script>
<script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove('dark'),localStorage.setItem("pref-theme",'light')):(document.body.classList.add('dark'),localStorage.setItem("pref-theme",'dark'))})</script>
</body>
</html>