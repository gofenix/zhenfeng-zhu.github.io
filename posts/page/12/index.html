<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Posts | Go Data</title><meta name=keywords content><meta name=description content="Theme PaperMod - https://github.com/adityatelange/hugo-PaperMod"><meta name=author content="Lucas"><link rel=canonical href=https://zhenfeng-zhu.github.io/gh/posts/><link href=/gh/assets/css/stylesheet.min.3839cf02b87f30309470412461116907caabd1b3ec3f5d015df618da2d034992.css integrity="sha256-ODnPArh/MDCUcEEkYRFpB8qr0bPsP10BXfYY2i0DSZI=" rel="preload stylesheet" as=style><link rel=icon href=https://zhenfeng-zhu.github.io/gh/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://zhenfeng-zhu.github.io/gh/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://zhenfeng-zhu.github.io/gh/favicon-32x32.png><link rel=apple-touch-icon href=https://zhenfeng-zhu.github.io/gh/apple-touch-icon.png><link rel=mask-icon href=https://zhenfeng-zhu.github.io/gh/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><meta name=generator content="Hugo 0.80.0"><link rel=alternate type=application/rss+xml href=https://zhenfeng-zhu.github.io/gh/posts/index.xml><meta property="og:title" content="Posts"><meta property="og:description" content="Theme PaperMod - https://github.com/adityatelange/hugo-PaperMod"><meta property="og:type" content="website"><meta property="og:url" content="https://zhenfeng-zhu.github.io/gh/posts/"><meta property="og:image" content="https://zhenfeng-zhu.github.io/gh/papermod-cover.png"><meta property="og:updated_time" content="2020-11-20T16:01:49+08:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://zhenfeng-zhu.github.io/gh/papermod-cover.png"><meta name=twitter:title content="Posts"><meta name=twitter:description content="Theme PaperMod - https://github.com/adityatelange/hugo-PaperMod"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":2,"name":"Posts","item":"https://zhenfeng-zhu.github.io/gh/posts/"}]}</script></head><body class=list id=top><script>if(localStorage.getItem("pref-theme")==="dark"){document.body.classList.add('dark');}else if(localStorage.getItem("pref-theme")==="light"){document.body.classList.remove('dark')}else if(window.matchMedia('(prefers-color-scheme: dark)').matches){document.body.classList.add('dark');}</script><noscript><style type=text/css>#theme-toggle,.top-link{display:none}</style></noscript><header class=header><nav class=nav><div class=logo><a href=https://zhenfeng-zhu.github.io/gh accesskey=h title="Go Data (Alt + H)">Go Data</a>
<span class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></span></div><ul id=menu onscroll=menu_on_scroll()><li><a href=https://zhenfeng-zhu.github.io/gh/about title=About><span>About</span></a></li><li><a href=https://zhenfeng-zhu.github.io/gh/search/ title=ğŸ”><span>ğŸ”</span></a></li></ul></nav></header><main class=main><header class=page-header><div class=breadcrumbs><a href=https://zhenfeng-zhu.github.io/gh>Home</a></div><h1>Posts</h1></header><article class=post-entry><header class=entry-header><h2>ä¸€è‡´æ€§å“ˆå¸Œç®—æ³•</h2></header><section class=entry-content><p>å½“æˆ‘ä»¬åœ¨åšæ•°æ®åº“åˆ†åº“åˆ†è¡¨æˆ–è€…åšåˆ†å¸ƒå¼ç¼“å­˜çš„æ—¶å€™ï¼Œä¸å¯é¿å…çš„éƒ½ä¼šé‡åˆ°ä¸€ä¸ªé—®é¢˜ï¼š
å¦‚ä½•å°†æ•°æ®å‡åŒ€çš„åˆ†æ•£åˆ°å„ä¸ªèŠ‚ç‚¹ä¸­ï¼Œå¹¶ä¸”å°½é‡çš„åœ¨åŠ å‡èŠ‚ç‚¹çš„æ—¶èƒ½ä½¿å—å½±å“çš„æ•°æ®æœ€å°‘ã€‚
1 hashå–æ¨¡ éšæœºæ”¾ç½®å°±ä¸å¤šè¯´äº†ã€‚é€šå¸¸æœ€å®¹æ˜“æƒ³åˆ°çš„æ–¹æ¡ˆæ˜¯å“ˆå¸Œå–æ¨¡äº†ã€‚
å¯ä»¥å°†ä¼ å…¥çš„keyæŒ‰ç…§ $$ index=hash(key) % N $$ è¿™æ ·æ¥è®¡ç®—å‡ºéœ€è¦å­˜æ”¾çš„èŠ‚ç‚¹ã€‚
è¿™æ ·å¯ä»¥æ»¡è¶³æ•°æ®çš„å‡åŒ€åˆ†é…ï¼Œä½†æ˜¯è¿™ä¸ªç®—æ³•çš„å®¹é”™æ€§å’Œæ‰©å±•æ€§æ¯”è¾ƒå·®ã€‚æ¯”å¦‚å¢åŠ æˆ–è€…åˆ é™¤ä¸€ä¸ªèŠ‚ç‚¹çš„æ—¶å€™ï¼Œæ‰€æœ‰çš„keyéƒ½è¦é‡æ–°è®¡ç®—ï¼Œæ˜¾ç„¶è¿™æ ·çš„æˆæœ¬æ¯”è¾ƒé«˜ï¼Œä¸ºæ­¤éœ€è¦ä¸€ä¸ªç®—æ³•æ¥æ»¡è¶³å‡åŒ€çš„åŒæ—¶ä¹Ÿè¦æœ‰è‰¯å¥½çš„å®¹é”™æ€§å’Œæ‰©å±•æ€§ã€‚
2 ä¸€è‡´æ€§hashç®—æ³• ä¸€è‡´æ€§hashç®—æ³•æ˜¯å°†æ‰€æœ‰çš„å“ˆå¸Œå€¼æ„æˆäº†ä¸€ä¸ªç¯ï¼Œå…¶èŒƒå›´æ˜¯0~2^32-1ã€‚å¦‚å›¾ï¼š
ä¹‹åå°†å„ä¸ªæœåŠ¡å™¨èŠ‚ç‚¹æ•£åˆ—åˆ°è¿™ä¸ªç¯ä¸Šï¼Œå¯ä»¥ç”¨èŠ‚ç‚¹çš„IPï¼Œhostnameè¿™æ ·å”¯ä¸€æ€§çš„å­—æ®µä½œä¸ºkeyè¿›è¡Œhashã€‚æ•£åˆ—ä¹‹åå¦‚ä¸‹ï¼š
ä¹‹åéœ€è¦å°†æ•°æ®å®šä½åˆ°å¯¹åº”çš„èŠ‚ç‚¹ä¸Šï¼Œä½¿ç”¨åŒæ ·çš„hashå‡½æ•°å°†keyä¹Ÿæ˜ å°„åˆ°è¿™ä¸ªç¯ä¸Šã€‚
è¿™æ ·å°±æŒ‰ç…§é¡ºæ—¶é’ˆæ–¹å‘å°±å¯ä»¥å°†k1å®šä½åˆ°N1èŠ‚ç‚¹ï¼Œk2å®šä½åˆ°N3èŠ‚ç‚¹ï¼Œk3å®šä½åˆ°N2èŠ‚ç‚¹ã€‚
2.1 å®¹é”™æ€§ å‡è®¾N1å®•æœºäº†ï¼š
ä¾ç„¶æ ¹æ®é¡ºæ—¶é’ˆæ–¹å‘ï¼Œk2å’Œk3ä¿æŒä¸å˜ï¼Œåªæœ‰k1è¢«é‡æ–°æ˜ å°„åˆ°äº†N3ã€‚è¿™æ ·å°±å¾ˆå¥½çš„ä¿è¯äº†å®¹é”™æ€§ï¼Œå½“ä¸€ä¸ªèŠ‚ç‚¹å®•æœºæ—¶åªä¼šå½±å“åˆ°å°‘éƒ¨åˆ†æ•°æ®ã€‚
2.2 æ‰©å±•æ€§ å½“æ–°å¢ä¸€ä¸ªèŠ‚ç‚¹æ—¶ï¼š
åœ¨N2å’ŒN3ä¹‹é—´æ–°å¢äº†ä¸€ä¸ªèŠ‚ç‚¹N4ï¼Œè¿™æ—¶å—å½±å“çš„æ•°æ®åªæœ‰k3ï¼Œå…¶ä½™çš„æ•°æ®ä¹Ÿæ˜¯ä¿æŒä¸å˜ã€‚
2.3 è™šæ‹ŸèŠ‚ç‚¹ åˆ°ç›®å‰ä¸ºæ­¢ï¼Œè¯¥ç®—æ³•ä¹Ÿæœ‰ä¸€äº›é—®é¢˜ï¼š
å½“èŠ‚ç‚¹è¾ƒå°‘çš„æ—¶å€™å¯èƒ½å‡ºç°æ•°æ®ä¸å‡åŒ€çš„æƒ…å†µï¼š
è¿™æ ·ä¼šå¯¼è‡´å¤§éƒ¨åˆ†æ•°æ®éƒ½åœ¨N1èŠ‚ç‚¹ï¼Œåªæœ‰å°‘é‡çš„æ•°æ®åœ¨N2èŠ‚ç‚¹ã€‚
ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œä¸€è‡´æ€§å“ˆå¸Œç®—æ³•å¼•å…¥äº†è™šæ‹ŸèŠ‚ç‚¹ã€‚
å°†æ¯ä¸€ä¸ªèŠ‚ç‚¹è¿›è¡Œå¤šæ¬¡å“ˆå¸Œï¼Œç”Ÿæˆçš„èŠ‚ç‚¹æ”¾ç½®åœ¨ç¯ä¸Šæˆä¸ºè™šæ‹ŸèŠ‚ç‚¹ã€‚
è®¡ç®—æ—¶å¯ä»¥åœ¨ IP ååŠ ä¸Šç¼–å·æ¥ç”Ÿæˆå“ˆå¸Œå€¼ã€‚
è¿™æ ·åªéœ€è¦åœ¨åŸæœ‰çš„åŸºç¡€ä¸Šå¤šä¸€æ­¥ç”±è™šæ‹ŸèŠ‚ç‚¹æ˜ å°„åˆ°å®é™…èŠ‚ç‚¹çš„æ­¥éª¤å³å¯è®©å°‘é‡èŠ‚ç‚¹ä¹Ÿèƒ½æ»¡è¶³å‡åŒ€æ€§ã€‚
3 å‚è€ƒ https://crossoverjie.top/2018/01/08/Consistent-Hash/#more...</p></section><footer class=entry-footer>March 24, 2018&nbsp;Â·&nbsp;1 min&nbsp;Â·&nbsp;Lucas</footer><a class=entry-link aria-label="post link to ä¸€è‡´æ€§å“ˆå¸Œç®—æ³•" href=https://zhenfeng-zhu.github.io/gh/posts/%E4%B8%80%E8%87%B4%E6%80%A7%E5%93%88%E5%B8%8C%E7%AE%97%E6%B3%95/></a></article><article class=post-entry><header class=entry-header><h2>Spring Bootå¯åŠ¨åŸç†åˆ†æ</h2></header><section class=entry-content><p>Spring Bootå¯åŠ¨åŸç†åˆ†æ æˆ‘ä»¬åœ¨å¼€å‘spring bootåº”ç”¨çš„æ—¶å€™ï¼Œä¸€èˆ¬ä¼šé‡åˆ°å¦‚ä¸‹çš„å¯åŠ¨ç±»ï¼š
@SpringBootApplication public class DemoApplication { public static void main(String[] args) { SpringApplication.run(DemoApplication.class, args); } } ä»è¿™æ®µä»£ç å¯ä»¥çœ‹å‡ºï¼Œæ³¨è§£@SpringBootApplicationå’ŒSpringApplication.run()æ˜¯æ¯”è¾ƒé‡è¦çš„ä¸¤ä¸ªä¸œè¥¿ã€‚
1 @SpringApplicationæ³¨è§£ @Target(ElementType.TYPE) @Retention(RetentionPolicy.RUNTIME) @Documented @Inherited @SpringBootConfiguration @EnableAutoConfiguration @ComponentScan(excludeFilters = { @Filter(type = FilterType.CUSTOM, classes = TypeExcludeFilter.class), @Filter(type = FilterType.CUSTOM, classes = AutoConfigurationExcludeFilter.class) }) public @interface SpringBootApplication { ... } åœ¨è¿™æ®µä»£ç é‡Œï¼Œæ¯”è¾ƒé‡è¦çš„åªæœ‰ä¸‰ä¸ªæ³¨è§£ï¼š
@Configurationï¼ˆ@SpringBootConfigurationç‚¹å¼€æŸ¥çœ‹å‘ç°é‡Œé¢è¿˜æ˜¯åº”ç”¨äº†@Configurationï¼‰ @EnableAutoConfiguration @ComponentScan å…¶å®ï¼Œæˆ‘ä»¬ä½¿ç”¨è¿™ä¸‰ä¸ªæ³¨è§£æ¥ä¿®é¥°springbootçš„å¯åŠ¨ç±»ä¹Ÿå¯ä»¥æ­£å¸¸è¿è¡Œ,å¦‚ä¸‹æ‰€ç¤ºï¼š
@ComponentScan @EnableAutoConfiguration @Configuration public class DemoApplication { public static void main(String[] args) { SpringApplication....</p></section><footer class=entry-footer>March 24, 2018&nbsp;Â·&nbsp;2 min&nbsp;Â·&nbsp;Lucas</footer><a class=entry-link aria-label="post link to Spring Bootå¯åŠ¨åŸç†åˆ†æ" href=https://zhenfeng-zhu.github.io/gh/posts/spring-boot%E5%90%AF%E5%8A%A8%E5%8E%9F%E7%90%86%E5%88%86%E6%9E%90/></a></article><article class=post-entry><header class=entry-header><h2>Spring Data Jpaå®æˆ˜</h2></header><section class=entry-content><p>ä¸ºäº†è§£å†³æŠ½è±¡å„ä¸ªJavaå®ä½“åŸºæœ¬çš„â€œå¢åˆ æ”¹æŸ¥â€æ“ä½œï¼Œæˆ‘ä»¬é€šå¸¸ä¼šä»¥æ³›å‹çš„æ–¹å¼å°è£…ä¸€ä¸ªæ¨¡æ¿Daoæ¥è¿›è¡ŒæŠ½è±¡ç®€åŒ–ï¼Œä½†æ˜¯è¿™æ ·ä¾ç„¶ä¸æ˜¯å¾ˆæ–¹ä¾¿ï¼Œæˆ‘ä»¬éœ€è¦é’ˆå¯¹æ¯ä¸ªå®ä½“ç¼–å†™ä¸€ä¸ªç»§æ‰¿è‡ªæ³›å‹æ¨¡æ¿Daoçš„æ¥å£ï¼Œå†ç¼–å†™è¯¥æ¥å£çš„å®ç°ã€‚è™½ç„¶ä¸€äº›åŸºç¡€çš„æ•°æ®è®¿é—®å·²ç»å¯ä»¥å¾—åˆ°å¾ˆå¥½çš„å¤ç”¨ï¼Œä½†æ˜¯åœ¨ä»£ç ç»“æ„ä¸Šé’ˆå¯¹æ¯ä¸ªå®ä½“éƒ½ä¼šæœ‰ä¸€å †Daoçš„æ¥å£å’Œå®ç°ã€‚
ç”±äºæ¨¡æ¿Daoçš„å®ç°ï¼Œä½¿å¾—è¿™äº›å…·ä½“å®ä½“çš„Daoå±‚å·²ç»å˜çš„éå¸¸â€œè–„â€ï¼Œæœ‰ä¸€äº›å…·ä½“å®ä½“çš„Daoå®ç°å¯èƒ½å®Œå…¨å°±æ˜¯å¯¹æ¨¡æ¿Daoçš„ç®€å•ä»£ç†ï¼Œå¹¶ä¸”å¾€å¾€è¿™æ ·çš„å®ç°ç±»å¯èƒ½ä¼šå‡ºç°åœ¨å¾ˆå¤šå®ä½“ä¸Šã€‚Spring-data-jpaçš„å‡ºç°æ­£å¯ä»¥è®©è¿™æ ·ä¸€ä¸ªå·²ç»å¾ˆâ€œè–„â€çš„æ•°æ®è®¿é—®å±‚å˜æˆåªæ˜¯ä¸€å±‚æ¥å£çš„ç¼–å†™æ–¹å¼ã€‚
1 å·¥ç¨‹é…ç½® 1.1 pom &lt;?xml version="1.0" encoding="UTF-8"?> &lt;project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd"> &lt;modelVersion>4.0.0&lt;/modelVersion> &lt;groupId>com.example&lt;/groupId> &lt;artifactId>jpa-demo&lt;/artifactId> &lt;version>0.0.1-SNAPSHOT&lt;/version> &lt;packaging>jar&lt;/packaging> &lt;name>jpa-demo&lt;/name> &lt;description>Demo project for Spring Boot&lt;/description> &lt;parent> &lt;groupId>org.springframework.boot&lt;/groupId> &lt;artifactId>spring-boot-starter-parent&lt;/artifactId> &lt;version>1.5.9.RELEASE&lt;/version> &lt;relativePath/> &lt;!-- lookup parent from repository --> &lt;/parent> &lt;properties> &lt;project.build.sourceEncoding>UTF-8&lt;/project.build.sourceEncoding> &lt;project.reporting.outputEncoding>UTF-8&lt;/project.reporting.outputEncoding> &lt;java.version>1.8&lt;/java.version> &lt;/properties> &lt;dependencies> &lt;dependency> &lt;groupId>org.springframework.boot&lt;/groupId> &lt;artifactId>spring-boot-starter-data-jpa&lt;/artifactId> &lt;/dependency> &lt;dependency> &lt;groupId>org.springframework.boot&lt;/groupId> &lt;artifactId>spring-boot-starter-web&lt;/artifactId> &lt;/dependency> &lt;dependency> &lt;groupId>mysql&lt;/groupId> &lt;artifactId>mysql-connector-java&lt;/artifactId> &lt;scope>runtime&lt;/scope> &lt;/dependency> &lt;dependency> &lt;groupId>org.projectlombok&lt;/groupId> &lt;artifactId>lombok&lt;/artifactId> &lt;optional>true&lt;/optional> &lt;/dependency> &lt;dependency> &lt;groupId>org.springframework.boot&lt;/groupId> &lt;artifactId>spring-boot-starter-test&lt;/artifactId> &lt;scope>test&lt;/scope> &lt;/dependency> &lt;/dependencies> &lt;build> &lt;plugins> &lt;plugin> &lt;groupId>org....</p></section><footer class=entry-footer>March 24, 2018&nbsp;Â·&nbsp;2 min&nbsp;Â·&nbsp;Lucas</footer><a class=entry-link aria-label="post link to Spring Data Jpaå®æˆ˜" href=https://zhenfeng-zhu.github.io/gh/posts/spring-data-jpa%E5%AE%9E%E6%88%98/></a></article><article class=post-entry><header class=entry-header><h2>spring bootå¤šæ•°æ®æºé…ç½®</h2></header><section class=entry-content><p>spring bootå¤šæ•°æ®æºé…ç½® åœ¨å•æ•°æ®æºçš„æƒ…å†µä¸‹ï¼ŒSpring Bootçš„é…ç½®éå¸¸ç®€å•ï¼Œåªéœ€è¦åœ¨application.propertiesæ–‡ä»¶ä¸­é…ç½®è¿æ¥å‚æ•°å³å¯ã€‚ä½†æ˜¯å¾€å¾€éšç€ä¸šåŠ¡é‡å‘å±•ï¼Œæˆ‘ä»¬é€šå¸¸ä¼šè¿›è¡Œæ•°æ®åº“æ‹†åˆ†æˆ–æ˜¯å¼•å…¥å…¶ä»–æ•°æ®åº“ï¼Œä»è€Œæˆ‘ä»¬éœ€è¦é…ç½®å¤šä¸ªæ•°æ®æºã€‚
1 å‡†å¤‡ 1.1 ç¦æ­¢DataSourceAutoConfiguration é¦–å…ˆè¦å°†spring bootè‡ªå¸¦çš„DataSourceAutoConfigurationç¦æ‰ï¼Œå› ä¸ºå®ƒä¼šè¯»å–application.propertiesæ–‡ä»¶çš„spring.datasource.*å±æ€§å¹¶è‡ªåŠ¨é…ç½®å•æ•°æ®æºã€‚åœ¨@SpringBootApplicationæ³¨è§£ä¸­æ·»åŠ excludeå±æ€§å³å¯ï¼š
@SpringBootApplication(exclude = {DataSourceAutoConfiguration.class}) public class DemoApplication { public static void main(String[] args) { SpringApplication.run(JpaDemoApplication.class, args); } } 1.2 é…ç½®æ•°æ®åº“è¿æ¥ ç„¶ååœ¨application.propertiesä¸­é…ç½®å¤šæ•°æ®æºè¿æ¥ä¿¡æ¯ï¼š
spring.datasource.primary.url=jdbc:mysql://localhost:3306/test spring.datasource.primary.username=root spring.datasource.primary.password=root spring.datasource.primary.driver-class-name=com.mysql.jdbc.Driver spring.datasource.secondary.url=jdbc:mysql://localhost:3306/test1 spring.datasource.secondary.username=root spring.datasource.secondary.password=root spring.datasource.secondary.driver-class-name=com.mysql.jdbc.Driver 1.3 æ‰‹æ®µåˆ›å»ºæ•°æ®æº ç”±äºæˆ‘ä»¬ç¦æ‰äº†è‡ªåŠ¨æ•°æ®æºé…ç½®ï¼Œå› äº›ä¸‹ä¸€æ­¥å°±éœ€è¦æ‰‹åŠ¨å°†è¿™äº›æ•°æ®æºåˆ›å»ºå‡ºæ¥ï¼š
@Configuration public class DataSourceConfig { @Bean(name = "primaryDataSource") // @Qualifier(value = "primaryDataSource") @ConfigurationProperties(prefix = "spring.datasource.primary") public DataSource primaryDataSource(){ return DataSourceBuilder.create().build(); } @Bean(name = "secondaryDataSource") // @Qualifier(value = "secondaryDataSource") @ConfigurationProperties(prefix = "spring....</p></section><footer class=entry-footer>March 24, 2018&nbsp;Â·&nbsp;3 min&nbsp;Â·&nbsp;Lucas</footer><a class=entry-link aria-label="post link to spring bootå¤šæ•°æ®æºé…ç½®" href=https://zhenfeng-zhu.github.io/gh/posts/spring-boot%E5%A4%9A%E6%95%B0%E6%8D%AE%E6%BA%90%E9%85%8D%E7%BD%AE/></a></article><article class=post-entry><header class=entry-header><h2>spring bootè¿æ¥redis</h2></header><section class=entry-content><p>Spring-data-redisä¸ºspring-dataæ¨¡å—ä¸­å¯¹redisçš„æ”¯æŒéƒ¨åˆ†ï¼Œç®€ç§°ä¸ºâ€œSDRâ€ï¼Œæä¾›äº†åŸºäºjediså®¢æˆ·ç«¯APIçš„é«˜åº¦å°è£…ä»¥åŠä¸springå®¹å™¨çš„æ•´åˆï¼Œ
jediså®¢æˆ·ç«¯åœ¨ç¼–ç¨‹å®æ–½æ–¹é¢å­˜åœ¨å¦‚ä¸‹ä¸è¶³ï¼š
connectionç®¡ç†ç¼ºä¹è‡ªåŠ¨åŒ–ï¼Œconnection-poolçš„è®¾è®¡ç¼ºå°‘å¿…è¦çš„å®¹å™¨æ”¯æŒã€‚ æ•°æ®æ“ä½œéœ€è¦å…³æ³¨â€œåºåˆ—åŒ–â€/â€œååºåˆ—åŒ–â€ï¼Œå› ä¸ºjedisçš„å®¢æˆ·ç«¯APIæ¥å—çš„æ•°æ®ç±»å‹ä¸ºstringå’Œbyteï¼Œå¯¹ç»“æ„åŒ–æ•°æ®(json,xml,pojoç­‰)æ“ä½œéœ€è¦é¢å¤–çš„æ”¯æŒã€‚ äº‹åŠ¡æ“ä½œçº¯ç²¹ä¸ºç¡¬ç¼–ç  pub/subåŠŸèƒ½ï¼Œç¼ºä¹å¿…è¦çš„è®¾è®¡æ¨¡å¼æ”¯æŒï¼Œå¯¹äºå¼€å‘è€…è€Œè¨€éœ€è¦å…³æ³¨çš„å¤ªå¤šã€‚ 1 spring-data-redisç‰¹æ€§ è¿æ¥æ± è‡ªåŠ¨ç®¡ç†ï¼Œæä¾›äº†ä¸€ä¸ªé«˜åº¦å°è£…çš„â€œRedisTemplateâ€ç±» é’ˆå¯¹jediså®¢æˆ·ç«¯ä¸­å¤§é‡apiè¿›è¡Œäº†å½’ç±»å°è£…,å°†åŒä¸€ç±»å‹æ“ä½œå°è£…ä¸ºoperationæ¥å£ ValueOperationsï¼šç®€å•K-Væ“ä½œ SetOperationsï¼šsetç±»å‹æ•°æ®æ“ä½œ ZSetOperationsï¼šzsetç±»å‹æ•°æ®æ“ä½œ HashOperationsï¼šé’ˆå¯¹mapç±»å‹çš„æ•°æ®æ“ä½œ ListOperationsï¼šé’ˆå¯¹listç±»å‹çš„æ•°æ®æ“ä½œ æä¾›äº†å¯¹keyçš„â€œboundâ€(ç»‘å®š)ä¾¿æ·åŒ–æ“ä½œAPIï¼Œå¯ä»¥é€šè¿‡boundå°è£…æŒ‡å®šçš„keyï¼Œç„¶åè¿›è¡Œä¸€ç³»åˆ—çš„æ“ä½œè€Œæ— é¡»â€œæ˜¾å¼â€çš„å†æ¬¡æŒ‡å®šKeyï¼Œå³BoundKeyOperationsï¼š BoundValueOperations BoundSetOperations BoundListOperations BoundSetOperations BoundHashOperations å°†äº‹åŠ¡æ“ä½œå°è£…ï¼Œæœ‰å®¹å™¨æ§åˆ¶ã€‚ é’ˆå¯¹æ•°æ®çš„â€œåºåˆ—åŒ–/ååºåˆ—åŒ–â€ï¼Œæä¾›äº†å¤šç§å¯é€‰æ‹©ç­–ç•¥(RedisSerializer) JdkSerializationRedisSerializerï¼šPOJOå¯¹è±¡çš„å­˜å–åœºæ™¯ï¼Œä½¿ç”¨JDKæœ¬èº«åºåˆ—åŒ–æœºåˆ¶ï¼Œå°†pojoç±»é€šè¿‡ObjectInputStream/ObjectOutputStreamè¿›è¡Œåºåˆ—åŒ–æ“ä½œï¼Œæœ€ç»ˆredis-serverä¸­å°†å­˜å‚¨å­—èŠ‚åºåˆ—ã€‚æ˜¯ç›®å‰æœ€å¸¸ç”¨çš„åºåˆ—åŒ–ç­–ç•¥ã€‚ StringRedisSerializerï¼šKeyæˆ–è€…valueä¸ºå­—ç¬¦ä¸²çš„åœºæ™¯ï¼Œæ ¹æ®æŒ‡å®šçš„charsetå¯¹æ•°æ®çš„å­—èŠ‚åºåˆ—ç¼–ç æˆstringï¼Œæ˜¯â€œnew String(bytes, charset)â€å’Œâ€œstring.getBytes(charset)â€çš„ç›´æ¥å°è£…ã€‚æ˜¯æœ€è½»é‡çº§å’Œé«˜æ•ˆçš„ç­–ç•¥ã€‚ JacksonJsonRedisSerializerï¼šjackson-jsonå·¥å…·æä¾›äº†javabeanä¸jsonä¹‹é—´çš„è½¬æ¢èƒ½åŠ›ï¼Œå¯ä»¥å°†pojoå®ä¾‹åºåˆ—åŒ–æˆjsonæ ¼å¼å­˜å‚¨åœ¨redisä¸­ï¼Œä¹Ÿå¯ä»¥å°†jsonæ ¼å¼çš„æ•°æ®è½¬æ¢æˆpojoå®ä¾‹ã€‚å› ä¸ºjacksonå·¥å…·åœ¨åºåˆ—åŒ–å’Œååºåˆ—åŒ–æ—¶ï¼Œéœ€è¦æ˜ç¡®æŒ‡å®šClassç±»å‹ï¼Œå› æ­¤æ­¤ç­–ç•¥å°è£…èµ·æ¥ç¨å¾®å¤æ‚ã€‚ OxmSerializerï¼šæä¾›äº†å°†javabeanä¸xmlä¹‹é—´çš„è½¬æ¢èƒ½åŠ›ï¼Œç›®å‰å¯ç”¨çš„ä¸‰æ–¹æ”¯æŒåŒ…æ‹¬jaxbï¼Œapache-xmlbeansï¼›rediså­˜å‚¨çš„æ•°æ®å°†æ˜¯xmlå·¥å…·ã€‚ä¸è¿‡ä½¿ç”¨æ­¤ç­–ç•¥ï¼Œç¼–ç¨‹å°†ä¼šæœ‰äº›éš¾åº¦ï¼Œè€Œä¸”æ•ˆç‡æœ€ä½ï¼›ä¸å»ºè®®ä½¿ç”¨ã€‚ åŸºäºè®¾è®¡æ¨¡å¼ï¼Œå’ŒJMSå¼€å‘æ€è·¯ï¼Œå°†pub/subçš„APIè®¾è®¡è¿›è¡Œäº†å°è£…ï¼Œä½¿å¼€å‘æ›´åŠ ä¾¿æ·ã€‚ spring-data-redisä¸­ï¼Œå¹¶æ²¡æœ‰å¯¹shardingæä¾›è‰¯å¥½çš„å°è£…ï¼Œå¦‚æœä½ çš„æ¶æ„æ˜¯åŸºäºshardingï¼Œé‚£ä¹ˆä½ éœ€è¦è‡ªå·±å»å®ç°ï¼Œè¿™ä¹Ÿæ˜¯sdrå’Œjedisç›¸æ¯”ï¼Œå”¯ä¸€ç¼ºå°‘çš„ç‰¹æ€§ã€‚ 2 å¼•å…¥ä¾èµ– &lt;dependency> &lt;groupId>org.springframework.boot&lt;/groupId> &lt;artifactId>spring-boot-starter-data-redis&lt;/artifactId> &lt;/dependency> 3 é…ç½® # REDIS (RedisProperties) # Redisæ•°æ®åº“ç´¢å¼•ï¼ˆé»˜è®¤ä¸º0ï¼‰ spring.redis.database=0 # RedisæœåŠ¡å™¨åœ°å€ spring.redis.host=localhost # RedisæœåŠ¡å™¨è¿æ¥ç«¯å£ spring.redis.port=6379 # RedisæœåŠ¡å™¨è¿æ¥å¯†ç ï¼ˆé»˜è®¤ä¸ºç©ºï¼‰ spring.redis.password=root # è¿æ¥æ± æœ€å¤§è¿æ¥æ•°ï¼ˆä½¿ç”¨è´Ÿå€¼è¡¨ç¤ºæ²¡æœ‰é™åˆ¶ï¼‰ spring.redis.pool.max-active=8 # è¿æ¥æ± æœ€å¤§é˜»å¡ç­‰å¾…æ—¶é—´ï¼ˆä½¿ç”¨è´Ÿå€¼è¡¨ç¤ºæ²¡æœ‰é™åˆ¶ï¼‰ spring....</p></section><footer class=entry-footer>March 24, 2018&nbsp;Â·&nbsp;2 min&nbsp;Â·&nbsp;Lucas</footer><a class=entry-link aria-label="post link to spring bootè¿æ¥redis" href=https://zhenfeng-zhu.github.io/gh/posts/spring-boot%E8%BF%9E%E6%8E%A5redis/></a></article><footer class=page-footer><nav class=pagination><a class=prev href=https://zhenfeng-zhu.github.io/gh/posts/page/11/>Â« Prev Page</a>
<a class=next href=https://zhenfeng-zhu.github.io/gh/posts/page/13/>Next Page Â»</a></nav></footer></main><footer class=footer><span>&copy; 2021 <a href=https://zhenfeng-zhu.github.io/gh>Go Data</a></span>
<span>&#183;</span>
<span>Powered by <a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a></span>
<span>&#183;</span>
<span>Theme <a href=https://git.io/hugopapermod rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)"><button class=top-link id=top-link type=button accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></button></a>
<script>window.onload=function(){if(localStorage.getItem("menu-scroll-position")){document.getElementById('menu').scrollLeft=localStorage.getItem("menu-scroll-position");}}
document.querySelectorAll('a[href^="#"]').forEach(anchor=>{anchor.addEventListener("click",function(e){e.preventDefault();var id=this.getAttribute("href").substr(1);if(!window.matchMedia('(prefers-reduced-motion: reduce)').matches){document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({behavior:"smooth"});}else{document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();}
if(id==="top"){history.replaceState(null,null," ");}else{history.pushState(null,null,`#${id}`);}});});var mybutton=document.getElementById("top-link");window.onscroll=function(){if(document.body.scrollTop>800||document.documentElement.scrollTop>800){mybutton.style.visibility="visible";mybutton.style.opacity="1";}else{mybutton.style.visibility="hidden";mybutton.style.opacity="0";}};function menu_on_scroll(){localStorage.setItem("menu-scroll-position",document.getElementById('menu').scrollLeft);}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{if(document.body.className.includes("dark")){document.body.classList.remove('dark');localStorage.setItem("pref-theme",'light');}else{document.body.classList.add('dark');localStorage.setItem("pref-theme",'dark');}})</script></body></html>