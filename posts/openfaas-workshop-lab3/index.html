<!doctype html><html lang=en dir=auto>
<head><meta charset=utf-8>
<meta http-equiv=x-ua-compatible content="IE=edge">
<meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no">
<meta name=robots content="index, follow">
<title>openfaas-workshop-lab3 | Awesome Fenix</title>
<meta name=keywords content>
<meta name=description content="Lab3 - 函数的介绍 在开始本实验之前，创建一个新文件夹：
$ mkdir -p lab3 \ && cd lab3 创建一个新函数 创建函数有两种方式：
 使用内置的或社区提供的代码末班创建一个函数脚手架（默认）   将现有的二进制文件作为函数（高级）  生成一个新函数 在使用模板创建一个新函数之前，首先确认你已经从 Github 上拉下来模板文件：
$ faas-cli template pull Fetch templates from repository: https://github.com/openfaas/templates.git Attempting to expand templates from https://github.com/openfaas/templates.git Fetched 11 template(s) : [csharp dockerfile go go-armhf node node-arm64 node-armhf python python-armhf python3 ruby] 之后找到可用的语言：
$ faas-cli new --list Languages available as templates: - csharp - dockerfile - go - go-armhf - node - node-arm64 - node-armhf - python - python-armhf - python3 - ruby Or alternatively create a folder containing a Dockerfile, then pick the &#34;Dockerfile&#34; lang type in your YAML file.">
<meta name=author content="Fenix">
<link rel=canonical href=https://zhenfeng-zhu.github.io/posts/openfaas-workshop-lab3/>
<link crossorigin=anonymous href=/assets/css/stylesheet.min.c88963fe2d79462000fd0fb1b3737783c32855d340583e4523343f8735c787f0.css integrity="sha256-yIlj/i15RiAA/Q+xs3N3g8MoVdNAWD5FIzQ/hzXHh/A=" rel="preload stylesheet" as=style>
<script defer crossorigin=anonymous src=/assets/js/highlight.min.7680afc38aa6b15ddf158a4f3780b7b1f7dde7e91d26f073e6229bb7a0793c92.js integrity="sha256-doCvw4qmsV3fFYpPN4C3sffd5+kdJvBz5iKbt6B5PJI=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://zhenfeng-zhu.github.io/favicon.ico>
<link rel=icon type=image/png sizes=16x16 href=https://zhenfeng-zhu.github.io/favicon-16x16.png>
<link rel=icon type=image/png sizes=32x32 href=https://zhenfeng-zhu.github.io/favicon-32x32.png>
<link rel=apple-touch-icon href=https://zhenfeng-zhu.github.io/apple-touch-icon.png>
<link rel=mask-icon href=https://zhenfeng-zhu.github.io/safari-pinned-tab.svg>
<meta name=theme-color content="#2e2e33">
<meta name=msapplication-TileColor content="#2e2e33">
<meta name=generator content="Hugo 0.91.2">
<noscript>
<style>#theme-toggle,.top-link{display:none}</style>
<style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style>
</noscript><meta property="og:title" content="openfaas-workshop-lab3">
<meta property="og:description" content="Lab3 - 函数的介绍 在开始本实验之前，创建一个新文件夹：
$ mkdir -p lab3 \ && cd lab3 创建一个新函数 创建函数有两种方式：
 使用内置的或社区提供的代码末班创建一个函数脚手架（默认）   将现有的二进制文件作为函数（高级）  生成一个新函数 在使用模板创建一个新函数之前，首先确认你已经从 Github 上拉下来模板文件：
$ faas-cli template pull Fetch templates from repository: https://github.com/openfaas/templates.git Attempting to expand templates from https://github.com/openfaas/templates.git Fetched 11 template(s) : [csharp dockerfile go go-armhf node node-arm64 node-armhf python python-armhf python3 ruby] 之后找到可用的语言：
$ faas-cli new --list Languages available as templates: - csharp - dockerfile - go - go-armhf - node - node-arm64 - node-armhf - python - python-armhf - python3 - ruby Or alternatively create a folder containing a Dockerfile, then pick the &#34;Dockerfile&#34; lang type in your YAML file.">
<meta property="og:type" content="article">
<meta property="og:url" content="https://zhenfeng-zhu.github.io/posts/openfaas-workshop-lab3/"><meta property="og:image" content="https://zhenfeng-zhu.github.io/papermod-cover.png"><meta property="article:section" content="posts">
<meta property="article:published_time" content="2018-06-28T17:29:56+00:00">
<meta property="article:modified_time" content="2018-06-28T17:29:56+00:00">
<meta name=twitter:card content="summary_large_image">
<meta name=twitter:image content="https://zhenfeng-zhu.github.io/papermod-cover.png">
<meta name=twitter:title content="openfaas-workshop-lab3">
<meta name=twitter:description content="Lab3 - 函数的介绍 在开始本实验之前，创建一个新文件夹：
$ mkdir -p lab3 \ && cd lab3 创建一个新函数 创建函数有两种方式：
 使用内置的或社区提供的代码末班创建一个函数脚手架（默认）   将现有的二进制文件作为函数（高级）  生成一个新函数 在使用模板创建一个新函数之前，首先确认你已经从 Github 上拉下来模板文件：
$ faas-cli template pull Fetch templates from repository: https://github.com/openfaas/templates.git Attempting to expand templates from https://github.com/openfaas/templates.git Fetched 11 template(s) : [csharp dockerfile go go-armhf node node-arm64 node-armhf python python-armhf python3 ruby] 之后找到可用的语言：
$ faas-cli new --list Languages available as templates: - csharp - dockerfile - go - go-armhf - node - node-arm64 - node-armhf - python - python-armhf - python3 - ruby Or alternatively create a folder containing a Dockerfile, then pick the &#34;Dockerfile&#34; lang type in your YAML file.">
<script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":2,"name":"Posts","item":"https://zhenfeng-zhu.github.io/posts/"},{"@type":"ListItem","position":3,"name":"openfaas-workshop-lab3","item":"https://zhenfeng-zhu.github.io/posts/openfaas-workshop-lab3/"}]}</script>
<script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"openfaas-workshop-lab3","name":"openfaas-workshop-lab3","description":"Lab3 - 函数的介绍 在开始本实验之前，创建一个新文件夹：\n$ mkdir -p lab3 \\ \u0026amp;\u0026amp; cd lab3 创建一个新函数 创建函数有两种方式：\n 使用内置的或社区提供的代码末班创建一个函数脚手架（默认）   将现有的二进制文件作为函数（高级）  生成一个新函数 在使用模板创建一个新函数之前，首先确认你已经从 Github 上拉下来模板文件：\n$ faas-cli template pull Fetch templates from repository: https://github.com/openfaas/templates.git Attempting to expand templates from https://github.com/openfaas/templates.git Fetched 11 template(s) : [csharp dockerfile go go-armhf node node-arm64 node-armhf python python-armhf python3 ruby] 之后找到可用的语言：\n$ faas-cli new --list Languages available as templates: - csharp - dockerfile - go - go-armhf - node - node-arm64 - node-armhf - python - python-armhf - python3 - ruby Or alternatively create a folder containing a Dockerfile, then pick the \u0026#34;Dockerfile\u0026#34; lang type in your YAML file.","keywords":[],"articleBody":"Lab3 - 函数的介绍 在开始本实验之前，创建一个新文件夹：\n$ mkdir -p lab3 \\ \u0026\u0026 cd lab3 创建一个新函数 创建函数有两种方式：\n 使用内置的或社区提供的代码末班创建一个函数脚手架（默认）   将现有的二进制文件作为函数（高级）  生成一个新函数 在使用模板创建一个新函数之前，首先确认你已经从 Github 上拉下来模板文件：\n$ faas-cli template pull Fetch templates from repository: https://github.com/openfaas/templates.git Attempting to expand templates from https://github.com/openfaas/templates.git Fetched 11 template(s) : [csharp dockerfile go go-armhf node node-arm64 node-armhf python python-armhf python3 ruby] 之后找到可用的语言：\n$ faas-cli new --list Languages available as templates: - csharp - dockerfile - go - go-armhf - node - node-arm64 - node-armhf - python - python-armhf - python3 - ruby Or alternatively create a folder containing a Dockerfile, then pick the \"Dockerfile\" lang type in your YAML file. 此时你可以创建 Python, Python 3, Ruby, Go, Node, CSharp 等函数。\n 关于我们例子的说明  在这个 workshop 中的所有例子都已经被 OpenFaas 社区使用 Python3 测试通过，应该也兼容 Python2.7。\n如果你倾向于 Python2.7 而不是 Python3，使用faas-cli new --lang python命令替换faas-cli new --lang python3。\nPython 里的 Hello World 我们将会用 Python 创建一个 hello-world 函数，然后也会学习附加的依赖项。\n 函数脚手架  $ faas-cli new --lang python3 hello-openfaas --prefix=\"\" —prefix 参数将会把hello-openfaas.yml文件里image: 变量中的 prefix 更新为你的 docker hub 的账户。OpenFaas 的镜像image: functions/hello-openfaas里的参数将会是--prefix=\"functions\"。\n如果你不想指定 prefix，那么在创建函数之后可以通过修改 YAML 文件。\n这将会在文件夹中创建 3 个文件：\n./hello-openfaas.yml ./hello-openfaas ./hello-openfaas/handler.py ./hello-openfaas/requirements.txt YAML(.yml)文件用于配置 CLI 的构建，推送和部署。\n 说明：无论何时你需要在 Kubernetes 或远程 OpenFaaS 实例部署一个函数时，都必须在你构建之后。\n在这个例子中，你也可以通过设置一个环境变量：export OPENFAAS_URL=127.0.0.1:31112覆盖掉默认的网关 URL：127.0.0.1：8080，\n 如下是 YAML 文件的内容：\nprovider: name: faas gateway: http://127.0.0.1:8080 functions: hello-openfaas: lang: python3 handler: ./hello-openfaas image: hello-openfaas  函数的名字是在functions的下面，如：hello-openfaas    语言是放在 lang 之下\n  handler 是用于构建的文件夹，一定得是文件夹，不能是文件\n  docker 的镜像名是放在 image 之下\n  请记住，网关的 URL 是可以在 YAML 文件中 provider 下的 gateway 字段覆写，或者是在 CLI 中使用—gateway 参数或是环境变量的的 OPENFAAS_URL。\n如下是handler.py文件的内容：\ndef handle(req): \"\"\"handle a request to the function Args: req (str): request body \"\"\" return req 这个函数返回输入的值，和 echo 函数很像。\n将返回值修改为Hello OpenFaaS，如：\nreturn \"Hello OpenFaaS\" 任何返回给标准输出的值随后都会被返回给调用的程序。或者说是一个 print()语句和显示的结果和调用的程序流程相似。\n这是本地的开发流程：\n$ faas-cli build -f ./hello-openfaas.yml $ faas-cli push -f ./hello-openfaas.yml $ faas-cli deploy -f ./hello-openfaas.yml 接下来通过 UI，CLI，curk 或者其他的程序去调用函数。\n这些函数都会被分配一个路由，比如：\nhttp://127.0.0.1:8080/function/ http://127.0.0.1:8080/function/figlet http://127.0.0.1:8080/function/hello-openfaas  专家提醒：如果你重命名了 YAML 文件为 stack.yml，不再需要是用-f 参数。\n 函数只能被 get 或 post 方法调用。\n 调用你的函数  使用 faas-cli invoke 测试函数，更多的命令请参考 faas-cli invoke –help\n例子：发现宇航员 我们将会创建一个叫 astronaut-finder 函数，这个函数会从国际空间站上拉取一个随机的宇航员的名字。\n$ faas-cli new --lang python3 astronaut-finder --prefix=\"\" 这会为我们创建三个文件：\n./astronaut-finder/handler.py 该函数的 handler —— 你会得到一个原始的请求 req 对象，而且会在控制台上打印结果。\n./astronaut-finder/requirements.txt 在这个文件中列出你想要安装的 pip 模块，比如 requests 或 urllib\n./astronaut-finder.yml 这个文件用于管理函数——在里面有函数名，docker 镜像和其他自定义的字段。\n Edit ./astronaut-finder/requirements.txt 修改./astronaut-finder/requirements.txt  requests 这告诉函数，他需要使用一个名叫 requests 的第三方包用于使用 http 请求网站。\n 写函数代码：  我们将会从 http://api.open-notify.org/astros.json 拉取数据\n这是返回结果的例子：\n{ \"number\": 6, \"people\": [ { \"craft\": \"ISS\", \"name\": \"Alexander Misurkin\" }, { \"craft\": \"ISS\", \"name\": \"Mark Vande Hei\" }, { \"craft\": \"ISS\", \"name\": \"Joe Acaba\" }, { \"craft\": \"ISS\", \"name\": \"Anton Shkaplerov\" }, { \"craft\": \"ISS\", \"name\": \"Scott Tingle\" }, { \"craft\": \"ISS\", \"name\": \"Norishige Kanai\" } ], \"message\": \"success\" } 更新 handler.py：\nimport requests import random def handle(req): r = requests.get(\"http://api.open-notify.org/astros.json\") result = r.json() index = random.randint(0, len(result[\"people\"])-1) name = result[\"people\"][index][\"name\"] return \"%s is in space\" % (name)  备注：在这个例子中我们不需要使用 req 参数，但是必须确保他在函数头里。\n 现在构建函数：\n$ faas-cli build -f ./astronaut-finder.yml  提示：试着将 astronaut-finder.yml 重命名为 stack.yml，然后就可以使用 faas-cli build。\nstack.yml 是 CLI 的默认命名。\n 部署函数：\n$ faas-cli deploy -f ./astronaut-finder.yml 调用函数\n$ echo | faas-cli invoke astronaut-finder Anton Shkaplerov is in space $ echo | faas-cli invoke astronaut-finder Joe Acaba is in space 故障排除：找到容器的日志 通过容器的日志你可以找到函数每次调用的高级别的信息：\n$ docker service logs -f astronaut-finder astronaut-finder.1.1e1ujtsijf6b@nuc | 2018/02/21 14:53:25 Forking fprocess. astronaut-finder.1.1e1ujtsijf6b@nuc | 2018/02/21 14:53:26 Wrote 18 Bytes - Duration: 0.063269 seconds 故障排除：使用 write_debug 详细输出 让我们打开函数的详细输出。为了不让函数的日志和数据泛滥，这个功能默认是关闭的，在日志里有很多没有意义的二进制数据时，这点儿尤为重要。\n这是标准的 YAML 配置：\nprovider: name: faas gateway: http://127.0.0.1:8080 functions: astronaut-finder: lang: python3 handler: ./astronaut-finder image: astronaut-finder 编辑 YAML 文件，添加 environment。\nastronaut-finder: lang: python3 handler: ./astronaut-finder image: astronaut-finder environment: write_debug: true 现在再次使用faas-cli deploy -f ./astronaut-finder.yml部署。\n调用函数，然后观察函数的返回：\n$ docker service logs -f astronaut-finder astronaut-finder.1.1e1ujtsijf6b@nuc | 2018/02/21 14:53:25 Forking fprocess. astronaut-finder.1.szobw9pt3m60@nuc | 2018/02/26 14:49:57 Query astronaut-finder.1.szobw9pt3m60@nuc | 2018/02/26 14:49:57 Path /function/hello-openfaas astronaut-finder.1.1e1ujtsijf6b@nuc | 2018/02/21 14:53:26 Hello World astronaut-finder.1.1e1ujtsijf6b@nuc | 2018/02/21 14:53:26 Duration: 0.063269 seconds 管理多个函数 CLI 的 YAML 文件也可以把函数打组为一个 stack 里，当在几个相关联的函数工作时是很有用的。\n看一下如何生成两个函数：\n$ faas-cli new --lang python3 first 第二个函数使用–apend 标志：\n$ faas-cli new --lang python3 second --append=./first.yml 为了方便我们把 first.yml 重命名为 example.yml。\n$ mv first.yml example.yml 现在看一下文件：\nprovider: name: faas gateway: http://127.0.0.1:8080 functions: first: lang: python3 handler: ./first image: first second: lang: python3 handler: ./second image: second 当一个函数栈工作时，这里有几个有用的标志。\n 并行构建  $ faas-cli build -f ./example.yml --parallel=2  只构建或者推送一个函数  $ faas-cli build -f ./example.yml --filter=second 更多信息请参考faas-cli build --help 和 faas-cli push --help 。\n 专家提醒：如果你不想传-f 参数，faas-cli 将会自动寻找 stack.yml 文件。\n 你也可以在使用faas-cli -f https://....将函数栈部署在 https 上。\n使用自定义模板 如果你有自己的语言模板或者是从社区中找到的模板，比如 PHP。你可以使用下面的命令添加进来：\n$ faas-cli template pull https://github.com/itscaro/openfaas-template-php ... $ faas-cli new --list | grep php - php - php5 社区模板列表维护在OpenFaaS CLI README页面。\n继续可选的练习或者进入 Lab 4。\n自定义二进制文件为函数（可选） 自定义二进制文件或者容器也可以被作为函数，但是大部分时间里使用语言模板文件应该可以涵盖大多数情况。\n通过使用 dockerfile 语言，可以用自定义二进制或者 Dockerfile 创建一个新函数函数：\n$ faas-cli new --lang dockerfile sorter --prefix=\"\" 你将会看到 sorter 文件夹和 sorter.yml 文件被创建。\n编辑 sorter/Docerfile，更新设置 fprocess 的那一行。让我们改变他为内置 bash 的 sort 命令。我们可以用这个命令对字符串按照字母数字顺序排序。\nENV fprocess=\"sort\" 构建，推送和部署函数：\n$ faas-cli build -f sorter.yml \\ \u0026\u0026 faas-cli push -f sorter.yml \\ \u0026\u0026 faas-cli deploy -f sorter.yml 从 UI 或者 CLI 中调用函数：\n$ echo -n ' elephant zebra horse ardvark monkey'| faas-cli invoke sorter ardvark elephant horse monkey zebra 在这个例子中我们使用内置于 BusyBox 的 sort 命令。也有其他有用的命令，比如 sha512sum，甚至可以是 bash 或者 shell 脚本，而且并不限制于这些命令。任何二进制或者存在的容器都可以通过添加到 OpenFaaS 的函数 watchdog 中来将它 serverless 化。\n 提示：你知道 OpenFaaS 也支持 WIndows 的二进制文件吗？比如 C#，VB 或者 PowerShell？\n 现在进入 Lab 4\n","wordCount":"761","inLanguage":"en","datePublished":"2018-06-28T17:29:56Z","dateModified":"2018-06-28T17:29:56Z","author":{"@type":"Person","name":"Fenix"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://zhenfeng-zhu.github.io/posts/openfaas-workshop-lab3/"},"publisher":{"@type":"Organization","name":"Awesome Fenix","logo":{"@type":"ImageObject","url":"https://zhenfeng-zhu.github.io/favicon.ico"}}}</script>
</head>
<body id=top>
<script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add('dark'):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove('dark'):window.matchMedia('(prefers-color-scheme: dark)').matches&&document.body.classList.add('dark')</script>
<header class=header>
<nav class=nav>
<div class=logo>
<a href=https://zhenfeng-zhu.github.io accesskey=h title="Awesome Fenix (Alt + H)">Awesome Fenix</a>
<span class=logo-switches>
<button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg>
</button>
</span>
</div>
<ul id=menu>
<li>
<a href=https://zhenfeng-zhu.github.io/archives/ title=Archives>
<span>Archives</span>
</a>
</li>
<li>
<a href=https://zhenfeng-zhu.github.io/about title=About>
<span>About</span>
</a>
</li>
<li>
<a href=https://zhenfeng-zhu.github.io/search/ title=🔍>
<span>🔍</span>
</a>
</li>
</ul>
</nav>
</header>
<main class=main>
<article class=post-single>
<header class=post-header>
<div class=breadcrumbs><a href=https://zhenfeng-zhu.github.io>Home</a>&nbsp;»&nbsp;<a href=https://zhenfeng-zhu.github.io/posts/>Posts</a></div>
<h1 class=post-title>
openfaas-workshop-lab3
</h1>
<div class=post-meta><span title="2018-06-28 17:29:56 +0000 UTC">June 28, 2018</span>&nbsp;·&nbsp;4 min&nbsp;·&nbsp;Fenix&nbsp;|&nbsp;<a href=https://github.com/zhenfeng-zhu/zhenfeng-zhu.github.io/content rel="noopener noreferrer" target=_blank>Suggest Changes</a>
</div>
</header> <div class=toc>
<details>
<summary accesskey=c title="(Alt + C)">
<span class=details>Table of Contents</span>
</summary>
<div class=inner><ul>
<li>
<a href=#lab3---%e5%87%bd%e6%95%b0%e7%9a%84%e4%bb%8b%e7%bb%8d aria-label="Lab3 - 函数的介绍">Lab3 - 函数的介绍</a><ul>
<li>
<a href=#%e5%88%9b%e5%bb%ba%e4%b8%80%e4%b8%aa%e6%96%b0%e5%87%bd%e6%95%b0 aria-label=创建一个新函数>创建一个新函数</a><ul>
<li>
<a href=#%e7%94%9f%e6%88%90%e4%b8%80%e4%b8%aa%e6%96%b0%e5%87%bd%e6%95%b0 aria-label=生成一个新函数>生成一个新函数</a></li>
<li>
<a href=#python-%e9%87%8c%e7%9a%84-hello-world aria-label="Python 里的 Hello World">Python 里的 Hello World</a></li>
<li>
<a href=#%e4%be%8b%e5%ad%90%e5%8f%91%e7%8e%b0%e5%ae%87%e8%88%aa%e5%91%98 aria-label=例子：发现宇航员>例子：发现宇航员</a></li></ul>
</li>
<li>
<a href=#%e6%95%85%e9%9a%9c%e6%8e%92%e9%99%a4%e6%89%be%e5%88%b0%e5%ae%b9%e5%99%a8%e7%9a%84%e6%97%a5%e5%bf%97 aria-label=故障排除：找到容器的日志>故障排除：找到容器的日志</a></li>
<li>
<a href=#%e6%95%85%e9%9a%9c%e6%8e%92%e9%99%a4%e4%bd%bf%e7%94%a8-write_debug-%e8%af%a6%e7%bb%86%e8%be%93%e5%87%ba aria-label="故障排除：使用 write_debug 详细输出">故障排除：使用 write_debug 详细输出</a><ul>
<li>
<a href=#%e7%ae%a1%e7%90%86%e5%a4%9a%e4%b8%aa%e5%87%bd%e6%95%b0 aria-label=管理多个函数>管理多个函数</a></li>
<li>
<a href=#%e4%bd%bf%e7%94%a8%e8%87%aa%e5%ae%9a%e4%b9%89%e6%a8%a1%e6%9d%bf aria-label=使用自定义模板>使用自定义模板</a></li>
<li>
<a href=#%e8%87%aa%e5%ae%9a%e4%b9%89%e4%ba%8c%e8%bf%9b%e5%88%b6%e6%96%87%e4%bb%b6%e4%b8%ba%e5%87%bd%e6%95%b0%e5%8f%af%e9%80%89 aria-label=自定义二进制文件为函数（可选）>自定义二进制文件为函数（可选）</a>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</details>
</div>
<div class=post-content><h1 id=lab3---函数的介绍>Lab3 - 函数的介绍<a hidden class=anchor aria-hidden=true href=#lab3---函数的介绍>#</a></h1>
<p></p>
<p>在开始本实验之前，创建一个新文件夹：</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-plain data-lang=plain>$ mkdir -p lab3 \
   &amp;&amp; cd lab3
</code></pre></div><h2 id=创建一个新函数>创建一个新函数<a hidden class=anchor aria-hidden=true href=#创建一个新函数>#</a></h2>
<p>创建函数有两种方式：</p>
<ul>
<li>使用内置的或社区提供的代码末班创建一个函数脚手架（默认）</li>
</ul>
<ul>
<li>将现有的二进制文件作为函数（高级）</li>
</ul>
<h3 id=生成一个新函数>生成一个新函数<a hidden class=anchor aria-hidden=true href=#生成一个新函数>#</a></h3>
<p>在使用模板创建一个新函数之前，首先确认你已经从 Github 上拉下来<a href=https://github.com/openfaas/templates>模板文件</a>：</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-plain data-lang=plain>$ faas-cli template pull

Fetch templates from repository: https://github.com/openfaas/templates.git
 Attempting to expand templates from https://github.com/openfaas/templates.git
 Fetched 11 template(s) : [csharp dockerfile go go-armhf node node-arm64 node-armhf python python-armhf python3 ruby]
</code></pre></div><p>之后找到可用的语言：</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-plain data-lang=plain>$ faas-cli new --list
Languages available as templates:
- csharp
- dockerfile
- go
- go-armhf
- node
- node-arm64
- node-armhf
- python
- python-armhf
- python3
- ruby

Or alternatively create a folder containing a Dockerfile, then pick
the &#34;Dockerfile&#34; lang type in your YAML file.
</code></pre></div><p>此时你可以创建 Python, Python 3, Ruby, Go, Node, CSharp 等函数。</p>
<ul>
<li>关于我们例子的说明</li>
</ul>
<p>在这个 workshop 中的所有例子都已经被 OpenFaas 社区使用 Python3 测试通过，应该也兼容 Python2.7。</p>
<p>如果你倾向于 Python2.7 而不是 Python3，使用<code>faas-cli new --lang python</code>命令替换<code>faas-cli new --lang python3</code>。</p>
<h3 id=python-里的-hello-world>Python 里的 Hello World<a hidden class=anchor aria-hidden=true href=#python-里的-hello-world>#</a></h3>
<p>我们将会用 Python 创建一个 hello-world 函数，然后也会学习附加的依赖项。</p>
<ul>
<li>函数脚手架</li>
</ul>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-plain data-lang=plain>$ faas-cli new --lang python3 hello-openfaas --prefix=&#34;&lt;your-docker-username-here&gt;&#34;
</code></pre></div><p>—prefix 参数将会把<code>hello-openfaas.yml</code>文件里<code>image:</code> 变量中的 prefix 更新为你的 docker hub 的账户。OpenFaas 的镜像<code>image: functions/hello-openfaas</code>里的参数将会是<code>--prefix="functions"</code>。</p>
<p>如果你不想指定 prefix，那么在创建函数之后可以通过修改 YAML 文件。</p>
<p>这将会在文件夹中创建 3 个文件：</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-plain data-lang=plain>./hello-openfaas.yml
./hello-openfaas
./hello-openfaas/handler.py
./hello-openfaas/requirements.txt
</code></pre></div><p>YAML(.yml)文件用于配置 CLI 的构建，推送和部署。</p>
<blockquote>
<p>说明：无论何时你需要在 Kubernetes 或远程 OpenFaaS 实例部署一个函数时，都必须在你构建之后。</p>
<p>在这个例子中，你也可以通过设置一个环境变量：<code>export OPENFAAS_URL=127.0.0.1:31112</code>覆盖掉默认的网关 URL：127.0.0.1：8080，</p>
</blockquote>
<p>如下是 YAML 文件的内容：</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=color:#f92672>provider</span>:
  <span style=color:#f92672>name</span>: <span style=color:#ae81ff>faas</span>
  <span style=color:#f92672>gateway</span>: <span style=color:#ae81ff>http://127.0.0.1:8080</span>

<span style=color:#f92672>functions</span>:
  <span style=color:#f92672>hello-openfaas</span>:
    <span style=color:#f92672>lang</span>: <span style=color:#ae81ff>python3</span>
    <span style=color:#f92672>handler</span>: <span style=color:#ae81ff>./hello-openfaas</span>
    <span style=color:#f92672>image</span>: <span style=color:#ae81ff>hello-openfaas</span>
</code></pre></div><ul>
<li>函数的名字是在<code>functions</code>的下面，如：<code>hello-openfaas</code></li>
</ul>
<ul>
<li>
<p>语言是放在 lang 之下</p>
</li>
<li>
<p>handler 是用于构建的文件夹，一定得是文件夹，不能是文件</p>
</li>
<li>
<p>docker 的镜像名是放在 image 之下</p>
</li>
</ul>
<p>请记住，网关的 URL 是可以在 YAML 文件中 provider 下的 gateway 字段覆写，或者是在 CLI 中使用—gateway 参数或是环境变量的的 OPENFAAS_URL。</p>
<p>如下是<code>handler.py</code>文件的内容：</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-plain data-lang=plain>def handle(req):
    &#34;&#34;&#34;handle a request to the function
    Args:
        req (str): request body
    &#34;&#34;&#34;

    return req
</code></pre></div><p>这个函数返回输入的值，和 echo 函数很像。</p>
<p>将返回值修改为<code>Hello OpenFaaS</code>，如：</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-plain data-lang=plain>    return &#34;Hello OpenFaaS&#34;
</code></pre></div><p>任何返回给标准输出的值随后都会被返回给调用的程序。或者说是一个 print()语句和显示的结果和调用的程序流程相似。</p>
<p>这是本地的开发流程：</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-plain data-lang=plain>$ faas-cli build -f ./hello-openfaas.yml
$ faas-cli push -f ./hello-openfaas.yml
$ faas-cli deploy -f ./hello-openfaas.yml
</code></pre></div><p>接下来通过 UI，CLI，curk 或者其他的程序去调用函数。</p>
<p>这些函数都会被分配一个路由，比如：</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-plain data-lang=plain>http://127.0.0.1:8080/function/&lt;function_name&gt;
http://127.0.0.1:8080/function/figlet
http://127.0.0.1:8080/function/hello-openfaas
</code></pre></div><blockquote>
<p>专家提醒：如果你重命名了 YAML 文件为 stack.yml，不再需要是用-f 参数。</p>
</blockquote>
<p>函数只能被 get 或 post 方法调用。</p>
<ul>
<li>调用你的函数</li>
</ul>
<p>使用 faas-cli invoke 测试函数，更多的命令请参考 faas-cli invoke &ndash;help</p>
<h3 id=例子发现宇航员>例子：发现宇航员<a hidden class=anchor aria-hidden=true href=#例子发现宇航员>#</a></h3>
<p>我们将会创建一个叫 astronaut-finder 函数，这个函数会从国际空间站上拉取一个随机的宇航员的名字。</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-plain data-lang=plain>$ faas-cli new --lang python3 astronaut-finder --prefix=&#34;&lt;your-docker-username-here&gt;&#34;
</code></pre></div><p>这会为我们创建三个文件：</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-plain data-lang=plain>./astronaut-finder/handler.py
</code></pre></div><p>该函数的 handler —— 你会得到一个原始的请求 req 对象，而且会在控制台上打印结果。</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-plain data-lang=plain>./astronaut-finder/requirements.txt
</code></pre></div><p>在这个文件中列出你想要安装的 pip 模块，比如 requests 或 urllib</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-plain data-lang=plain>./astronaut-finder.yml
</code></pre></div><p>这个文件用于管理函数——在里面有函数名，docker 镜像和其他自定义的字段。</p>
<ul>
<li>Edit <code>./astronaut-finder/requirements.txt</code></li>
<li>修改<code>./astronaut-finder/requirements.txt</code></li>
</ul>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-plain data-lang=plain>requests
</code></pre></div><p>这告诉函数，他需要使用一个名叫 requests 的第三方包用于使用 http 请求网站。</p>
<ul>
<li>写函数代码：</li>
</ul>
<p>我们将会从 <a href=http://api.open-notify.org/astros.json>http://api.open-notify.org/astros.json</a> 拉取数据</p>
<p>这是返回结果的例子：</p>
<pre tabindex=0><code class=language-on data-lang=on>{
  &quot;number&quot;: 6,
  &quot;people&quot;: [
    { &quot;craft&quot;: &quot;ISS&quot;, &quot;name&quot;: &quot;Alexander Misurkin&quot; },
    { &quot;craft&quot;: &quot;ISS&quot;, &quot;name&quot;: &quot;Mark Vande Hei&quot; },
    { &quot;craft&quot;: &quot;ISS&quot;, &quot;name&quot;: &quot;Joe Acaba&quot; },
    { &quot;craft&quot;: &quot;ISS&quot;, &quot;name&quot;: &quot;Anton Shkaplerov&quot; },
    { &quot;craft&quot;: &quot;ISS&quot;, &quot;name&quot;: &quot;Scott Tingle&quot; },
    { &quot;craft&quot;: &quot;ISS&quot;, &quot;name&quot;: &quot;Norishige Kanai&quot; }
  ],
  &quot;message&quot;: &quot;success&quot;
}
</code></pre><p>更新 handler.py：</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-plain data-lang=plain>import requests
import random

def handle(req):
    r = requests.get(&#34;http://api.open-notify.org/astros.json&#34;)
    result = r.json()
    index = random.randint(0, len(result[&#34;people&#34;])-1)
    name = result[&#34;people&#34;][index][&#34;name&#34;]

    return &#34;%s is in space&#34; % (name)
</code></pre></div><blockquote>
<p>备注：在这个例子中我们不需要使用 req 参数，但是必须确保他在函数头里。</p>
</blockquote>
<p>现在构建函数：</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-plain data-lang=plain>$ faas-cli build -f ./astronaut-finder.yml
</code></pre></div><blockquote>
<p>提示：试着将 astronaut-finder.yml 重命名为 stack.yml，然后就可以使用 faas-cli build。</p>
<p>stack.yml 是 CLI 的默认命名。</p>
</blockquote>
<p>部署函数：</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-plain data-lang=plain>$ faas-cli deploy -f ./astronaut-finder.yml
</code></pre></div><p>调用函数</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-plain data-lang=plain>$ echo | faas-cli invoke astronaut-finder
Anton Shkaplerov is in space

$ echo | faas-cli invoke astronaut-finder
Joe Acaba is in space
</code></pre></div><h2 id=故障排除找到容器的日志>故障排除：找到容器的日志<a hidden class=anchor aria-hidden=true href=#故障排除找到容器的日志>#</a></h2>
<p>通过容器的日志你可以找到函数每次调用的高级别的信息：</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-plain data-lang=plain>$ docker service logs -f astronaut-finder
astronaut-finder.1.1e1ujtsijf6b@nuc    | 2018/02/21 14:53:25 Forking fprocess.
astronaut-finder.1.1e1ujtsijf6b@nuc    | 2018/02/21 14:53:26 Wrote 18 Bytes - Duration: 0.063269 seconds
</code></pre></div><h2 id=故障排除使用-write_debug-详细输出>故障排除：使用 write_debug 详细输出<a hidden class=anchor aria-hidden=true href=#故障排除使用-write_debug-详细输出>#</a></h2>
<p>让我们打开函数的详细输出。为了不让函数的日志和数据泛滥，这个功能默认是关闭的，在日志里有很多没有意义的二进制数据时，这点儿尤为重要。</p>
<p>这是标准的 YAML 配置：</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=color:#f92672>provider</span>:
  <span style=color:#f92672>name</span>: <span style=color:#ae81ff>faas</span>
  <span style=color:#f92672>gateway</span>: <span style=color:#ae81ff>http://127.0.0.1:8080</span>

<span style=color:#f92672>functions</span>:
  <span style=color:#f92672>astronaut-finder</span>:
    <span style=color:#f92672>lang</span>: <span style=color:#ae81ff>python3</span>
    <span style=color:#f92672>handler</span>: <span style=color:#ae81ff>./astronaut-finder</span>
    <span style=color:#f92672>image</span>: <span style=color:#ae81ff>astronaut-finder</span>
</code></pre></div><p>编辑 YAML 文件，添加 environment。</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml>  <span style=color:#f92672>astronaut-finder</span>:
    <span style=color:#f92672>lang</span>: <span style=color:#ae81ff>python3</span>
    <span style=color:#f92672>handler</span>: <span style=color:#ae81ff>./astronaut-finder</span>
    <span style=color:#f92672>image</span>: <span style=color:#ae81ff>astronaut-finder</span>
    <span style=color:#f92672>environment</span>:
      <span style=color:#f92672>write_debug</span>: <span style=color:#66d9ef>true</span>
</code></pre></div><p>现在再次使用<code>faas-cli deploy -f ./astronaut-finder.yml</code>部署。</p>
<p>调用函数，然后观察函数的返回：</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-plain data-lang=plain>$ docker service logs -f astronaut-finder
astronaut-finder.1.1e1ujtsijf6b@nuc    | 2018/02/21 14:53:25 Forking fprocess.
astronaut-finder.1.szobw9pt3m60@nuc    | 2018/02/26 14:49:57 Query  
astronaut-finder.1.szobw9pt3m60@nuc    | 2018/02/26 14:49:57 Path  /function/hello-openfaas
astronaut-finder.1.1e1ujtsijf6b@nuc    | 2018/02/21 14:53:26 Hello World
astronaut-finder.1.1e1ujtsijf6b@nuc    | 2018/02/21 14:53:26 Duration: 0.063269 seconds
</code></pre></div><h3 id=管理多个函数>管理多个函数<a hidden class=anchor aria-hidden=true href=#管理多个函数>#</a></h3>
<p>CLI 的 YAML 文件也可以把函数打组为一个 stack 里，当在几个相关联的函数工作时是很有用的。</p>
<p>看一下如何生成两个函数：</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-plain data-lang=plain>$ faas-cli new --lang python3 first
</code></pre></div><p>第二个函数使用&ndash;apend 标志：</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-plain data-lang=plain>$ faas-cli new --lang python3 second --append=./first.yml
</code></pre></div><p>为了方便我们把 first.yml 重命名为 example.yml。</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-plain data-lang=plain>$ mv first.yml example.yml
</code></pre></div><p>现在看一下文件：</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-plain data-lang=plain>provider:
  name: faas
  gateway: http://127.0.0.1:8080

functions:
  first:
    lang: python3
    handler: ./first
    image: first
  second:
    lang: python3
    handler: ./second
    image: second
</code></pre></div><p>当一个函数栈工作时，这里有几个有用的标志。</p>
<ul>
<li>并行构建</li>
</ul>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>$ faas-cli build -f ./example.yml --parallel<span style=color:#f92672>=</span><span style=color:#ae81ff>2</span>
</code></pre></div><ul>
<li>只构建或者推送一个函数</li>
</ul>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>$ faas-cli build -f ./example.yml --filter<span style=color:#f92672>=</span>second
</code></pre></div><p>更多信息请参考<code>faas-cli build --help</code> 和 <code>faas-cli push --help</code> 。</p>
<blockquote>
<p>专家提醒：如果你不想传-f 参数，faas-cli 将会自动寻找 stack.yml 文件。</p>
</blockquote>
<p>你也可以在使用<code>faas-cli -f https://....</code>将函数栈部署在 https 上。</p>
<h3 id=使用自定义模板>使用自定义模板<a hidden class=anchor aria-hidden=true href=#使用自定义模板>#</a></h3>
<p>如果你有自己的语言模板或者是从社区中找到的模板，比如 PHP。你可以使用下面的命令添加进来：</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-plain data-lang=plain>$ faas-cli template pull https://github.com/itscaro/openfaas-template-php

...

$ faas-cli new --list | grep php
- php
- php5
</code></pre></div><p>社区模板列表维护在<a href=https://github.com/openfaas/faas-cli>OpenFaaS CLI README</a>页面。</p>
<p>继续可选的练习或者进入 <a href=lab4.md>Lab 4</a>。</p>
<h3 id=自定义二进制文件为函数可选>自定义二进制文件为函数（可选）<a hidden class=anchor aria-hidden=true href=#自定义二进制文件为函数可选>#</a></h3>
<p>自定义二进制文件或者容器也可以被作为函数，但是大部分时间里使用语言模板文件应该可以涵盖大多数情况。</p>
<p>通过使用 dockerfile 语言，可以用自定义二进制或者 Dockerfile 创建一个新函数函数：</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-plain data-lang=plain>$ faas-cli new --lang dockerfile sorter --prefix=&#34;&lt;your-docker-username-here&gt;&#34;
</code></pre></div><p>你将会看到 sorter 文件夹和 sorter.yml 文件被创建。</p>
<p>编辑 sorter/Docerfile，更新设置 fprocess 的那一行。让我们改变他为内置 bash 的 sort 命令。我们可以用这个命令对字符串按照字母数字顺序排序。</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-plain data-lang=plain>ENV fprocess=&#34;sort&#34;
</code></pre></div><p>构建，推送和部署函数：</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-plain data-lang=plain>$ faas-cli build -f sorter.yml \
  &amp;&amp; faas-cli push -f sorter.yml \
  &amp;&amp; faas-cli deploy -f sorter.yml
</code></pre></div><p>从 UI 或者 CLI 中调用函数：</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-plain data-lang=plain>$ echo -n &#39;
elephant
zebra
horse
ardvark
monkey&#39;| faas-cli invoke sorter

ardvark
elephant
horse
monkey
zebra
</code></pre></div><p>在这个例子中我们使用内置于 BusyBox 的 sort 命令。也有其他有用的命令，比如 sha512sum，甚至可以是 bash 或者 shell 脚本，而且并不限制于这些命令。任何二进制或者存在的容器都可以通过添加到 OpenFaaS 的函数 watchdog 中来将它 serverless 化。</p>
<blockquote>
<p>提示：你知道 OpenFaaS 也支持 WIndows 的二进制文件吗？比如 C#，VB 或者 PowerShell？</p>
</blockquote>
<p>现在进入 <a href=lab4.md>Lab 4</a></p>
</div>
<footer class=post-footer>
<nav class=paginav>
<a class=prev href=https://zhenfeng-zhu.github.io/posts/ubuntu-docker-sudo/>
<span class=title>« Prev Page</span>
<br>
<span>ubuntu-docker-sudo</span>
</a>
<a class=next href=https://zhenfeng-zhu.github.io/posts/workshop-lab1/>
<span class=title>Next Page »</span>
<br>
<span>译：openfaas-workshop-Lab1</span>
</a>
</nav>
<div class=share-buttons>
<a target=_blank rel="noopener noreferrer" aria-label="share openfaas-workshop-lab3 on twitter" href="https://twitter.com/intent/tweet/?text=openfaas-workshop-lab3&url=https%3a%2f%2fzhenfeng-zhu.github.io%2fposts%2fopenfaas-workshop-lab3%2f&hashtags="><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM195.519 424.544c135.939.0 210.268-112.643 210.268-210.268.0-3.218.0-6.437-.153-9.502 14.406-10.421 26.973-23.448 36.935-38.314-13.18 5.824-27.433 9.809-42.452 11.648 15.326-9.196 26.973-23.602 32.49-40.92-14.252 8.429-30.038 14.56-46.896 17.931-13.487-14.406-32.644-23.295-53.946-23.295-40.767.0-73.87 33.104-73.87 73.87.0 5.824.613 11.494 1.992 16.858-61.456-3.065-115.862-32.49-152.337-77.241-6.284 10.881-9.962 23.601-9.962 37.088.0 25.594 13.027 48.276 32.95 61.456-12.107-.307-23.448-3.678-33.41-9.196v.92c0 35.862 25.441 65.594 59.311 72.49-6.13 1.686-12.72 2.606-19.464 2.606-4.751.0-9.348-.46-13.946-1.38 9.349 29.426 36.628 50.728 68.965 51.341-25.287 19.771-57.164 31.571-91.8 31.571-5.977.0-11.801-.306-17.625-1.073 32.337 21.15 71.264 33.41 112.95 33.41z"/></svg>
</a>
<a target=_blank rel="noopener noreferrer" aria-label="share openfaas-workshop-lab3 on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3a%2f%2fzhenfeng-zhu.github.io%2fposts%2fopenfaas-workshop-lab3%2f&title=openfaas-workshop-lab3&summary=openfaas-workshop-lab3&source=https%3a%2f%2fzhenfeng-zhu.github.io%2fposts%2fopenfaas-workshop-lab3%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg>
</a>
<a target=_blank rel="noopener noreferrer" aria-label="share openfaas-workshop-lab3 on reddit" href="https://reddit.com/submit?url=https%3a%2f%2fzhenfeng-zhu.github.io%2fposts%2fopenfaas-workshop-lab3%2f&title=openfaas-workshop-lab3"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg>
</a>
<a target=_blank rel="noopener noreferrer" aria-label="share openfaas-workshop-lab3 on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fzhenfeng-zhu.github.io%2fposts%2fopenfaas-workshop-lab3%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg>
</a>
<a target=_blank rel="noopener noreferrer" aria-label="share openfaas-workshop-lab3 on whatsapp" href="https://api.whatsapp.com/send?text=openfaas-workshop-lab3%20-%20https%3a%2f%2fzhenfeng-zhu.github.io%2fposts%2fopenfaas-workshop-lab3%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg>
</a>
<a target=_blank rel="noopener noreferrer" aria-label="share openfaas-workshop-lab3 on telegram" href="https://telegram.me/share/url?text=openfaas-workshop-lab3&url=https%3a%2f%2fzhenfeng-zhu.github.io%2fposts%2fopenfaas-workshop-lab3%2f"><svg viewBox="2 2 28 28"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg>
</a>
</div>
</footer><script src=https://utteranc.es/client.js repo=zhenfeng-zhu/zhenfeng-zhu.github.io issue-term=pathname label=Comment theme=github-light crossorigin=anonymous async></script>
</article>
</main>
<footer class=footer>
<span>&copy; 2022 <a href=https://zhenfeng-zhu.github.io>Awesome Fenix</a></span>
<span>
Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://git.io/hugopapermod rel=noopener target=_blank>PaperMod</a>
</span>
</footer>
<a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a>
<script>let menu=document.getElementById('menu');menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(a=>{a.addEventListener("click",function(b){b.preventDefault();var a=this.getAttribute("href").substr(1);window.matchMedia('(prefers-reduced-motion: reduce)').matches?document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView({behavior:"smooth"}),a==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${a}`)})})</script>
<script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script>
<script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove('dark'),localStorage.setItem("pref-theme",'light')):(document.body.classList.add('dark'),localStorage.setItem("pref-theme",'dark'))})</script>
<script>document.querySelectorAll('pre > code').forEach(b=>{const c=b.parentNode.parentNode,a=document.createElement('button');a.classList.add('copy-code'),a.innerText='copy';function d(){a.innerText='copied!',setTimeout(()=>{a.innerText='copy'},2e3)}a.addEventListener('click',e=>{if('clipboard'in navigator){navigator.clipboard.writeText(b.textContent),d();return}const a=document.createRange();a.selectNodeContents(b);const c=window.getSelection();c.removeAllRanges(),c.addRange(a);try{document.execCommand('copy'),d()}catch(a){}c.removeRange(a)}),c.classList.contains("highlight")?c.appendChild(a):c.parentNode.firstChild==c||(b.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?b.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(a):b.parentNode.appendChild(a))})</script>
</body>
</html>