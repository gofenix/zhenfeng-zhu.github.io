<!doctype html><html lang=zh-cn dir=ltr><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="监视器
监视器提供了一个外部世界和函数之间的非托管的通用接口。它的工作是收集从 API 网关来的 HTTP 请求，然后调用程序。监视器是一个小型的 Golang 服务——下图展示了它是如何工作的：
 上图：一个小型的 web 服务，可以为每个传入的 HTTP 请求分配所需要的进程。
 每个函数都需要嵌入这个二进制文件并将其作为ENTRYPOINT 或 CMD，实际上是把它作为容器的初始化进程。一旦你的进程被创建分支，监视器就会通过stdin 传递 HTTP 请求并从stdout中读取 HTTP 响应。这意味着你的程序无需知道 web 和 HTTP 的任何信息。
轻松创建新函数 从 CLI 创建一个函数
创建函数最简单的方法是使用 FaaS CLI 和模板。CLI 抽象了所有 Docker 的知识，使得你只需要编写所支持语言的 handler 文件即可。
 你的第一个使用 OpenFaaS 的无服务器 Python 函数 阅读有关 FaaS CLI 的教程  深入研究 Package your function 打包你的函数
如果你不想使用 CLI 或者现有的二进制文件或镜像，可以使用下面的方法去打包函数：
 使用一个现有的或者一个新的 Docker 镜像作为基础镜像 FROM 通过curl 或 ADD https://从 Releases 页面 添加 fwatchdog 二进制文件 为每个你要运行的函数设置 fprocess(函数进程) 环境变量 Expose port 8080 暴露端口 8080 Set the CMD to fwatchdog 设置 CMD为fwatchdog  一个echo函数的示例 Dockerfile："><title>watchdog</title><link rel=canonical href=https://example.com/p/watchdog/><link rel=stylesheet href=/scss/style.min.b80bf249ce4a22cf55e8d7340a0b37a2f2c10f54f3a9a49cb94b694a2eb0bbea.css><meta property="og:title" content="watchdog"><meta property="og:description" content="监视器
监视器提供了一个外部世界和函数之间的非托管的通用接口。它的工作是收集从 API 网关来的 HTTP 请求，然后调用程序。监视器是一个小型的 Golang 服务——下图展示了它是如何工作的：
 上图：一个小型的 web 服务，可以为每个传入的 HTTP 请求分配所需要的进程。
 每个函数都需要嵌入这个二进制文件并将其作为ENTRYPOINT 或 CMD，实际上是把它作为容器的初始化进程。一旦你的进程被创建分支，监视器就会通过stdin 传递 HTTP 请求并从stdout中读取 HTTP 响应。这意味着你的程序无需知道 web 和 HTTP 的任何信息。
轻松创建新函数 从 CLI 创建一个函数
创建函数最简单的方法是使用 FaaS CLI 和模板。CLI 抽象了所有 Docker 的知识，使得你只需要编写所支持语言的 handler 文件即可。
 你的第一个使用 OpenFaaS 的无服务器 Python 函数 阅读有关 FaaS CLI 的教程  深入研究 Package your function 打包你的函数
如果你不想使用 CLI 或者现有的二进制文件或镜像，可以使用下面的方法去打包函数：
 使用一个现有的或者一个新的 Docker 镜像作为基础镜像 FROM 通过curl 或 ADD https://从 Releases 页面 添加 fwatchdog 二进制文件 为每个你要运行的函数设置 fprocess(函数进程) 环境变量 Expose port 8080 暴露端口 8080 Set the CMD to fwatchdog 设置 CMD为fwatchdog  一个echo函数的示例 Dockerfile："><meta property="og:url" content="https://example.com/p/watchdog/"><meta property="og:site_name" content="演示站点"><meta property="og:type" content="article"><meta property="article:section" content="Post"><meta property="article:published_time" content="2018-09-06T16:23:57+00:00"><meta property="article:modified_time" content="2018-09-06T16:23:57+00:00"><meta name=twitter:title content="watchdog"><meta name=twitter:description content="监视器
监视器提供了一个外部世界和函数之间的非托管的通用接口。它的工作是收集从 API 网关来的 HTTP 请求，然后调用程序。监视器是一个小型的 Golang 服务——下图展示了它是如何工作的：
 上图：一个小型的 web 服务，可以为每个传入的 HTTP 请求分配所需要的进程。
 每个函数都需要嵌入这个二进制文件并将其作为ENTRYPOINT 或 CMD，实际上是把它作为容器的初始化进程。一旦你的进程被创建分支，监视器就会通过stdin 传递 HTTP 请求并从stdout中读取 HTTP 响应。这意味着你的程序无需知道 web 和 HTTP 的任何信息。
轻松创建新函数 从 CLI 创建一个函数
创建函数最简单的方法是使用 FaaS CLI 和模板。CLI 抽象了所有 Docker 的知识，使得你只需要编写所支持语言的 handler 文件即可。
 你的第一个使用 OpenFaaS 的无服务器 Python 函数 阅读有关 FaaS CLI 的教程  深入研究 Package your function 打包你的函数
如果你不想使用 CLI 或者现有的二进制文件或镜像，可以使用下面的方法去打包函数：
 使用一个现有的或者一个新的 Docker 镜像作为基础镜像 FROM 通过curl 或 ADD https://从 Releases 页面 添加 fwatchdog 二进制文件 为每个你要运行的函数设置 fprocess(函数进程) 环境变量 Expose port 8080 暴露端口 8080 Set the CMD to fwatchdog 设置 CMD为fwatchdog  一个echo函数的示例 Dockerfile："></head><body class=article-page><script>(function(){const e="StackColorScheme";localStorage.getItem(e)||localStorage.setItem(e,"auto")})()</script><script>(function(){const t="StackColorScheme",e=localStorage.getItem(t),n=window.matchMedia("(prefers-color-scheme: dark)").matches===!0;e=="dark"||e==="auto"&&n?document.documentElement.dataset.scheme="dark":document.documentElement.dataset.scheme="light"})()</script><div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky"><button class="hamburger hamburger--spin" type=button id=toggle-menu aria-label=切换菜单>
<span class=hamburger-box><span class=hamburger-inner></span></span></button><header><figure class=site-avatar><a href=/><img src=/img/avatar_huda2458f72ce188392d75c5d51cd8e24e_373_300x0_resize_box_3.png width=300 height=300 class=site-logo loading=lazy alt=Avatar></a></figure><div class=site-meta><h1 class=site-name><a href=/>演示站点</a></h1><h2 class=site-description>软件工程师 编程小语种爱好者，精通各种语言的hello world，目前沉迷Clojure、elixir Get Started工程师，止步于大量框架和包的readme 后端开发工程师，偶尔写一些前端，伪全栈 也是一名数据工程师，朝着SQL Boy进化</h2></div></header><ol class=social-menu><li><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank title=GitHub><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 19c-4.3 1.4-4.3-2.5-6-3m12 5v-3.5c0-1 .1-1.4-.5-2 2.8-.3 5.5-1.4 5.5-6a4.6 4.6.0 00-1.3-3.2 4.2 4.2.0 00-.1-3.2s-1.1-.3-3.5 1.3a12.3 12.3.0 00-6.2.0C6.5 2.8 5.4 3.1 5.4 3.1a4.2 4.2.0 00-.1 3.2A4.6 4.6.0 004 9.5c0 4.6 2.7 5.7 5.5 6-.6.6-.6 1.2-.5 2V21"/></svg></a></li><li><a href=https://twitter.com target=_blank title=Twitter><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-twitter" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M22 4.01c-1 .49-1.98.689-3 .99-1.121-1.265-2.783-1.335-4.38-.737S11.977 6.323 12 8v1c-3.245.083-6.135-1.395-8-4 0 0-4.182 7.433 4 11-1.872 1.247-3.739 2.088-6 2 3.308 1.803 6.913 2.423 10.034 1.517 3.58-1.04 6.522-3.723 7.651-7.742a13.84 13.84.0 00.497-3.753C20.18 7.773 21.692 5.25 22 4.009z"/></svg></a></li></ol><ol class=menu id=main-menu><div class=menu-bottom-section><li id=i18n-switch><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-language" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M4 5h7"/><path d="M9 3v2c0 4.418-2.239 8-5 8"/><path d="M5 9c-.003 2.144 2.952 3.908 6.7 4"/><path d="M12 20l4-9 4 9"/><path d="M19.1 18h-6.2"/></svg><select name=language onchange="window.location.href=this.selectedOptions[0].value"><option value=https://example.com/en/>English</option><option value=https://example.com/ selected>中文</option><option value=https://example.com/ar/>عربي</option></select></li><li id=dark-mode-toggle><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="8" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="16" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg><span>暗色模式</span></li></div></ol></aside><main class="main full-width"><article class=main-article><header class=article-header><div class=article-details><div class=article-title-wrapper><h2 class=article-title><a href=/p/watchdog/>watchdog</a></h2></div><footer class=article-time><div><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg><time class=article-time--published>Sep 06, 2018</time></div><div><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg><time class=article-time--reading>阅读时长: 2 分钟</time></div></footer></div></header><section class=article-content><p><strong>监视器</strong></p><p>监视器提供了一个外部世界和函数之间的非托管的通用接口。它的工作是收集从 API 网关来的 HTTP 请求，然后调用程序。监视器是一个小型的 Golang 服务——下图展示了它是如何工作的：</p><p><img src=https://ws1.sinaimg.cn/large/006tNbRwgy1fuzw3rkue0j30k00bamy2.jpg loading=lazy></p><blockquote><p>上图：一个小型的 web 服务，可以为每个传入的 HTTP 请求分配所需要的进程。</p></blockquote><p>每个函数都需要嵌入这个二进制文件并将其作为<code>ENTRYPOINT</code> 或 <code>CMD</code>，实际上是把它作为容器的初始化进程。一旦你的进程被创建分支，监视器就会通过<code>stdin</code> 传递 HTTP 请求并从<code>stdout</code>中读取 HTTP 响应。这意味着你的程序无需知道 web 和 HTTP 的任何信息。</p><h2 id=轻松创建新函数><strong>轻松创建新函数</strong></h2><p><strong>从 CLI 创建一个函数</strong></p><p>创建函数最简单的方法是使用 FaaS CLI 和模板。CLI 抽象了所有 Docker 的知识，使得你只需要编写所支持语言的 handler 文件即可。</p><ul><li><a class=link href="https://link.zhihu.com/?target=https%3A//blog.alexellis.io/first-faas-python-function/" target=_blank rel=noopener>你的第一个使用 OpenFaaS 的无服务器 Python 函数</a></li><li><a class=link href="https://link.zhihu.com/?target=https%3A//github.com/openfaas/faas-cli" target=_blank rel=noopener>阅读有关 FaaS CLI 的教程</a></li></ul><h2 id=深入研究><strong>深入研究</strong></h2><p><strong>Package your function 打包你的函数</strong></p><p>如果你不想使用 CLI 或者现有的二进制文件或镜像，可以使用下面的方法去打包函数：</p><ul><li>使用一个现有的或者一个新的 Docker 镜像作为基础镜像 <code>FROM</code></li><li>通过<code>curl</code> 或 <code>ADD https://</code>从 <a class=link href="https://link.zhihu.com/?target=https%3A//github.com/openfaas/faas/releases" target=_blank rel=noopener>Releases 页面</a> 添加 fwatchdog 二进制文件</li><li>为每个你要运行的函数设置 <code>fprocess</code>(函数进程) 环境变量</li><li>Expose port 8080</li><li>暴露端口 8080</li><li>Set the <code>CMD</code> to <code>fwatchdog</code></li><li>设置 <code>CMD</code>为<code>fwatchdog</code></li></ul><p>一个<code>echo</code>函数的示例 Dockerfile：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>FROM alpine:3.7
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>ADD https://github.com/openfaas/faas/releases/download/0.8.0/fwatchdog /usr/bin
</span></span><span class=line><span class=cl>RUN chmod +x /usr/bin/fwatchdog
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl># Define your binary here
</span></span><span class=line><span class=cl>ENV fprocess=&#34;/bin/cat&#34;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>CMD [&#34;fwatchdog&#34;]
</span></span></code></pre></td></tr></table></div></div><p><strong>Implementing a Docker healthcheck 实现一个 Docker 健康检查</strong></p><p>Docke 的健康检查不是必需的，但是它是最佳实践。这会确保监视器已经在 API 网关转发请求之前准备好接收请求。如果函数或者监视器遇到一个不可恢复的问题，Swarm 也会重启容器。</p><p>Here is an example of the <code>echo</code> function implementing a healthcheck with a 5-second checking interval.</p><p>下面是实现了一个具有 5 秒间隔的健康检查的<code>echo</code>函数示例：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>FROM functions/alpine
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>ENV fprocess=&#34;cat /etc/hostname&#34;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>HEALTHCHECK --interval=5s CMD [ -e /tmp/.lock ] || exit 1
</span></span></code></pre></td></tr></table></div></div><p>监视器进程早启动内部 Golang HTTP 服务的时候会在 <code>/tmp/</code>下面创建一个.lock 文件。<code>[ -e file_name ]</code>shell 命令可以检查文件是否存在。在 Windows 容器中，这是一个不合法的路径，所以你可能需要设置<code>suppress_lock</code> 环境变量。</p><p>有关健康检查，请阅读我的 Docker Swarm 教程：</p><ul><li><a class=link href="https://link.zhihu.com/?target=http%3A//blog.alexellis.io/test-drive-healthcheck/" target=_blank rel=noopener>10 分钟内试用 Docker 的健康检查</a></li></ul><p><strong>环境变量重载:</strong></p><p>监视器可以通过环境变量来配置，你必须始终指定一个<code>fprocess</code> 变量</p><h2 id=高级调整><strong>高级/调整</strong></h2><h2 id=新子监视器和-http-模式><strong>(新)——子监视器和 HTTP 模式</strong></h2><ul><li>部分的监视器</li></ul><p>为每个请求创建一个新的进程分支具有进程隔离，可移植和简单的优点。任何进程都可以在没有任何附加代码的情况下变成一个函数。of-watchdog 可和 HTTP 模式是一种优化，这样就可以在所有请求之间维护一个单一的进程。</p><p>新版本的监视器正在<a class=link href="https://link.zhihu.com/?target=https%3A//github.com/openfaas-incubator/of-watchdog" target=_blank rel=noopener>openfaas-incubator/of-watchdog</a>上测试。</p><p>这种重写主要是生成一个可以持续维护的结构。它将会替代现有的监视器，也会有二进制的释放版。</p><h2 id=使用-http-头><strong>使用 HTTP 头</strong></h2><p>HTTP 的头和其他请求信息以下面的格式注入到环境变量中：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-plain data-lang=plain><span class=line><span class=cl>X-Forwarded-By`头变成了`Http_X_Forwarded_By
</span></span></code></pre></td></tr></table></div></div><ul><li><code>Http_Method</code> - GET/POST etc</li><li><code>Http_Method</code> - GET/POST 等等</li><li><code>Http_Query</code> - QueryString value</li><li><code>Http_Query</code> - 查询字符串的值</li><li><code>Http_ContentLength</code> - gives the total content-length of the incoming HTTP request received by the watchdog.</li><li><code>Http_ContentLength</code> - 监视器收到的 HTTP 请求的内容长度。</li></ul><blockquote><p>默认情况下，通过<code>cgi_headers</code> 环境变量启用该行为。</p></blockquote><p>以下是带有附加头和查询字符串的 POST 请求的示例：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>$ cgi_headers=true fprocess=env ./watchdog &amp;
</span></span><span class=line><span class=cl>2017/06/23 17:02:58 Writing lock-file to: /tmp/.lock
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>$ curl &#34;localhost:8080?q=serverless&amp;page=1&#34; -X POST -H X-Forwarded-By:http://my.vpn.com
</span></span></code></pre></td></tr></table></div></div><p>如果你再 Linux 系统下设置了<code>fprocess</code> 到 <code>env</code>中，会看到如下结果：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>Http_User_Agent=curl/7.43.0
</span></span><span class=line><span class=cl>Http_Accept=*/*
</span></span><span class=line><span class=cl>Http_X_Forwarded_By=http://my.vpn.com
</span></span><span class=line><span class=cl>Http_Method=POST
</span></span><span class=line><span class=cl>Http_Query=q=serverless&amp;page=1
</span></span></code></pre></td></tr></table></div></div><p>也可以使用<code>GET</code>请求：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>curl &#34;localhost:8080?action=quote&amp;qty=1&amp;productId=105&#34;
</span></span></code></pre></td></tr></table></div></div><p>监视器的输出如下：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>Http_User_Agent=curl/7.43.0
</span></span><span class=line><span class=cl>Http_Accept=*/*
</span></span><span class=line><span class=cl>Http_Method=GET
</span></span><span class=line><span class=cl>Http_Query=action=quote&amp;qty=1&amp;productId=105
</span></span></code></pre></td></tr></table></div></div><p>现在就可以在程序中使用 HTTP 状态来做决策了。</p><h2 id=http-方法><strong>HTTP 方法</strong></h2><p>监视器支持的 HTTP 方法有：</p><p>带有请求体的：</p><ul><li>POST, PUT, DELETE, UPDATE</li></ul><p>不带请求体的：</p><ul><li>GET</li></ul><blockquote><p>API 网关现在支持函数的 POST 路由。</p></blockquote><h2 id=请求响应的内容类型><strong>请求响应的内容类型</strong></h2><p>默认情况下，监视器会匹配客户端的"Content-Type"。</p><ul><li>如果客户端发送 Content-Type 为 <code>application/json</code> 的 json 形式的 post 请求，将会在响应的时候自动匹配。</li><li>如果客户端发送 Content-Type 为 <code>text/plain</code> 的 json 形式的 post 请求，响应也会自动匹配。</li></ul><p>若要重载所有响应的 Content-Type ，需要设置<code>content_type</code> 环境变量。</p><h2 id=i-dont-want-to-use-the-watchdog><strong>I don&rsquo;t want to use the watchdog</strong></h2><h2 id=我不想使用监视器><strong>我不想使用监视器</strong></h2><p>这种案例是 OpenFaaS 所不支持的，但是如果你的容器符合以下要求，那么 OpenFaaS 的网关和其他工具也会管理和伸缩服务。</p><p>你需要提供一个锁文件 <code>/tmp/.lock</code>，以便业务流程系统可以在容器中运行健康检查。如果你正在使用 swarm，那么请确保在 Dockerfile 中提供<code>HEALTHCHECK</code>指令——在 <code>faas</code>存储库中有示例。</p><ul><li>在 HTTP 之上暴露 TCP 端口 8080</li><li>创建<code>/tmp/.lock</code> 文件，或者在响应操作 tempdir 系统调用的任何位置。</li></ul><h2 id=调整自动伸缩><strong>调整自动伸缩</strong></h2><p>自动伸缩式从 1 个副本开始，以 5 个位一个单位进行升级：</p><ul><li>1->5</li><li>5->10</li><li>10->15</li><li>15->20</li></ul><p>你可以通过标签来覆盖一个函数 minimum 和 maximum 。</p><p>如果要在 2 到 15 之间的话，请在部署的时候配置以下标签：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>com.openfaas.scale.min: &#34;2&#34;
</span></span><span class=line><span class=cl>com.openfaas.scale.max: &#34;15&#34;
</span></span></code></pre></td></tr></table></div></div><p>这些标签是可选的</p><p><strong>禁用自动伸缩</strong></p><p>如果要禁用某个函数的自动伸缩，将最小和最大的副本数设置为相同的值，即“1”。</p><p>同样也可以删除 AlertManager。</p></section><footer class=article-footer><section class=article-copyright><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><path d="M14.5 9a3.5 4 0 100 6"/></svg><span>Licensed under CC BY-NC-SA 4.0</span></section></footer></article><div class=disqus-container><div id=disqus_thread></div><script type=application/javascript>window.disqus_config=function(){},function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById("disqus_thread").innerHTML="Disqus comments not available by default when the website is previewed locally.";return}var t=document,e=t.createElement("script");e.async=!0,e.src="//hugo-theme-stack.disqus.com/embed.js",e.setAttribute("data-timestamp",+new Date),(t.head||t.body).appendChild(e)}()</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></div><style>.disqus-container{background-color:var(--card-background);border-radius:var(--card-border-radius);box-shadow:var(--shadow-l1);padding:var(--card-padding)}</style><script>window.addEventListener("onColorSchemeChange",e=>{DISQUS&&DISQUS.reset({reload:!0})})</script><footer class=site-footer><section class=copyright>&copy;
1993 -
2022 演示站点</section><section class=powerby>Built with <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a><br>主题 <b><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank rel=noopener data-version=3.10.0>Stack</a></b> 由 <a href=https://jimmycai.com target=_blank rel=noopener>Jimmy</a> 设计</section></footer><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)"></button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.css integrity="sha256-c0uckgykQ9v5k+IqViZOZKc47Jn7KQil4/MP3ySA3F8=" crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.css integrity="sha256-SBLU4vv6CA6lHsZ1XyTdhyjJxCjPif/TRkjnsyGAGnE=" crossorigin=anonymous></main><aside class="sidebar right-sidebar sticky"><section class="widget archives"><div class=widget-icon><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><line x1="5" y1="9" x2="19" y2="9"/><line x1="5" y1="15" x2="19" y2="15"/><line x1="11" y1="4" x2="7" y2="20"/><line x1="17" y1="4" x2="13" y2="20"/></svg></div><h2 class="widget-title section-title">目录</h2><div class=widget--toc><nav id=TableOfContents><ol><li><a href=#轻松创建新函数><strong>轻松创建新函数</strong></a></li><li><a href=#深入研究><strong>深入研究</strong></a></li><li><a href=#高级调整><strong>高级/调整</strong></a></li><li><a href=#新子监视器和-http-模式><strong>(新)——子监视器和 HTTP 模式</strong></a></li><li><a href=#使用-http-头><strong>使用 HTTP 头</strong></a></li><li><a href=#http-方法><strong>HTTP 方法</strong></a></li><li><a href=#请求响应的内容类型><strong>请求响应的内容类型</strong></a></li><li><a href=#i-dont-want-to-use-the-watchdog><strong>I don&rsquo;t want to use the watchdog</strong></a></li><li><a href=#我不想使用监视器><strong>我不想使用监视器</strong></a></li><li><a href=#调整自动伸缩><strong>调整自动伸缩</strong></a></li></ol></nav></div></section></aside></div><script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.5/dist/vibrant.min.js integrity="sha256-5NovOZc4iwiAWTYIFiIM7DxKUXKWvpVEuMEPLzcm5/g=" crossorigin=anonymous></script><script type=text/javascript src=/ts/main.js defer></script>
<script>(function(){const e=document.createElement("link");e.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",e.type="text/css",e.rel="stylesheet",document.head.appendChild(e)})()</script></body></html>